

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon.png">
  <link rel="icon" href="/img/icon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="windzwindy">
  <meta name="keywords" content="">
  
    <meta name="description" content="SpringMVC 记录（基于 SpringBoot） 1. SpringMVC 版的 HelloWorld 程序记录 HelloWorld 程序  在 pom.xml 中引入 web-starter ： 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt; &lt;artifac">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringMVC 记录（基于 SpringBoot）">
<meta property="og:url" content="https://windzwindy.github.io/2025/02/23/SpringMVC_Record/index.html">
<meta property="og:site_name" content="WindZwindy Blog">
<meta property="og:description" content="SpringMVC 记录（基于 SpringBoot） 1. SpringMVC 版的 HelloWorld 程序记录 HelloWorld 程序  在 pom.xml 中引入 web-starter ： 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt; &lt;artifac">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://windzwindy.github.io/images/SSM_Study/SpringMVC%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82%E7%AE%80%E7%95%A5%E8%BF%87%E7%A8%8B.svg">
<meta property="article:published_time" content="2025-02-23T13:10:31.000Z">
<meta property="article:modified_time" content="2025-02-23T13:20:04.116Z">
<meta property="article:author" content="windzwindy">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Spring">
<meta property="article:tag" content="SpringBoot">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://windzwindy.github.io/images/SSM_Study/SpringMVC%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82%E7%AE%80%E7%95%A5%E8%BF%87%E7%A8%8B.svg">
  
  
  
  <title>SpringMVC 记录（基于 SpringBoot） - WindZwindy Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"windzwindy.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":true,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>WindZwindy</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="SpringMVC 记录（基于 SpringBoot）"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-02-23 21:10" pubdate>
          2025年2月23日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          25k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          205 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">SpringMVC 记录（基于 SpringBoot）</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2025年2月23日 晚上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h1 id="springmvc-记录基于-springboot">SpringMVC 记录（基于
SpringBoot）</h1>
<h2 id="springmvc-版的-helloworld-程序记录">1. SpringMVC 版的 HelloWorld
程序记录</h2>
<h3 id="helloworld-程序">HelloWorld 程序</h3>
<ul>
<li><p>在 <code>pom.xml</code> 中引入 web-starter ：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>创建一个类：<code>HelloController</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloController</span> &#123;<br><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-meta">@RequestMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello SpringMVC ! 你好，SpringMVC！&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>启动程序，打开浏览器输入 <code>localhost:8080/hello</code>
网址并打开，成功显示信息</p></li>
<li><p>注意：如果 8080 端口被占用应用会启动不起来，此时可以在
<code>application.properties</code> 配置文件中指定端口：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">server.port</span>=<span class="hljs-string">8000</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="注解-requestmapping-记录">注解 <code>@RequestMapping</code>
记录</h3>
<ul>
<li><p>这个注解可以放在类和方法上，用于匹配请求路径</p>
<ul>
<li>比如有一个 <code>GET</code> 请求过来，请求路径是 <code>/hello</code>
那么就会去找参数 <code>value</code> 或 <code>path</code> 的值为
<code>/hello</code> 和 参数 <code>method</code> 值为 <code>GET</code>
的被 <code>@RequestMapping</code> 标注的方法或者类</li>
<li>就像上面的 HelloWorld 例子一样，当一个路径为 <code>/hello</code>
的请求过来，就会执行 <code>HelloContorller</code> 类中的
<code>hello()</code> 方法</li>
</ul></li>
<li><p>参数 <code>value</code>：类型为 <code>String[]</code></p>
<ul>
<li>同参数 <code>path</code>，填写匹配的路径，路径有要求，可以看<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webflux/controller/ann-requestmapping.html">官方文档</a>，如果通配符和精确路径都能匹配，那么优先走精确路径
<ul>
<li>?：匹配一个字符</li>
<li>*：匹配 0 到多个字符，只能匹配一个路径片段</li>
<li>**：匹配 0 到多个路径片段，用在路径结尾</li>
</ul></li>
</ul></li>
<li><p>参数 <code>path</code>：同参数 <code>value</code></p></li>
<li><p>参数 <code>method</code>：类型为 <code>RequestMethod[]</code></p>
<ul>
<li><p>如果指定了，那么这个方法只处理 <code>method</code>
限定的请求方式</p></li>
<li><p>比如限定为 POST 那么发 GET
请求过来，即使路径匹配了也不会执行被标注的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestMappingLimitController</span> &#123;<br><br>    <span class="hljs-comment">// 如果在浏览器上访问 /methodLimit 路径不会执行下面的方法，因为请求方法不一致</span><br>    <span class="hljs-comment">// 可以用 Postman 测试 POST 请求下的 /methodLimit 路径</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/methodLimit&quot;, method = RequestMethod.POST)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">methodLimit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;method limit&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>参数 <code>params</code>：类型为 <code>String[]</code></p>
<ul>
<li><p>限定请求必需要有 <code>params</code>
指定的参数，如果没有那么被标注的方法就不处理这个请求</p></li>
<li><p>有四种写法：</p>
<ul>
<li><p>param</p></li>
<li><p>param=value</p></li>
<li><p>!param</p></li>
<li><p>param!=value（这个情况如果没有 param 参数也会执行方法，因为此时
value 为空）</p></li>
</ul></li>
<li><p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestMappingLimitController</span> &#123;<br><br>    <span class="hljs-comment">// 如果请求的是 /paramLimit 路径，那么只有带有 name 参数和 age 参数且 age 参数值为 18 时才会执行下面的方法</span><br>    <span class="hljs-comment">// 例如： /paramLimit?name=zhangsan&amp;age=18</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/paramLimit&quot;, params = &#123;&quot;name&quot;, &quot;age=18&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">paramLimit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;param limit&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>参数 <code>headers</code>：类型为 <code>String[]</code></p>
<ul>
<li><p>限定请求必需要有 <code>headers</code>
指定的请求头，如果没有那么被标注的方法就不处理这个请求</p></li>
<li><p>有四种写法：</p>
<ul>
<li><p>header</p></li>
<li><p>header=value</p></li>
<li><p>!header</p></li>
<li><p>header!=value（这个情况如果没有 header 参数也会执行方法，因为此时
value 为空）</p></li>
</ul></li>
<li><p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestMappingLimitController</span> &#123;<br><br>    <span class="hljs-comment">// 只有访问的是 /headerLimit 路径，且路径中有请求头 wind 值为 zwindy 才会访问</span><br>    <span class="hljs-comment">// 可以用 Postman 进行测试</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/headerLimit&quot;, headers = &#123;&quot;wind=zwindy&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">headerLimit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;header limit&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>参数 <code>consumes</code>：类型为 <code>String[]</code></p>
<ul>
<li><p>限定请求的内容类型为 <code>consumes</code>
指定的类型，如果不符合那么被标注的方法就不处理这个请求</p></li>
<li><p>即指定浏览器携带给服务器的数据类型</p></li>
<li><p>类型可以到 <code>org.springframework.http.MediaType</code>
类中查看</p></li>
<li><p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestMappingLimitController</span> &#123;<br><br>    <span class="hljs-comment">// 限定浏览器要给服务器携带的是 json 数据格式，如果不是就不执行下面的方法</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/consumeLimit&quot;, consumes = &quot;application/json&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">consumeLimit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;consume limit&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>参数 <code>produces</code>：类型为 <code>String[]</code></p>
<ul>
<li><p>限定响应的内容类型为 <code>produces</code>
指定的类型，如果不符合那么被标注的方法就不处理这个请求</p></li>
<li><p>即指定服务器响应给浏览器的数据类型</p></li>
<li><p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestMappingLimitController</span> &#123;<br><br>    <span class="hljs-comment">// 此时访问 /produceLimit 路径时返回的就是一个 html 类型的数据，浏览器会渲染</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/produceLimit&quot;, produces = &quot;text/html;charset=utf-8&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">produceLimit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;h1&gt;produce limit&lt;/h1&gt;&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h4
id="注解-getmapping-postmapping-putmapping-deletemapping-patchmapping-记录">注解
<code>@GetMapping</code>, <code>@PostMapping</code>,
<code>@PutMapping</code>, <code>@DeleteMapping</code>,
<code>@PatchMapping</code> 记录</h4>
<ul>
<li>这一些注解等同于
<code>@RequestMapping(method = RequestMethod.请求方式)</code>
<ul>
<li>比如 <code>@GetMapping</code> =
<code>@RequestMapping(method = RequestMethod.GET)</code></li>
</ul></li>
<li>在后面的 <code>RESTful</code> 风格代码时用的多</li>
</ul>
<h3 id="注解-responsebody-记录">注解 <code>@ResponseBody</code>
记录</h3>
<ul>
<li>这个注解可以放在类和方法上，用于指定这个类或者方法返回的是响应体数据，而不是模板路径（即前后端不分离的模板页面路径）
<ul>
<li>这个注解标在类上就表示类中的所有方法返回的都是响应体</li>
<li>标在方法上就表示这个方法返回的是响应体</li>
<li>比如上面的 HelloWorld 例子中的 <code>hello()</code>
方法返回的就是一个字符串，而不是模板文件的路径（xxx.html,xxx.jsp,xxx.thymeleaf）</li>
</ul></li>
</ul>
<h3 id="注解-restcontroller-记录">注解 <code>RestController</code>
记录</h3>
<ul>
<li><p>如果一个类是 Controller
类，而这个类中的所有方法返回的都是响应体，那么代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">xxxController</span> &#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>可以简写为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">xxxController</span> &#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="http-请求与响应记录">2. HTTP 请求与响应记录</h2>
<ul>
<li><code>HTTP</code> 请求会带各种数据
<ul>
<li>请求首行：请求方式、请求路径、请求协议</li>
<li>请求头：<code>key:value</code></li>
<li>空白行</li>
<li>请求体：此次请求携带的其它数据</li>
</ul></li>
<li><code>HTTP</code> 请求如果不指定端口则默认访问的是 <code>80</code>
端口</li>
<li><code>HTTPS</code> 请求如果不指定端口则默认访问的是 <code>443</code>
端口</li>
<li>比如一个 <code>GET</code>
请求：<code>http://www.example.com:80/a/b/index.html?key1=value1&amp;key2=value2#first</code>
<ul>
<li><code>http://</code> 即为请求协议（Protocol）</li>
<li><code>www.example.com</code> 即为主机（域名）（Domain Name）</li>
<li><code>:80</code> 即为请求的端口（Port）</li>
<li><code>/a/b/index.html</code> 即为请求的路径（Path）</li>
<li><code>?key1=value1&amp;key2=value2</code>
即为请求参数（Parameters）</li>
<li><code>#first</code> 为片段（Anchor），即锚点，不会发给服务器</li>
</ul></li>
<li><code>GET</code> 请求数据一般在请求首行中，而 <code>POST</code>
请求在负载（Payload）中</li>
<li><code>HTTP</code> 响应
<ul>
<li>响应首行：响应协议、响应状态码</li>
<li>响应头：<code>key:value</code></li>
<li>空白行</li>
<li>响应体</li>
</ul></li>
</ul>
<h2 id="请求处理记录">3. 请求处理记录</h2>
<ul>
<li><p>可以先看看<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-methods.html">官方文档</a></p></li>
<li><p>在开始之前，先导入一个 <code>index.html</code> 文件，把它放到
<code>src/main/resources/static</code> 下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--    本网页使用layui框架编写； layui官网：https://layui.dev/  --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://cdn.bootcdn.net/ajax/libs/layui/2.9.15/css/layui.min.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.bootcdn.net/ajax/libs/layui/2.9.15/layui.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.layui-col-xs6</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-row&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-col-xs6&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>SpringMVC - 请求测试<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-collapse&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验1：使用普通变量，收集请求参数<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span> &gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display: flex;justify-content: center&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/handle01&quot;</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 250px;padding: 10px&quot;</span> &gt;</span><br><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>  <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;用户名&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-password&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;密码&quot;</span></span><br><span class="hljs-tag">                                               <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span> <span class="hljs-attr">lay-affix</span>=<span class="hljs-string">&quot;eye&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-row&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-col-xs12&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                                    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-cellphone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cellphone&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;手机号&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;agreement&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;同意&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#terms&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;_blank&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;position: relative; top: 6px; left: -15px;&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">ins</span>&gt;</span>用户协议<span class="hljs-tag">&lt;/<span class="hljs-name">ins</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn layui-btn-fluid&quot;</span> <span class="hljs-attr">lay-submit</span>&gt;</span>注册<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验2：使用@RequestParam，逐一封装多个参数<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display: flex;justify-content: center&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/handle02&quot;</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 250px;padding: 10px&quot;</span> &gt;</span><br><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>  <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;用户名&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-password&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;密码&quot;</span></span><br><span class="hljs-tag">                                               <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span> <span class="hljs-attr">lay-affix</span>=<span class="hljs-string">&quot;eye&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-row&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-col-xs12&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                                    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-cellphone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cellphone&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;手机号&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;agreement&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;同意&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#terms&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;_blank&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;position: relative; top: 6px; left: -15px;&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">ins</span>&gt;</span>用户协议<span class="hljs-tag">&lt;/<span class="hljs-name">ins</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn layui-btn-fluid&quot;</span> <span class="hljs-attr">lay-submit</span>&gt;</span>注册<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验3：使用POJO，统一封装多个参数<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display: flex;justify-content: center&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/handle03&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 250px;border: 5px solid black;padding: 10px&quot;</span> &gt;</span><br><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>  <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;用户名&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-password&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;密码&quot;</span></span><br><span class="hljs-tag">                                               <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span> <span class="hljs-attr">lay-affix</span>=<span class="hljs-string">&quot;eye&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-row&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-col-xs12&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                                    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-cellphone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cellphone&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;手机号&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;agreement&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;同意&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#terms&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;_blank&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;position: relative; top: 6px; left: -15px;&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">ins</span>&gt;</span>用户协议<span class="hljs-tag">&lt;/<span class="hljs-name">ins</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn layui-btn-fluid&quot;</span> <span class="hljs-attr">lay-submit</span>&gt;</span>注册<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验4：使用@RequestHeader获取请求头数据<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/handle04&quot;</span>&gt;</span>随便发个请求<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验5：使用@CookieValue获取Cookie数据<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/handle05&quot;</span>&gt;</span>随便又发个请求<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验6：使用POJO，级联封装复杂对象<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display: flex;justify-content: center&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form layui-form-pane&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/handle06&quot;</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 400px;padding: 10px&quot;</span> &gt;</span><br><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>  <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;用户名&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-password&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;密码&quot;</span></span><br><span class="hljs-tag">                                               <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span> <span class="hljs-attr">lay-affix</span>=<span class="hljs-string">&quot;eye&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-row&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-col-xs12&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                                    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-cellphone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cellphone&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;手机号&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-row&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-col-xs4&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                                    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-website&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;address.province&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;省&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-col-xs4&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                                    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-find-fill&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;address.city&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;市&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-col-xs4&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                                    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-tree&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;address.area&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;区&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>性别<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;男&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;男&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;女&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;女&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>爱好<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;足球&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;足球&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;篮球&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;篮球&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;乒乓球&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;乒乓球&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>年级<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;grade&quot;</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;一年级&quot;</span>&gt;</span>一年级<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;二年级&quot;</span>&gt;</span>二年级<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;三年级&quot;</span>&gt;</span>三年级<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;四年级&quot;</span>&gt;</span>四年级<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;agreement&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;同意&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#terms&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;_blank&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;position: relative; top: 6px; left: -15px;&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">ins</span>&gt;</span>用户协议<span class="hljs-tag">&lt;/<span class="hljs-name">ins</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn layui-btn-fluid&quot;</span> <span class="hljs-attr">lay-submit</span>&gt;</span>注册<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验7：使用@RequestBody，封装JSON对象<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn layui-bg-blue&quot;</span>&gt;</span>去Postman测试，自己带上【实验6】中数据的json<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验8：使用@RequestPart/@RequestParam，封装文件，测试文件上传<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display: flex;justify-content: center&quot;</span>&gt;</span><br><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form layui-form-pane&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/handle08&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 350px;padding: 10px&quot;</span> &gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-elem-field&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color: lemonchiffon&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>文件上传要求<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-field-box&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>1. 表单：method=post<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>2. enctype=&quot;multipart/form-data&quot;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>3. 注意：SpringMVC对上传文件有大小限制（默认单文件最大：1MB；整个请求最大：10MB）<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>  <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;用户名&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-password&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;密码&quot;</span></span><br><span class="hljs-tag">                                               <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span> <span class="hljs-attr">lay-affix</span>=<span class="hljs-string">&quot;eye&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-row&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-col-xs12&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-wrap&quot;</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-prefix&quot;</span>&gt;</span><br>                                                    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-cellphone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cellphone&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;手机号&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>头像<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;headerImg&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>生活照<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;lifeImg&quot;</span> <span class="hljs-attr">multiple</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;agreement&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;同意&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#terms&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;_blank&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;position: relative; top: 6px; left: -15px;&quot;</span>&gt;</span><br>                                        <span class="hljs-tag">&lt;<span class="hljs-name">ins</span>&gt;</span>用户协议<span class="hljs-tag">&lt;/<span class="hljs-name">ins</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn layui-btn-fluid&quot;</span> <span class="hljs-attr">lay-submit</span>&gt;</span>注册<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验9：使用HttpEntity，封装请求原始数据<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn layui-bg-blue&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/handle09?user=admin&amp;age=18&quot;</span>&gt;</span>随便㕛发个请求<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验10：使用原生Servlet API，获取原生请求对象<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn layui-bg-blue&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/handle09?user=admin&amp;age=18&quot;</span>&gt;</span>随便叒发个请求<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-col-xs6&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>SpringMVC - 响应测试<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-collapse&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验1：返回json数据<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/resp01&quot;</span>&gt;</span>给个JSON<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验2：文件下载测试<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/download&quot;</span>&gt;</span>给个美女<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-item&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-title&quot;</span>&gt;</span>实验3：使用Thymeleaf模版引擎，实现服务端渲染<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-colla-content&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-elem-field&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color: lemonchiffon&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>服务端渲染<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-field-box&quot;</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>现在服务端渲染的方式用的很少了；项目基本都是前后分离。<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>这样各端专注于自己的开发，快速协同分工<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-elem-field&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color: lightcyan&quot;</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>前后分离<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-field-box&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>1. 前端开发人员编写独立的前端项目<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>2. 前端项目自己控制页面跳转逻辑<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>3. 后端仅需返回前端需要的JSON数据<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>4. 后端无需关心页面效果等问题<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>优点：分工明确，快速协同，专注用户体验<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>缺点：成本高，技术复杂，门槛高<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                            <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-elem-field&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color: lightcyan&quot;</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>前后不分离(服务端渲染)<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span><br>                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-field-box&quot;</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>1. 后端开发人员要控制页面跳转逻辑（利用转发、重定向）<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>2. 服务器要拿到业务数据，全部填充到页面，然后整体把页面返回给客户端<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>3. 模版引擎作用：将数据填充到页面模板<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>4. JSP其实就是一种模板引擎<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>优点：弱前端、低成本、速度快<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>缺点：不专业、体验差、效率低、易扯皮<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                            <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>创建一个 <code>Controller</code>
用于处理请求：<code>RequestTestController.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="获取请求参数记录">获取请求参数记录</h3>
<ul>
<li><p>处理 <code>GET</code>
请求：<code>/handle01?username=zhangsan&amp;password=123456&amp;cellphone=12345678910&amp;agreement=on</code></p></li>
<li><p>编写 <code>Mapping</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/handle01&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle01</span><span class="hljs-params">(String username,</span><br><span class="hljs-params">                           String password,</span><br><span class="hljs-params">                           String cellphone,</span><br><span class="hljs-params">                           <span class="hljs-type">boolean</span> agreement)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;username = &quot;</span> + username);<br>        System.out.println(<span class="hljs-string">&quot;password = &quot;</span> + password);<br>        System.out.println(<span class="hljs-string">&quot;cellphone = &quot;</span> + cellphone);<br>        System.out.println(<span class="hljs-string">&quot;agreement = &quot;</span> + agreement);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再次请求，发现控制台获取到了数据，如果请求没有携带数据打印为空</p></li>
</ul>
<h3 id="获取指定请求参数记录">获取指定请求参数记录</h3>
<ul>
<li><p>处理 <code>GET</code>
请求：<code>/handle02?username=zhangsan&amp;password=123456&amp;cellphone=12345678910&amp;agreement=on</code></p></li>
<li><p>编写 <code>Mapping</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/handle02&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle02</span><span class="hljs-params">(String uname,</span><br><span class="hljs-params">                           String passwd,</span><br><span class="hljs-params">                           String phone,</span><br><span class="hljs-params">                           <span class="hljs-type">boolean</span> agreemt)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;uname = &quot;</span> + uname);<br>        System.out.println(<span class="hljs-string">&quot;passwd = &quot;</span> + passwd);<br>        System.out.println(<span class="hljs-string">&quot;phone = &quot;</span> + phone);<br>        System.out.println(<span class="hljs-string">&quot;agreemt = &quot;</span> + agreemt);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>访问请求，发现没有，此时要用注解 <code>@RequestParam</code>
指定要绑定的请求参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/handle02&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle02</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;username&quot;)</span> String uname,</span><br><span class="hljs-params">                           <span class="hljs-meta">@RequestParam(&quot;password&quot;)</span> String passwd,</span><br><span class="hljs-params">                           <span class="hljs-meta">@RequestParam(&quot;cellphone&quot;)</span> String phone,</span><br><span class="hljs-params">                           <span class="hljs-meta">@RequestParam(&quot;agreement&quot;)</span> <span class="hljs-type">boolean</span> agreemt)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;uname = &quot;</span> + uname);<br>        System.out.println(<span class="hljs-string">&quot;passwd = &quot;</span> + passwd);<br>        System.out.println(<span class="hljs-string">&quot;phone = &quot;</span> + phone);<br>        System.out.println(<span class="hljs-string">&quot;agreemt = &quot;</span> + agreemt);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再次访问请求，发现数据正常打印了</p></li>
<li><p>如果用了 <code>@RequestParam</code>
而请求参数没有指定的参数，就会报错，此时要在注解中指定参数为非必须
<code>required = false</code></p></li>
</ul>
<h4 id="注解-requestparam-记录">注解 <code>@RequestParam</code>
记录</h4>
<ul>
<li><p>从请求中（不论任何请求）获取指定的参数赋值给被标注的变量</p>
<ul>
<li><p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 表示从请求参数中获取参数 abc 的值赋值给变量 myvalue</span><br><span class="hljs-meta">@RequestParam(&quot;abc&quot;)</span><br>String myvalue<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>注解参数 <code>value</code>：类型为 <code>String</code></p>
<ul>
<li>同参数 <code>name</code> 用于指定要获取的参数的名</li>
</ul></li>
<li><p>注解参数 <code>name</code>：类型为 <code>String</code></p>
<ul>
<li>作用同 <code>value</code></li>
</ul></li>
<li><p>注解参数 <code>required</code>：类型为 <code>boolean</code></p>
<ul>
<li>用于指定这个参数是否必须，默认值为 <code>true</code></li>
<li>如果这个注解参数设置为 <code>true</code>，又没有设置
<code>defaultValue</code>
注解参数，那么从请求的参数中获取不到对应的参数时会报错</li>
</ul></li>
<li><p>注解参数 <code>defaultValue</code>：类型为
<code>String</code></p>
<ul>
<li>如果从请求的参数中没有获取到值，就用这个注解参数为变量指定默认值</li>
<li>用了这个参数，就可以不用 <code>required</code> 参数了</li>
</ul></li>
</ul>
<h3 id="获取并封装请求参数为对象记录">获取并封装请求参数为对象记录</h3>
<ul>
<li><p>处理 <code>POST</code>
请求：<code>/handle03</code>，负载（请求体）数据：<code>username=zhangsan&amp;password=123456&amp;cellphone=12345678910&amp;agreement=on</code></p></li>
<li><p>此时仍然可以用 <code>@RequestParam</code>
获取请求参数，但为了方便就把多个属性封装成一个 POJO 类</p></li>
<li><p>编写一个 POJO 类 <code>Person.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password;<br>    <span class="hljs-keyword">private</span> String cellphone;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> agreement;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写
<code>Mapping</code>，如果类中的属性名与请求的参数名一致，直接写一个
<code>Person</code> 参数就行了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.bean.Person;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-meta">@PostMapping(&quot;/handle03&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle03</span><span class="hljs-params">(Person person)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;person = &quot;</span> + person);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="获取请求头信息记录">获取请求头信息记录</h3>
<ul>
<li><p>获取 <code>GET</code> 请求 <code>/handle04</code>
的请求头信息，比如 <code>Host</code></p></li>
<li><p>编写 <code>Mapping</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.bean.Person;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/handle04&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle04</span><span class="hljs-params">(<span class="hljs-meta">@RequestHeader(&quot;Host&quot;)</span> String host)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;host = &quot;</span> + host);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="注解-requestheader-记录">注解 <code>@RequestHeader</code>
记录</h4>
<ul>
<li>用于获取请求中的请求头信息</li>
<li>注解参数 <code>value</code>：类型为 <code>String</code>
<ul>
<li>同注解参数 <code>name</code></li>
<li>指定要获取的请求头中的哪个信息，比如
<code>Host</code>、<code>User-Agent</code>等等</li>
</ul></li>
<li>注解参数 <code>name</code>：类型为
<code>String</code>，作用同注解参数 <code>value</code></li>
<li>注解参数 <code>required</code>：类型为 <code>boolean</code>
<ul>
<li>用于指定要获取的请求头信息是否是必要的，默认值为
<code>true</code></li>
<li>如果为 <code>true</code> 且没有指定注解参数
<code>defaultValue</code>
而请求中又没有相应的请求头信息，那么就会报错</li>
</ul></li>
<li>注解参数 <code>defaultValue</code>：类型为 <code>String</code>
<ul>
<li>当从请求中没有获取到想要的请求头信息，此时如果指定了
<code>defaultValue</code> 就用其指定的值</li>
<li>如果没有指定 <code>defaultValue</code> 而注解参数
<code>required</code> 又为 <code>true</code> 那就会报错</li>
</ul></li>
</ul>
<h3 id="获取请求中的-cookie-信息记录">获取请求中的 <code>Cookie</code>
信息记录</h3>
<ul>
<li><p>获取 <code>GET</code> 请求 <code>/handle05</code> 中的
<code>Cookie</code></p></li>
<li><p>先给网站造一个 <code>Cookie</code>：ckname=zhangsan</p></li>
<li><p>再编写 <code>Mapping</code> 获取：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.bean.Person;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/handle05&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle05</span><span class="hljs-params">(<span class="hljs-meta">@CookieValue(&quot;ckname&quot;)</span> String name)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ckname = &quot;</span> + name);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="注解-cookievalue-记录">注解 <code>@CookieValue</code> 记录</h4>
<ul>
<li>用于获取请求中的 <code>Cookie</code> 信息</li>
<li>注解参数 <code>value</code>：类型为 <code>String</code>
<ul>
<li>同注解参数 <code>name</code></li>
<li>指定要获取的请求中的哪个具体的 <code>Cookie</code> 信息</li>
</ul></li>
<li>注解参数 <code>name</code>：类型为
<code>String</code>，作用同注解参数 <code>value</code></li>
<li>注解参数 <code>required</code>：类型为 <code>boolean</code>
<ul>
<li>用于指定要获取的请求中的 <code>Cookie</code>
信息是否是必要的，默认值为 <code>true</code></li>
<li>如果为 <code>true</code> 且没有指定注解参数
<code>defaultValue</code> 而请求中又没有相应的 <code>Cookie</code>
信息，那么就会报错</li>
</ul></li>
<li>注解参数 <code>defaultValue</code>：类型为 <code>String</code>
<ul>
<li>当从请求中没有获取到想要的 <code>Cookie</code> 信息，此时如果指定了
<code>defaultValue</code> 就用其指定的值</li>
<li>如果没有指定 <code>defaultValue</code> 而注解参数
<code>required</code> 又为 <code>true</code> 那就会报错</li>
</ul></li>
</ul>
<h3 id="获取请求参数并多层封装记录">获取请求参数并多层封装记录</h3>
<ul>
<li><p>获取 <code>GET</code> 请求
<code>/handle06?username=zhangsan&amp;password=123456&amp;cellphone=12345678910&amp;address.province=陕西&amp;address.city=西安&amp;address.area=长安&amp;sex=男&amp;hobby=足球&amp;hobby=篮球&amp;hobby=乒乓球&amp;grade=二年级&amp;agreement=on</code>
的信息</p></li>
<li><p>更改 <code>Person</code> 类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password;<br>    <span class="hljs-keyword">private</span> String cellphone;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> agreement;<br>    <span class="hljs-keyword">private</span> String sex;<br>    <span class="hljs-keyword">private</span> String[] hobby;<br>    <span class="hljs-keyword">private</span> String grade;<br><br>    <span class="hljs-keyword">private</span> Address address;<br><br>&#125;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Address</span> &#123;<br>    <span class="hljs-keyword">private</span> String province;<br>    <span class="hljs-keyword">private</span> String city;<br>    <span class="hljs-keyword">private</span> String area;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>Mapping</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.bean.Person;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/handle06&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle06</span><span class="hljs-params">(Person person)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;person = &quot;</span> + person);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="获取其它请求格式信息记录">获取其它请求格式信息记录</h3>
<ul>
<li><p>获取 <code>POST</code> 请求 <code>/handle07</code>
中的请求体数据，数据为 <code>json</code>
格式，此时就要进行转换，才能封装为 POJO 类对象</p></li>
<li><p>可以利用 <code>Postman</code>
模拟发送请求，数据要和被封装的对象对应，数据如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;username&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zhangsan&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;123456&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;cellphone&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12345678910</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;agreement&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;true&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;sex&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;man&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hobby&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;篮球&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;足球&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;grade&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;三年级&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;province&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;陕西&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;city&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;西安&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;area&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;长安&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure></li>
<li><p><code>Person</code> 类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password;<br>    <span class="hljs-keyword">private</span> String cellphone;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> agreement;<br>    <span class="hljs-keyword">private</span> String sex;<br>    <span class="hljs-keyword">private</span> String[] hobby;<br>    <span class="hljs-keyword">private</span> String grade;<br><br>    <span class="hljs-keyword">private</span> Address address;<br><br>&#125;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Address</span> &#123;<br>    <span class="hljs-keyword">private</span> String province;<br>    <span class="hljs-keyword">private</span> String city;<br>    <span class="hljs-keyword">private</span> String area;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>Mapping</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.bean.Person;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-meta">@PostMapping(&quot;/handle07&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle07</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Person person)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;person = &quot;</span> + person);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br>    <br>    <span class="hljs-comment">// 也可以原封不动拿到字符串,再自己做转换</span><br>    <span class="hljs-comment">//@PostMapping(&quot;/handle07&quot;)</span><br>    <span class="hljs-comment">//public String handle07(@RequestBody String personStr) &#123;</span><br>    <span class="hljs-comment">//    System.out.println(&quot;person = &quot; + personStr);</span><br>    <span class="hljs-comment">//    return &quot;ok&quot;;</span><br>    <span class="hljs-comment">//&#125;</span><br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="注解-requestbody-记录">注解 <code>@RequestBody</code> 记录</h4>
<ul>
<li>这个注解的作用是直接将请求体数据解析，然后自动进行转换处理（如果可以转换），再赋值给被注解的对象</li>
<li>一般是通过请求头 <code>Content-Type</code>
来对应的消息转换器进行数据的转换，<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/integration/rest-clients.html#rest-message-conversion">官方文档</a>
<ul>
<li>比如 <code>application/json</code> 就用
<code>MappingJackson2HttpMessageConverter</code> 消息转换器</li>
</ul></li>
<li>如果是不能解析的数据，而又用了这个注解，则方法不会执行，控制台出现警告</li>
<li>参数 <code>required</code>：类型为 <code>boolean</code>，默认值为
<code>true</code>
<ul>
<li>如果为 <code>true</code> 且没有获取到请求体数据，则报错</li>
</ul></li>
</ul>
<h3 id="获取请求体中的文件信息记录">获取请求体中的文件信息记录</h3>
<ul>
<li><p>获取 <code>POST</code> 请求 <code>/handle08</code>
上传过来的文件</p></li>
<li><p>前端上传文件有两个要求：请求方式为 <code>POST</code>
和提交数据的类型为 <code>multipart/form-data</code></p></li>
<li><p>传文件时，浏览器会把文件以二进制的方式放到请求体中进行上传</p></li>
<li><p>SpringMVC 对文件获取的方法：<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-methods/multipart-forms.html">官方文档</a></p></li>
<li><p>即要用到 <code>MultipartFile</code> 类接收上传过来的文件</p></li>
<li><p>编写 <code>Mapping</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.bean.Person;<br><span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;<br><br><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.nio.file.Path;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-comment">// 注意：这里不用写 @RequestBody 注解，因为上传的数据不是可以转换的消息数据</span><br>    <span class="hljs-meta">@PostMapping(&quot;handle08&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle08</span><span class="hljs-params">(Person person,</span><br><span class="hljs-params">                           // 用 <span class="hljs-meta">@RequestParam</span> 指定要获取文件的参数名 (key: fileValue)</span><br>                           <span class="hljs-comment">// 单个文件用 MultipartFile 对象，多个就用数组</span><br>                           <span class="hljs-meta">@RequestParam(&quot;headerImg&quot;)</span> MultipartFile headerImgFile,<br>                           <span class="hljs-meta">@RequestParam(&quot;lifeImg&quot;)</span> MultipartFile[] lifeImgFiles) <span class="hljs-keyword">throws</span> IOException &#123;<br><br>        <span class="hljs-comment">// 1. 获取原始文件名</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">originalFilename</span> <span class="hljs-operator">=</span> headerImgFile.getOriginalFilename();<br>        System.out.println(<span class="hljs-string">&quot;原始文件名 = &quot;</span> + originalFilename);<br><br>        <span class="hljs-comment">// 2. 获取文件大小</span><br>        <span class="hljs-type">long</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> headerImgFile.getSize();<br>        System.out.println(<span class="hljs-string">&quot;文件大小 = &quot;</span> + size);<br><br>        <span class="hljs-comment">// 3. 获取文件流，可以进行文件流操作</span><br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> headerImgFile.getInputStream();<br><br>        <span class="hljs-comment">// 4. 保存文件</span><br>        headerImgFile.transferTo(Path.of(<span class="hljs-string">&quot;D:\\&quot;</span> + originalFilename));<br>        <span class="hljs-comment">// 或者</span><br>        <span class="hljs-comment">//headerImgFile.transferTo(new File(&quot;D:\\&quot; + originalFilename));</span><br><br>        <span class="hljs-comment">// 如果数组长度不为 0 才进行保存操作</span><br>        <span class="hljs-keyword">if</span> (lifeImgFiles.length &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">for</span> (MultipartFile lifeImg : lifeImgFiles) &#123;<br>                lifeImg.transferTo(Path.of(<span class="hljs-string">&quot;D:\\&quot;</span> + lifeImg.getOriginalFilename()));<br>                <span class="hljs-comment">//lifeImg.transferTo(new File(&quot;D:\\&quot; + lifeImg.getOriginalFilename()));</span><br>            &#125;<br>            System.out.println(<span class="hljs-string">&quot;life image save success&quot;</span>);<br>        &#125;<br><br>        System.out.println(<span class="hljs-string">&quot;person = &quot;</span> + person);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>注意：这里不用 <code>@RequestBody</code>
注解，因为上传过来的数据不是可以转换的消息数据</p></li>
<li><p>这里会有默认文件大小限制，可以在配置文件
<code>application.properties</code> 中手动指定文件大小限制：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.servlet.multipart.max-file-size</span>=<span class="hljs-string">1GB</span><br><span class="hljs-attr">spring.servlet.multipart.max-request-size</span>=<span class="hljs-string">1GB</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="类-multipartfile-记录">类 <code>MultipartFile</code> 记录</h4>
<ul>
<li>用于接收请求体的文件数据，可以配合 <code>@RequestParam</code>
注解使用</li>
</ul>
<h3 id="获取整个请求信息记录">获取整个请求信息记录</h3>
<ul>
<li><p>获取 <code>POST</code> 请求 <code>/handle09</code>
的所有请求信息</p></li>
<li><p>编写 <code>Mapping</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.http.HttpEntity;<br><span class="hljs-keyword">import</span> org.springframework.http.HttpHeaders;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-meta">@PostMapping(&quot;/handle09&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle09</span><span class="hljs-params">(HttpEntity&lt;String&gt; httpEntity)</span> &#123;<br><br>        <span class="hljs-comment">// 1. 获取请求头信息</span><br>        <span class="hljs-type">HttpHeaders</span> <span class="hljs-variable">headers</span> <span class="hljs-operator">=</span> httpEntity.getHeaders();<br>        System.out.println(<span class="hljs-string">&quot;请求头 = &quot;</span> + headers);<br><br>        <span class="hljs-comment">// 2. 获取请求体信息</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">body</span> <span class="hljs-operator">=</span> httpEntity.getBody();<br>        System.out.println(<span class="hljs-string">&quot;请求体 = &quot;</span> + body);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="类-httpentityt-记录">类 <code>HttpEntity&lt;T&gt;</code>
记录</h4>
<ul>
<li>用于获取整个请求信息，其泛型 <code>&lt;T&gt;</code>
为请求体类型</li>
<li>有一个子类 <code>RequestEntity&lt;T&gt;</code> 封装的东西更多</li>
</ul>
<h3 id="用-tomcat-原生的-servlet-处理请求记录">用 <code>Tomcat</code>
原生的 <code>Servlet</code> 处理请求记录</h3>
<ul>
<li><p>处理 <code>GET</code> 请求
<code>/handle10?username=zhangsan</code></p></li>
<li><p>编写 <code>Mapping</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.PrintWriter;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/handle10&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle10</span><span class="hljs-params">(HttpServletRequest request,</span><br><span class="hljs-params">                         HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;username&quot;</span>);<br>        <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">writer</span> <span class="hljs-operator">=</span> response.getWriter();<br>        writer.write(<span class="hljs-string">&quot;your name&quot;</span> + username);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="获取请求信息总结记录">获取请求信息总结记录</h3>
<ol type="1">
<li>直接写与参数名同名变量名</li>
<li>用 <code>@RequestParam</code> 注解指定要获取的参数名</li>
<li>写 <code>POJO</code> 类获取请求信息并封装</li>
<li>用 <code>@RequestHeader</code> 获取请求头信息</li>
<li>用 <code>@CookieValue</code> 获取请求中的 <code>Cookie</code>
信息</li>
<li>用 <code>@RequestBody</code> 注解获取其它格式的请求信息</li>
<li>用 <code>MultipartFile</code> 获取请求体中的文件数据</li>
<li>用 <code>HttpEntity&lt;T&gt;</code> 或者
<code>RequestEntity&lt;T&gt;</code> 获取整个请求信息</li>
<li>用原生 <code>Servlet</code> 获取请求信息</li>
<li>等等...，可以看<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-methods/arguments.html">官方文档</a></li>
</ol>
<h2 id="响应处理记录">4. 响应处理记录</h2>
<ul>
<li><p>可以先看看<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-methods.html">官方文档</a></p></li>
<li><p>创建一个 <code>Controller</code>
用于响应请求：<code>ResponseTestController.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><span class="hljs-keyword">import</span> org.wind.springmvc.bean.Person;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResponseTestController</span> &#123;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="响应一个-json-格式的数据记录">响应一个 <code>json</code>
格式的数据记录</h3>
<ul>
<li><p>如果响应的数据是一个对象，SpringMVC 会自动转换为
<code>json</code> 数据，关键要有一个注解
<code>@ResponseBody</code></p></li>
<li><p>响应给 <code>GET</code> 请求 <code>/resp01</code> 一个
<code>json</code> 数据</p></li>
<li><p>编写 <code>Pojo</code> 类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password;<br>    <span class="hljs-keyword">private</span> String cellphone;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> agreement;<br>    <span class="hljs-keyword">private</span> String sex;<br>    <span class="hljs-keyword">private</span> String[] hobby;<br>    <span class="hljs-keyword">private</span> String grade;<br><br>    <span class="hljs-keyword">private</span> Address address;<br><br>&#125;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Address</span> &#123;<br>    <span class="hljs-keyword">private</span> String province;<br>    <span class="hljs-keyword">private</span> String city;<br>    <span class="hljs-keyword">private</span> String area;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>Mapping</code>：也可以返回 <code>Map</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><span class="hljs-keyword">import</span> org.wind.springmvc.bean.Person;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResponseTestController</span> &#123;<br><br>    <span class="hljs-comment">// 此处也可以返回 Map 等等</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-meta">@GetMapping(&quot;/resp01&quot;)</span><br>    <span class="hljs-keyword">public</span> Person <span class="hljs-title function_">resp01</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        person.setUsername(<span class="hljs-string">&quot;zs&quot;</span>);<br>        person.setPassword(<span class="hljs-string">&quot;123456&quot;</span>);<br>        person.setCellphone(<span class="hljs-string">&quot;12345678910&quot;</span>);<br>        person.setAgreement(<span class="hljs-literal">true</span>);<br>        person.setSex(<span class="hljs-string">&quot;20&quot;</span>);<br>        person.setHobby(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<span class="hljs-string">&quot;football&quot;</span>, <span class="hljs-string">&quot;basketball&quot;</span>&#125;);<br>        person.setGrade(<span class="hljs-string">&quot;grade 3&quot;</span>);<br><br>        <span class="hljs-keyword">return</span> person;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="响应一个文件数据记录">响应一个文件数据记录</h3>
<ul>
<li><p>响应给 <code>GET</code> 请求 <code>/download</code>
一个文件数据</p></li>
<li><p>编写 <code>Mapping</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.http.MediaType;<br><span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-keyword">import</span> java.io.FileInputStream;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.net.URLEncoder;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResponseTestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/download&quot;)</span><br>    <span class="hljs-keyword">public</span> ResponseEntity&lt;<span class="hljs-type">byte</span>[]&gt; download() <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">// 获取文件转成文件流</span><br>        <span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fileInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;D:/1.png&quot;</span>);<br><br>        <span class="hljs-comment">// 把文件流转为字节流</span><br>        <span class="hljs-comment">// 这样可能会出现内存溢出问题</span><br>        <span class="hljs-type">byte</span>[] bytes = fileInputStream.readAllBytes();<br><br>        <span class="hljs-comment">// 有下面问题</span><br>        <span class="hljs-comment">// 1. 如果响应的文件有中文，会出现文件名乱码</span><br>        <span class="hljs-comment">// 2. 如果文件太大会出现内存溢出</span><br><br>        <span class="hljs-comment">// 解决文件名乱码</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">encode</span> <span class="hljs-operator">=</span> URLEncoder.encode(<span class="hljs-string">&quot;人.png&quot;</span>);<br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        // 获取一个响应构建器</span><br><span class="hljs-comment">        ResponseEntity.BodyBuilder ok = ResponseEntity.ok();</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        // 指定响应的内容类型为一个流</span><br><span class="hljs-comment">        ok.contentType(MediaType.APPLICATION_OCTET_STREAM);</span><br><span class="hljs-comment">        // 指定响应体的长度大小</span><br><span class="hljs-comment">        ok.contentLength(bytes.length);</span><br><span class="hljs-comment">        // 指定一个响应头，告诉浏览器这是一个要下载的文件，并指定文件名</span><br><span class="hljs-comment">        ok.header(&quot;Content-Disposition&quot;, &quot;attachment; filename=1.png&quot;);</span><br><span class="hljs-comment">        ok.header(&quot;Content-Disposition&quot;, &quot;attachment; filename=&quot; + encode);</span><br><span class="hljs-comment">        // 指定响应的内容体</span><br><span class="hljs-comment">        ResponseEntity&lt;byte[]&gt; body = ok.body(bytes);</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        // 进行响应</span><br><span class="hljs-comment">        return body;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        */</span><br><br>        <span class="hljs-comment">// 上面的代码可以直接返回</span><br>        <span class="hljs-keyword">return</span> ResponseEntity.ok()<br>                .contentType(MediaType.APPLICATION_OCTET_STREAM)<br>                .contentLength(bytes.length)<br>                <span class="hljs-comment">//.header(&quot;Content-Disposition&quot;, &quot;attachment; filename=1.png&quot;)</span><br>                .header(<span class="hljs-string">&quot;Content-Disposition&quot;</span>, <span class="hljs-string">&quot;attachment; filename=&quot;</span> + encode)<br>                .body(bytes);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>以上程序有两个需要注意的问题：</p>
<ul>
<li><p>如果响应的文件名有中文，会发生乱码问题，此时要用
<code>URLEncoder</code> 进行编码后再放到响应头中，再响应</p></li>
<li><p>如果读取的文件太大会出现内存溢出问题，此时可以修改返回的响应体类型为
<code>InputStreamResource</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.core.io.InputStreamResource;<br><span class="hljs-keyword">import</span> org.springframework.http.MediaType;<br><span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-keyword">import</span> java.io.FileInputStream;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.net.URLEncoder;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResponseTestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/download&quot;)</span><br>    <span class="hljs-keyword">public</span> ResponseEntity&lt;InputStreamResource&gt; <span class="hljs-title function_">download</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">// 获取文件转成文件流</span><br>        <span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fileInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;D:/1.png&quot;</span>);<br><br>        <span class="hljs-comment">// 解决文件名乱码</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">encode</span> <span class="hljs-operator">=</span> URLEncoder.encode(<span class="hljs-string">&quot;人.png&quot;</span>);<br><br>        <span class="hljs-comment">// 用 InputStreamResource 进行流的封装，避免发生内存溢出的问题</span><br>        <span class="hljs-type">InputStreamResource</span> <span class="hljs-variable">inputStreamResource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamResource</span>(fileInputStream);<br><br>        <span class="hljs-comment">// 上面的代码可以直接返回</span><br>        <span class="hljs-keyword">return</span> ResponseEntity.ok()<br>                .contentType(MediaType.APPLICATION_OCTET_STREAM)<br>                .contentLength(fileInputStream.available())<br>                .header(<span class="hljs-string">&quot;Content-Disposition&quot;</span>, <span class="hljs-string">&quot;attachment; filename=&quot;</span> + encode)<br>                .body(inputStreamResource);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h4 id="类-responseentityt-记录">类 <code>ResponseEntity&lt;T&gt;</code>
记录</h4>
<ul>
<li>可以参考<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-methods/responseentity.html">官方文档</a>，<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/http/ResponseEntity.html">API文档</a></li>
<li>这个类的作用是用于自定义一个响应，比如想返回一个文件，此时就可以用</li>
</ul>
<h3 id="响应一个页面记录">响应一个页面记录</h3>
<ul>
<li><p>在开始前先写一个 <code>Controller</code> 类
<code>PageTestController</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageTestController</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>Spring 推荐使用 <a
target="_blank" rel="noopener" href="https://www.thymeleaf.org/">Thymeleaf</a>
作为模板引擎，渲染页面</p></li>
<li><p>在 <code>pom.xml</code> 中导入 <code>Thymeleaf</code> 包：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>在哪里写页面呢？</p>
<ul>
<li>在 <code>src/main/resources</code> 路径下有两个文件夹：
<ul>
<li><code>static</code>：用来存放静态资源，比如
<code>js</code>、<code>css</code>、<code>images</code> 等等</li>
<li><code>templates</code>：用来存放模板页面</li>
</ul></li>
</ul></li>
<li><p>在 <code>templates</code> 目录下写一个登录页面
<code>login.html</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>登录页<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;login.do&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>    用户名：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    密码：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;登录&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>再写一个登录成功页面 <code>success.html</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>成功<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>恭喜，登录成功<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>用户名：&#123;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>年龄：&#123;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>注意：要响应一个页面就不要再用 <code>@RestController</code> 和
<code>@ResponseBody</code> 了，因为这两个注解都是响应数据用的</p></li>
<li><p>编写 <code>Mapping</code> 处理 <code>/</code> 路径请求：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageTestController</span> &#123;<br>    <br>    <span class="hljs-meta">@GetMapping(&quot;/&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">index</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 页面地址 = classpath:/templates/ + 视图名 + .html</span><br>        <span class="hljs-comment">// 写一个视图名</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;login&quot;</span>;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>Mapping</code> 处理前端 <code>/login.do</code>
请求：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.ui.Model;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageTestController</span> &#123;<br><br>    <span class="hljs-meta">@PostMapping(&quot;/login.do&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">login</span><span class="hljs-params">(String username,</span><br><span class="hljs-params">                        String password,</span><br><span class="hljs-params">                        // 模型就是页面要展示的所有数据</span><br><span class="hljs-params">                        Model model)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;用户登录：&quot;</span> + username + <span class="hljs-string">&quot;,&quot;</span> + password);<br><br>        <span class="hljs-comment">// 数据库查到信息</span><br>        <span class="hljs-comment">// 往模型中放数据</span><br>        model.addAttribute(<span class="hljs-string">&quot;username&quot;</span>, username);<br>        model.addAttribute(<span class="hljs-string">&quot;age&quot;</span>, <span class="hljs-number">20</span>);<br><br>        <span class="hljs-comment">// 跳转到 classpath:/templates/success.html 页面</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>success</code> 页面获取数据并展示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>成功<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>恭喜，登录成功<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>用户名：<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;username&#125;&quot;</span> <span class="hljs-attr">th:id</span>=<span class="hljs-string">&quot;$&#123;username&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>年龄：<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;age&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>年龄：[[$&#123;age&#125;]]<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>用 <code>Thymeleaf</code> 渲染一个列表数据：</p>
<ul>
<li><p>编写一个 <code>POJO</code> 类 <code>User.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.bean;<br><br><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> lombok.NoArgsConstructor;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>&#125;<br><br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>Mapping</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.ui.Model;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;<br><span class="hljs-keyword">import</span> org.wind.springmvc.bean.User;<br><br><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageTestController</span> &#123;<br>    <br>    <span class="hljs-meta">@PostMapping(&quot;/login.do&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">login</span><span class="hljs-params">(String username,</span><br><span class="hljs-params">                        String password,</span><br><span class="hljs-params">                        // 模型就是页面要展示的所有数据</span><br><span class="hljs-params">                        Model model)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;用户登录：&quot;</span> + username + <span class="hljs-string">&quot;,&quot;</span> + password);<br><br>        <span class="hljs-comment">// 数据库查到信息</span><br>        <span class="hljs-comment">// 往模型中放数据</span><br>        model.addAttribute(<span class="hljs-string">&quot;username&quot;</span>, username);<br>        model.addAttribute(<span class="hljs-string">&quot;age&quot;</span>, <span class="hljs-number">20</span>);<br><br>        List&lt;User&gt; list = Arrays.asList(<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">1L</span>, <span class="hljs-string">&quot;张三&quot;</span>, <span class="hljs-number">18</span>),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">2L</span>, <span class="hljs-string">&quot;李四&quot;</span>, <span class="hljs-number">19</span>),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">3L</span>, <span class="hljs-string">&quot;王五&quot;</span>, <span class="hljs-number">16</span>),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">4L</span>, <span class="hljs-string">&quot;赵六&quot;</span>, <span class="hljs-number">27</span>),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">5L</span>, <span class="hljs-string">&quot;孙七&quot;</span>, <span class="hljs-number">15</span>)<br>        );<br><br>        model.addAttribute(<span class="hljs-string">&quot;list&quot;</span>, list);<br><br>        <span class="hljs-comment">// 跳转到 classpath:/templates/success.html 页面</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>Thymeleaf</code> 模板 <code>success.html</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>成功<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>恭喜，登录成功<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>用户名：<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;username&#125;&quot;</span> <span class="hljs-attr">th:id</span>=<span class="hljs-string">&quot;$&#123;username&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>年龄：<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;age&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>年龄：[[$&#123;age&#125;]]<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">border</span>=<span class="hljs-string">&quot;1px&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>序号<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>用户名<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>年龄<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>成年否<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">th:each</span>=<span class="hljs-string">&quot;user : $&#123;list&#125;&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;user.id&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>[[$&#123;user.name&#125;]]<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>[[$&#123;user.age&#125;]]<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:if</span>=<span class="hljs-string">&quot;$&#123;user.age &gt;= 18&#125;&quot;</span>&gt;</span>是<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:if</span>=<span class="hljs-string">&quot;$&#123;user.age &lt; 18&#125;&quot;</span>&gt;</span>否<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h4 id="获取和存储-request-域数据">获取和存储 <code>request</code>
域数据</h4>
<ul>
<li>可以使用原生的 <code>HttpServletRequest</code></li>
<li>也可以使用下面的两个接口，一个类</li>
</ul>
<h5 id="接口-model-记录">接口 <code>Model</code> 记录</h5>
<ul>
<li><p>用法类似于 <code>HttpServletRequest</code></p></li>
<li><p>用在处理请求的 <code>Mapping</code> 方法中的参数上，用于读取
<code>request</code> 域中的数据，和往 <code>request</code>
域中存放数据</p></li>
<li><p>常用方法 <code>Model.addAttribute()</code> 和
<code>Model.getAttribute()</code></p></li>
</ul>
<h5 id="类-modelmap-记录">类 <code>ModelMap</code> 记录</h5>
<ul>
<li>用法类似于上面的 <code>Model</code></li>
</ul>
<h5 id="接口-map-记录">接口 <code>Map</code> 记录</h5>
<ul>
<li><code>Map</code> 接口常用于集合中，但在这里也可以和上面的
<code>Model</code> 和 <code>ModelMap</code>
作替换使用，即用法差不多</li>
</ul>
<h4 id="获取和存储-session-域数据">获取和存储 <code>session</code>
域数据</h4>
<ul>
<li>可以使用原生的 <code>HttpSession</code></li>
<li>也可以使用 <code>@SessionAttributes</code> 注解，可以看<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-methods/sessionattributes.html">官方文档</a></li>
</ul>
<h5 id="注解-sessionattributes-记录">注解
<code>@SessionAttributes</code> 记录</h5>
<ul>
<li><p>用法示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@SessionAttributes(&quot;pet&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EditPetForm</span> &#123;<br><br> <span class="hljs-meta">@PostMapping(&quot;/pets&quot;)</span><br> <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle</span><span class="hljs-params">(ModelMap modelMap)</span> &#123;<br>        <span class="hljs-comment">// 此时数据存放的位置就是在 session 中了</span><br>        modelMap.addAttribute(<span class="hljs-string">&quot;pet&quot;</span>, <span class="hljs-string">&quot;My pets&quot;</span>);<br>        <br>        <span class="hljs-comment">// 由于 @SessionAttributes 没有指定 abc 存放到 session 中，所以 abc 存放在 request 中</span><br>        modelMap.addAttribute(<span class="hljs-string">&quot;abc&quot;</span>, <span class="hljs-string">&quot;abc&quot;</span>);<br> &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="获取和存储-application-域数据">获取和存储
<code>application</code> 域数据</h4>
<ul>
<li>一般用原生的 <code>ServletContext</code> 进行获取和存储
<ul>
<li>可以通过 <code>request</code> 获取
<code>HttpServletRequest.getServletContext()</code></li>
</ul></li>
</ul>
<h4 id="类-modelandview-记录">类 <code>ModelAndView</code> 记录</h4>
<ul>
<li><p>返回一个页面除了返回视图名以外，还可以通过返回
<code>ModelAndView</code> 类实现</p></li>
<li><p>主要三个步骤：</p>
<ul>
<li>创建视图对象</li>
<li>给视图对象设置视图名称</li>
<li>给视图对象绑定数据（非必须，需要绑则绑）</li>
<li>返回视图对象</li>
</ul></li>
<li><p>改造上面的例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><span class="hljs-keyword">import</span> org.wind.springmvc.bean.User;<br><br><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageTestController</span> &#123;<br><br>    <span class="hljs-meta">@PostMapping(&quot;/login.do&quot;)</span><br>    <span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title function_">login</span><span class="hljs-params">(String username,</span><br><span class="hljs-params">                              String password)</span> &#123;<br><br>        System.out.println(<span class="hljs-string">&quot;用户登录：&quot;</span> + username + <span class="hljs-string">&quot;,&quot;</span> + password);<br><br>        List&lt;User&gt; list = Arrays.asList(<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">1L</span>, <span class="hljs-string">&quot;张三&quot;</span>, <span class="hljs-number">18</span>),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">2L</span>, <span class="hljs-string">&quot;李四&quot;</span>, <span class="hljs-number">19</span>),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">3L</span>, <span class="hljs-string">&quot;王五&quot;</span>, <span class="hljs-number">16</span>),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">4L</span>, <span class="hljs-string">&quot;赵六&quot;</span>, <span class="hljs-number">27</span>),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">5L</span>, <span class="hljs-string">&quot;孙七&quot;</span>, <span class="hljs-number">15</span>)<br>        );<br><br>        <span class="hljs-comment">// 创建视图对象</span><br>        <span class="hljs-type">ModelAndView</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelAndView</span>();<br><br>        <span class="hljs-comment">// 设置视图名字，用于找页面文件</span><br>        view.setViewName(<span class="hljs-string">&quot;success&quot;</span>);<br><br>        <span class="hljs-comment">// 给视图绑定数据</span><br>        view.addObject(<span class="hljs-string">&quot;username&quot;</span>, username);<br>        view.addObject(<span class="hljs-string">&quot;age&quot;</span>, <span class="hljs-number">20</span>);<br>        view.addObject(<span class="hljs-string">&quot;list&quot;</span>, list);<br><br>        <span class="hljs-comment">// 返回视图</span><br>        <span class="hljs-keyword">return</span> view;<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4
id="转发forward与重定向redirect">转发（forward）与重定向（redirect）</h4>
<ul>
<li>转发是一次请求：浏览器访问 <code>/a</code>，然后从 <code>/a</code>
转发到 <code>/b</code>，最后由 <code>/b</code> 响应给浏览器</li>
<li>重定向是两次请求：浏览器访问 <code>/a</code>，此时 <code>/a</code>
响应了 <code>/b</code> 的路径，浏览器再根据路径往 <code>/b</code>
发送请求，最后由 <code>/b</code> 响应给浏览器</li>
<li>转发是服务器内部的资源跳转，不可实现跨域访问</li>
<li>重定向可以完成内部资源跳转，也可以实现跨域跳转</li>
<li>转发可以访问服务器受保护的资源</li>
<li>重定向相当于让浏览器再发一次请求，不能访问服务器受保护的资源</li>
</ul>
<h5 id="原生-servlet-实现记录">原生 <code>Servlet</code> 实现记录</h5>
<ul>
<li><p>转发（forward）：</p>
<ul>
<li><p>调用 <code>ServletRequest</code> 接口下的
<code>RequestDispatcher getRequestDispatcher(String path);</code>
方法获得一个 <code>RequestDispatcher</code></p>
<ul>
<li>其中方法参数 <code>path</code> 就是要转发的目标的路径</li>
</ul></li>
<li><p>再调用 <code>RequestDispatcher</code> 接口下的
<code>void forward(ServletRequest request, ServletResponse response) throws ServletException, IOException;</code>
方法进行转发</p>
<ul>
<li>这个方法需要传入两个参数，分别为 <code>ServletRequest</code> 类和
<code>ServletResponse</code> 类</li>
</ul></li>
<li><p>由于 <code>HttpServletRequest</code> 接口继承了
<code>ServletRequest</code> 接口，所以：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 转发到 /index 路径，下面的类名要替换成实例对象</span><br>HttpServletRequest.getRequestDispatcher(<span class="hljs-string">&quot;/index&quot;</span>).forward(HttpServletRequest, HttpServletResponse);<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>重定向（redirect）：</p>
<ul>
<li><p>由于重定向是两次请求，所以要先响应一个路径</p></li>
<li><p>直接调用 <code>HttpServletResponse</code> 接口下的
<code>void sendRedirect(String location) throws IOException;</code>
方法</p>
<ul>
<li>其中方法参数 <code>location</code> 就是要重定向的目标的路径</li>
</ul></li>
<li><p>所以：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 重定向到 /index 路径，下面的类名要替换成实例对象</span><br>HttpServletResponse.sendRedirect(<span class="hljs-string">&quot;/index&quot;</span>);<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h5 id="springmvc-实现记录">SpringMVC 实现记录</h5>
<ul>
<li><p>转发：在返回时用 <code>forward:/view</code> 其中
<code>view</code> 为视图名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ForwardTestController</span> &#123;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;/fgohome&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">fGoHome</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 把 /gohome 请求转发到 /index 对应的 Mapping</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;forward:/findex&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;/findex&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">fIndexMapping</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 响应 index 视图给浏览器</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;index&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>可以看到当在浏览器地址栏上输入
<code>http://localhost:8080/fgohome</code>
后浏览器路径没有发生变化，这就是转发</p></li>
<li><p>重定向：在返回时用 <code>redirect:/view</code> 其中
<code>view</code> 为视图名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedirectTestController</span> &#123;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;/rgohome&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">rGoHome</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 把路径 /rindex 响应给浏览器，浏览器再向 /rindex 路径发送请求</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:/rindex&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;/rindex&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">rIndexMapping</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 响应 index 视图给浏览器</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;index&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>可以看到当在浏览器地址栏上输入
<code>http://localhost:8080/rgohome</code> 后浏览器地址栏上的路径变为了
<code>http://localhost:8080/rindex</code> 这就是重定向</p></li>
</ul>
<h3 id="响应处理总结记录">响应处理总结记录</h3>
<ol type="1">
<li>响应一个 <code>json</code>
数据：返回值类型为对象，就会自动用消息转换器转换为
<code>json</code>，要加 <code>@ResponseBody</code> 或者
<code>@RestController</code> 注解</li>
<li>响应一个文件数据：返回值类型为类
<code>ResponseEntity&lt;T&gt;</code> 定制响应</li>
<li>响应一个页面：
<ol type="1">
<li>返回值类型为 <code>String</code> 且不能用 <code>@ResponseBody</code>
和 <code>@RestController</code> 注解</li>
<li>返回值类型为类 <code>ModelAndView</code></li>
</ol></li>
<li>等等...，可以看<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-methods/return-types.html">官方文档</a></li>
</ol>
<h2 id="restful-风格记录">5. RESTful 风格记录</h2>
<ul>
<li><p>创建一个项目用于写 <code>RESTful</code>
风格代码：<code>springmvc-restful-crud</code></p></li>
<li><p><code>pom.xml</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>新建一个数据库用于写代码，这里使用的是 <code>MySQL</code>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> restful_crud;<br>USE restful_crud;<br><br><span class="hljs-keyword">SET</span> NAMES utf8mb4;<br><span class="hljs-keyword">SET</span> FOREIGN_KEY_CHECKS <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `employee`;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `employee`  (<br>  `id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="hljs-string">&#x27;主键&#x27;</span>,<br>  `name` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;员工名字&#x27;</span>,<br>  `age` <span class="hljs-type">int</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;年龄&#x27;</span>,<br>  `email` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;邮箱&#x27;</span>,<br>  `gender` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;性别&#x27;</span>,<br>  `address` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;住址&#x27;</span>,<br>  `salary` <span class="hljs-type">decimal</span>(<span class="hljs-number">10</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;薪资&#x27;</span>,<br>  <span class="hljs-keyword">PRIMARY</span> KEY (`id`) <span class="hljs-keyword">USING</span> BTREE<br>) ENGINE <span class="hljs-operator">=</span> InnoDB AUTO_INCREMENT <span class="hljs-operator">=</span> <span class="hljs-number">5</span> <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> <span class="hljs-operator">=</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> <span class="hljs-operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="hljs-operator">=</span> <span class="hljs-keyword">Dynamic</span>;<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `employee` <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;张三&#x27;</span>, <span class="hljs-number">11</span>, <span class="hljs-string">&#x27;aa@qq.com&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-string">&#x27;西安&#x27;</span>, <span class="hljs-number">9999.00</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `employee` <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;someone&#x27;</span>, <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;aaa&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-string">&#x27;sss&#x27;</span>, <span class="hljs-number">100.00</span>);<br><br><span class="hljs-keyword">SET</span> FOREIGN_KEY_CHECKS <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure></li>
<li><p>在配置文件 <code>application.properties</code> 中配置数据源：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.datasource.url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/restful_crud</span><br><span class="hljs-attr">spring.datasource.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.datasource.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-attr">spring.datasource.driver-class-name</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="基础架子搭建记录">基础架子搭建记录</h3>
<h4 id="dao-层记录"><code>DAO</code> 层记录</h4>
<ul>
<li><p>写一个 <code>bean</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> String email;<br>    <span class="hljs-keyword">private</span> String gender;<br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-keyword">private</span> BigDecimal salary;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>写一个 <code>dao</code> 做 <code>CRUD</code></p>
<ul>
<li><p>先写接口再写实现：</p></li>
<li><p>接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.dao;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmployeeDao</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>实现类（放到容器中，因为被注入的是实现类，而不是接口）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.dao;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmployeeDao</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h4 id="service-层记录"><code>Service</code> 层记录</h4>
<ul>
<li><p>先写接口再写实现：</p>
<ul>
<li><p>接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.service;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmployeeService</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>实现类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.service;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmployeeService</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h4 id="controller-层记录"><code>Controller</code> 层记录</h4>
<ul>
<li><code>EmployeeRestController</code> 类：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeRestController</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="实现员工表的-crud-记录">实现员工表的 <code>CRUD</code> 记录</h3>
<h4 id="dao-层记录-1"><code>DAO</code> 层记录</h4>
<ul>
<li><p>先写 <code>dao</code> 并测试：</p></li>
<li><p>即用 <code>JdbcTemplate</code> 进行 <code>CRUD</code></p>
<ul>
<li><p>接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.dao;<br><br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmployeeDao</span> &#123;<br><br>    <span class="hljs-comment">// 根据 id 获取员工信息</span><br>    Employee <span class="hljs-title function_">getEmpById</span><span class="hljs-params">(Long id)</span>;<br>    <span class="hljs-comment">// 新增员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmp</span><span class="hljs-params">(Employee emp)</span>;<br>    <span class="hljs-comment">// 修改员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmp</span><span class="hljs-params">(Employee emp)</span>;<br>    <span class="hljs-comment">// 根据 id 删除员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEmpById</span><span class="hljs-params">(Long id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>实现类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.dao;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.BeanPropertyRowMapper;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmployeeDao</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> JdbcTemplate jdbcTemplate;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Employee <span class="hljs-title function_">getEmpById</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-comment">// 定义 sql 语句</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from employee where id = ?&quot;</span>;<br>        <span class="hljs-comment">// 执行语句并接收返回结果</span><br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> jdbcTemplate.queryForObject(sql, <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanPropertyRowMapper</span>&lt;Employee&gt;(Employee.class), id);<br>        <span class="hljs-comment">// 把结果返回</span><br>        <span class="hljs-keyword">return</span> employee;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmp</span><span class="hljs-params">(Employee emp)</span> &#123;<br>        <span class="hljs-comment">// 定义 sql 语句</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;insert into employee(name, age, email, gender, address, salary) values (?, ?, ?, ?, ?, ?)&quot;</span>;<br>        <span class="hljs-comment">// 执行语句</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">update</span> <span class="hljs-operator">=</span> jdbcTemplate.update(sql,<br>                emp.getName(),<br>                emp.getAge(),<br>                emp.getEmail(),<br>                emp.getGender(),<br>                emp.getAddress(),<br>                emp.getSalary());<br>        <span class="hljs-comment">// 打印影响行数</span><br>        System.out.println(<span class="hljs-string">&quot;影响行数：&quot;</span> + update);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmp</span><span class="hljs-params">(Employee emp)</span> &#123;<br>        <span class="hljs-comment">// 定义 sql 语句</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;update employee set name=?,age=?,email=?,gender=?,address=?,salary=? where id=?&quot;</span>;<br>        <span class="hljs-comment">// 执行语句</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">update</span> <span class="hljs-operator">=</span> jdbcTemplate.update(sql,<br>                emp.getName(),<br>                emp.getAge(),<br>                emp.getEmail(),<br>                emp.getGender(),<br>                emp.getAddress(),<br>                emp.getSalary(),<br>                emp.getId());<br>        <span class="hljs-comment">// 打印影响行数</span><br>        System.out.println(<span class="hljs-string">&quot;影响行数：&quot;</span> + update);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEmpById</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-comment">// 定义 sql 语句</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;delete from employee where id = ?&quot;</span>;<br>        <span class="hljs-comment">// 执行语句</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">update</span> <span class="hljs-operator">=</span> jdbcTemplate.update(sql, id);<br>        <span class="hljs-comment">// 打印影响行数</span><br>        System.out.println(<span class="hljs-string">&quot;影响行数：&quot;</span> + update);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>测试类，注意在更新的时候如果只想更新部分数据也要写全部数据，如果不写就会是空值：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.dao.EmployeeDao;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeDaoTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeDao employeeDao;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEmployeeDao2</span><span class="hljs-params">()</span> &#123;<br>        employeeDao.deleteEmpById(<span class="hljs-number">5L</span>);<br>        System.out.println(<span class="hljs-string">&quot;删除成功&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEmployeeDao1</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>();<br>        employee.setId(<span class="hljs-number">5L</span>);<br>        employee.setName(<span class="hljs-string">&quot;another&quot;</span>);<br>        employee.setAge(<span class="hljs-number">33</span>);<br>        employee.setEmail(<span class="hljs-string">&quot;bbbabbb.bbb&quot;</span>);<br>        employee.setGender(<span class="hljs-string">&quot;women&quot;</span>);<br>        employee.setAddress(<span class="hljs-string">&quot;abcdef&quot;</span>);<br>        <span class="hljs-comment">// 不改的值也要传，不然就是改为 null</span><br>        employee.setSalary(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">&quot;9000&quot;</span>));<br>        <span class="hljs-comment">// 新增员工信息</span><br>        employeeDao.updateEmp(employee);<br><br>        System.out.println(<span class="hljs-string">&quot;修改成功&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEmployeeDao</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 根据 id 获取员工信息</span><br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">empById</span> <span class="hljs-operator">=</span> employeeDao.getEmpById(<span class="hljs-number">1L</span>);<br>        <span class="hljs-comment">// 打印获取到的信息</span><br>        System.out.println(<span class="hljs-string">&quot;empById = &quot;</span> + empById);<br><br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>();<br>        employee.setName(<span class="hljs-string">&quot;other&quot;</span>);<br>        employee.setAge(<span class="hljs-number">20</span>);<br>        employee.setEmail(<span class="hljs-string">&quot;aaa@aaa.aaa&quot;</span>);<br>        employee.setGender(<span class="hljs-string">&quot;man&quot;</span>);<br>        employee.setAddress(<span class="hljs-string">&quot;abcdef&quot;</span>);<br>        employee.setSalary(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">&quot;9000&quot;</span>));<br>        <span class="hljs-comment">// 新增员工信息</span><br>        employeeDao.addEmp(employee);<br><br>        System.out.println(<span class="hljs-string">&quot;添加成功&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="service-层记录-1"><code>Service</code> 层记录</h4>
<ul>
<li><p><code>Service</code> 层与 <code>DAO</code>
层写起来差不多，但可以在真正做 <code>CRUD</code>
前做一些验证、拦截等操作</p></li>
<li><p>接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.service;<br><br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmployeeService</span> &#123;<br><br>    <span class="hljs-comment">// 根据 id 获取员工信息</span><br>    Employee <span class="hljs-title function_">getEmployeeById</span><span class="hljs-params">(Long id)</span>;<br>    <span class="hljs-comment">// 增加员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmployee</span><span class="hljs-params">(Employee employee)</span>;<br>    <span class="hljs-comment">// 更改员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmployee</span><span class="hljs-params">(Employee employee)</span>;<br>    <span class="hljs-comment">// 根据 id 删除员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEmployee</span><span class="hljs-params">(Long id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>实现类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.service;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.dao.EmployeeDao;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmployeeService</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeDao employeeDao;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Employee <span class="hljs-title function_">getEmployeeById</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> employeeDao.getEmpById(id);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmployee</span><span class="hljs-params">(Employee employee)</span> &#123;<br>        employeeDao.addEmp(employee);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmployee</span><span class="hljs-params">(Employee employee)</span> &#123;<br><br>        <span class="hljs-comment">// 更新员工信息时，可能只是更新一部分数据</span><br>        <span class="hljs-comment">// 而如果 employee 对象中只有想更新的数据赋了值，但不想更新的数据为 null</span><br>        <span class="hljs-comment">// 那么在做 dao 操作时就会用 null 把原来的值覆盖了</span><br>        <span class="hljs-comment">// 为了避免这种情况，先去数据库中查原值，再把要修改的值替换原值，得到了一个对象</span><br>        <span class="hljs-comment">// 再对这个对象做 dao 操作</span><br><br>        <span class="hljs-comment">// 获取要修改的员工信息的 id</span><br>        <span class="hljs-type">Long</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> employee.getId();<br>        <span class="hljs-comment">// 如果 id 为空，意味着没有传要修改员工的 id 过来，抛异常</span><br>        <span class="hljs-keyword">if</span> (id == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br><br>        <span class="hljs-comment">// 1. 如果有 id 先查值</span><br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">originEmployee</span> <span class="hljs-operator">=</span> employeeDao.getEmpById(id);<br><br>        <span class="hljs-comment">// 如果有内容就覆盖原对象中的值</span><br>        <span class="hljs-comment">// 这样如果要更新的对象没有相应的值，但原对象有，不会发生 null 数据的问题</span><br>        <span class="hljs-keyword">if</span> (StringUtils.hasText(employee.getName())) &#123;<br>            originEmployee.setName(employee.getName());<br>        &#125;<br>        <span class="hljs-keyword">if</span> (StringUtils.hasText(employee.getAddress())) &#123;<br>            originEmployee.setAddress(employee.getAddress());<br>        &#125;<br>        <span class="hljs-keyword">if</span> (StringUtils.hasText(employee.getEmail())) &#123;<br>            originEmployee.setEmail(employee.getEmail());<br>        &#125;<br>        <span class="hljs-keyword">if</span> (StringUtils.hasText(employee.getGender())) &#123;<br>            originEmployee.setGender(employee.getGender());<br>        &#125;<br>        <span class="hljs-keyword">if</span> (employee.getAge() != <span class="hljs-literal">null</span>) &#123;<br>            originEmployee.setAge(employee.getAge());<br>        &#125;<br>        <span class="hljs-keyword">if</span> (employee.getSalary() != <span class="hljs-literal">null</span>) &#123;<br>            originEmployee.setSalary(employee.getSalary());<br>        &#125;<br><br>        <span class="hljs-comment">// 2. 更新数据</span><br>        employeeDao.updateEmp(originEmployee);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEmployee</span><span class="hljs-params">(Long id)</span> &#123;<br>        employeeDao.deleteEmpById(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>测试类，这里在更新时如果只想更新部分数据就写部分就行了，因为在
<code>Service</code> 层做过空值拦截处理了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.service.EmployeeService;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeServiceTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeService employeeService;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEmployeeService2</span><span class="hljs-params">()</span> &#123;<br>        employeeService.deleteEmployee(<span class="hljs-number">5L</span>);<br>        System.out.println(<span class="hljs-string">&quot;删除成功&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// 此时不想改的数据可以不用写了，也不会为空</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEmployeeService1</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>();<br>        employee.setId(<span class="hljs-number">5L</span>);<br>        employee.setName(<span class="hljs-string">&quot;another&quot;</span>);<br>        employee.setGender(<span class="hljs-string">&quot;women&quot;</span>);<br>        <span class="hljs-comment">// 新增员工信息</span><br>        employeeService.updateEmployee(employee);<br><br>        System.out.println(<span class="hljs-string">&quot;修改成功&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEmployeeService</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 根据 id 获取员工信息</span><br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">empById</span> <span class="hljs-operator">=</span> employeeService.getEmployeeById(<span class="hljs-number">1L</span>);<br>        <span class="hljs-comment">// 打印获取到的信息</span><br>        System.out.println(<span class="hljs-string">&quot;empById = &quot;</span> + empById);<br><br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>();<br>        employee.setName(<span class="hljs-string">&quot;other&quot;</span>);<br>        employee.setAge(<span class="hljs-number">20</span>);<br>        employee.setEmail(<span class="hljs-string">&quot;aaa@aaa.aaa&quot;</span>);<br>        employee.setGender(<span class="hljs-string">&quot;man&quot;</span>);<br>        employee.setAddress(<span class="hljs-string">&quot;abcdef&quot;</span>);<br>        employee.setSalary(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">&quot;9000&quot;</span>));<br>        <span class="hljs-comment">// 新增员工信息</span><br>        employeeService.addEmployee(employee);<br><br>        System.out.println(<span class="hljs-string">&quot;添加成功&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="controller-层记录-1"><code>Controller</code> 层记录</h4>
<ul>
<li><p><code>EmployeeRestController.java</code> 类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.service.EmployeeService;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeRestController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeService employeeService;<br><br>    <span class="hljs-comment">// 根据 id 获取员工信息</span><br>    <span class="hljs-meta">@GetMapping(&quot;/employee/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> Employee <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> employeeService.getEmployeeById(id);<br>    &#125;<br><br>    <span class="hljs-comment">// 根据 id 删除员工信息</span><br>    <span class="hljs-meta">@DeleteMapping(&quot;/employee/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">delete</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;<br>        employeeService.deleteEmployee(id);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 增加员工信息</span><br>    <span class="hljs-meta">@PostMapping(&quot;/employee&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Employee employee)</span> &#123;<br>        employeeService.addEmployee(employee);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 根据 id 修改员工信息</span><br>    <span class="hljs-meta">@PutMapping(&quot;/employee&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Employee employee)</span> &#123;<br>        employeeService.updateEmployee(employee);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>上面的程序有一个问题：一会返回的是对象（json），一会返回的是字符串，不统一</p></li>
<li><p>所以要有一个统一的格式，这里选择返回有标准的 <code>json</code>
格式，标准如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;http状态码&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;msg&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;提示消息&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;返回的数据&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure></li>
<li><p>根据上面的 <code>json</code> 格式创建一个返回类
<code>R.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.common;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">R</span>&lt;T&gt;&#123;<br>    <br>    <span class="hljs-keyword">private</span> Integer code;<br>    <span class="hljs-keyword">private</span> String msg;<br>    <span class="hljs-comment">// 数据类型也可以用 Object</span><br>    <span class="hljs-keyword">private</span> T data;<br><br>    <span class="hljs-comment">// 成功时返回一个对象，数据可以自己传过来</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span>&lt;T&gt; R&lt;T&gt; <span class="hljs-title function_">ok</span><span class="hljs-params">(T data)</span> &#123;<br>        R&lt;T&gt; tr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">R</span>&lt;&gt;();<br>        tr.setCode(<span class="hljs-number">200</span>);<br>        tr.setMsg(<span class="hljs-string">&quot;ok&quot;</span>);<br>        tr.setData(data);<br>        <span class="hljs-keyword">return</span> tr;<br>    &#125;<br><br>    <span class="hljs-comment">// 上面方法的重载，成功且没有数据</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> R&lt;Object&gt; <span class="hljs-title function_">ok</span><span class="hljs-params">()</span> &#123;<br>        R&lt;Object&gt; tr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">R</span>&lt;&gt;();<br>        tr.setCode(<span class="hljs-number">200</span>);<br>        tr.setMsg(<span class="hljs-string">&quot;ok&quot;</span>);<br>        <span class="hljs-keyword">return</span> tr;<br>    &#125;<br><br>    <span class="hljs-comment">// 失败时返回一个对象，不可以指定数据</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> R <span class="hljs-title function_">error</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">R</span> <span class="hljs-variable">tr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">R</span>();<br>        tr.setCode(<span class="hljs-number">500</span>);<br>        tr.setMsg(<span class="hljs-string">&quot;error&quot;</span>);<br>        <span class="hljs-keyword">return</span> tr;<br>    &#125;<br><br>    <span class="hljs-comment">// 失败方法重载，可以自定义状态码和消息</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> R <span class="hljs-title function_">error</span><span class="hljs-params">(Integer code, String msg)</span> &#123;<br>        <span class="hljs-type">R</span> <span class="hljs-variable">tr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">R</span>();<br>        tr.setCode(code);<br>        tr.setMsg(msg);<br>        <span class="hljs-keyword">return</span> tr;<br>    &#125;<br><br>    <span class="hljs-comment">// 失败方法重载，可以自定义状态码和消息和数据</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> R <span class="hljs-title function_">error</span><span class="hljs-params">(Integer code, String msg, Object data)</span> &#123;<br>        <span class="hljs-type">R</span> <span class="hljs-variable">tr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">R</span>();<br>        tr.setCode(code);<br>        tr.setMsg(msg);<br>        tr.setData(data);<br>        <span class="hljs-keyword">return</span> tr;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>对上面的 <code>EmployeeRestController.java</code>
程序进行改造：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.common.R;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.service.EmployeeService;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeRestController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeService employeeService;<br><br>    <span class="hljs-comment">// 根据 id 获取员工信息</span><br>    <span class="hljs-meta">@GetMapping(&quot;/employee/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Employee&gt; <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;<br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">employeeById</span> <span class="hljs-operator">=</span> employeeService.getEmployeeById(id);<br><br>        <span class="hljs-keyword">return</span> R.ok(employeeById);<br>    &#125;<br><br>    <span class="hljs-comment">// 根据 id 删除员工信息</span><br>    <span class="hljs-meta">@DeleteMapping(&quot;/employee/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">delete</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;<br>        employeeService.deleteEmployee(id);<br>        <span class="hljs-keyword">return</span> R.ok();<br>    &#125;<br><br>    <span class="hljs-comment">// 增加员工信息</span><br>    <span class="hljs-meta">@PostMapping(&quot;/employee&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Employee employee)</span> &#123;<br>        employeeService.addEmployee(employee);<br>        <span class="hljs-keyword">return</span> R.ok();<br>    &#125;<br><br>    <span class="hljs-comment">// 根据 id 修改员工信息</span><br>    <span class="hljs-meta">@PutMapping(&quot;/employee&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Employee employee)</span> &#123;<br>        employeeService.updateEmployee(employee);<br>        <span class="hljs-keyword">return</span> R.ok();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h5 id="注解-pathvariable-记录">注解 <code>@PathVariable</code>
记录</h5>
<ul>
<li><p>用于获取 <code>URI</code> 上的模板变量，即获取 <code>URI</code>
上的模板变量然后赋值给被标注的变量，<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-requestmapping.html#mvc-ann-requestmapping-uri-templates">官方文档</a></p></li>
<li><p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 此时 @PathVariable 获取的就是路径上的 myvar 的值，并赋给 id 变量</span><br><span class="hljs-meta">@GetMapping(&quot;/abc/&#123;myvar&#125;&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;myvar&quot;)</span> Long id)</span> &#123;&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>注解参数 <code>value</code>：类型为
<code>String</code>，作用同注解参数 <code>name</code></p>
<ul>
<li>用于指定要获取的是 <code>URI</code>
上的哪一个模板变量（即指定模板变量名）</li>
</ul></li>
<li><p>注解参数 <code>name</code>：类型为
<code>String</code>，作用同注解参数 <code>value</code></p></li>
<li><p>注解参数 <code>required</code>：类型为
<code>boolean</code>，默认值为 <code>true</code></p>
<ul>
<li>如果注解参数值为 <code>true</code> 而在 <code>URI</code>
上又没有相应的模板变量，则会出现错误</li>
</ul></li>
</ul>
<h5
id="补充获取所有员工信息的编写记录">补充：获取所有员工信息的编写记录</h5>
<ul>
<li><p><code>DAO</code> 层：</p>
<ul>
<li><p>接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.dao;<br><br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmployeeDao</span> &#123;<br><br>    <span class="hljs-comment">// 根据 id 获取员工信息</span><br>    Employee <span class="hljs-title function_">getEmpById</span><span class="hljs-params">(Long id)</span>;<br>    <span class="hljs-comment">// 新增员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmp</span><span class="hljs-params">(Employee emp)</span>;<br>    <span class="hljs-comment">// 修改员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmp</span><span class="hljs-params">(Employee emp)</span>;<br>    <span class="hljs-comment">// 根据 id 删除员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEmpById</span><span class="hljs-params">(Long id)</span>;<br>    <span class="hljs-comment">// 查询所有员工信息</span><br>    List&lt;Employee&gt; <span class="hljs-title function_">getEmployees</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>实现类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.dao;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.BeanPropertyRowMapper;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmployeeDao</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> JdbcTemplate jdbcTemplate;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Employee <span class="hljs-title function_">getEmpById</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-comment">// 定义 sql 语句</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from employee where id = ?&quot;</span>;<br>        <span class="hljs-comment">// 执行语句并接收返回结果</span><br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> jdbcTemplate.queryForObject(sql, <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanPropertyRowMapper</span>&lt;Employee&gt;(Employee.class), id);<br>        <span class="hljs-comment">// 把结果返回</span><br>        <span class="hljs-keyword">return</span> employee;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmp</span><span class="hljs-params">(Employee emp)</span> &#123;<br>        <span class="hljs-comment">// 定义 sql 语句</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;insert into employee(name, age, email, gender, address, salary) values (?, ?, ?, ?, ?, ?)&quot;</span>;<br>        <span class="hljs-comment">// 执行语句</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">update</span> <span class="hljs-operator">=</span> jdbcTemplate.update(sql,<br>                emp.getName(),<br>                emp.getAge(),<br>                emp.getEmail(),<br>                emp.getGender(),<br>                emp.getAddress(),<br>                emp.getSalary());<br>        <span class="hljs-comment">// 打印影响行数</span><br>        System.out.println(<span class="hljs-string">&quot;影响行数：&quot;</span> + update);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmp</span><span class="hljs-params">(Employee emp)</span> &#123;<br>        <span class="hljs-comment">// 定义 sql 语句</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;update employee set name=?,age=?,email=?,gender=?,address=?,salary=? where id=?&quot;</span>;<br>        <span class="hljs-comment">// 执行语句</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">update</span> <span class="hljs-operator">=</span> jdbcTemplate.update(sql,<br>                emp.getName(),<br>                emp.getAge(),<br>                emp.getEmail(),<br>                emp.getGender(),<br>                emp.getAddress(),<br>                emp.getSalary(),<br>                emp.getId());<br>        <span class="hljs-comment">// 打印影响行数</span><br>        System.out.println(<span class="hljs-string">&quot;影响行数：&quot;</span> + update);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEmpById</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-comment">// 定义 sql 语句</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;delete from employee where id = ?&quot;</span>;<br>        <span class="hljs-comment">// 执行语句</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">update</span> <span class="hljs-operator">=</span> jdbcTemplate.update(sql, id);<br>        <span class="hljs-comment">// 打印影响行数</span><br>        System.out.println(<span class="hljs-string">&quot;影响行数：&quot;</span> + update);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> List&lt;Employee&gt; <span class="hljs-title function_">getEmployees</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 定义 sql 语句</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from employee&quot;</span>;<br>        <span class="hljs-comment">// 执行语句</span><br>        List&lt;Employee&gt; employeeList = jdbcTemplate.query(sql, <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanPropertyRowMapper</span>&lt;&gt;(Employee.class));<br>        <span class="hljs-comment">// 返回数据</span><br>        <span class="hljs-keyword">return</span> employeeList;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p><code>Service</code> 层：</p>
<ul>
<li><p>接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.service;<br><br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmployeeService</span> &#123;<br><br>    <span class="hljs-comment">// 根据 id 获取员工信息</span><br>    Employee <span class="hljs-title function_">getEmployeeById</span><span class="hljs-params">(Long id)</span>;<br>    <span class="hljs-comment">// 增加员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmployee</span><span class="hljs-params">(Employee employee)</span>;<br>    <span class="hljs-comment">// 更改员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmployee</span><span class="hljs-params">(Employee employee)</span>;<br>    <span class="hljs-comment">// 根据 id 删除员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEmployee</span><span class="hljs-params">(Long id)</span>;<br>    <span class="hljs-comment">// 查询所有员工信息</span><br>    List&lt;Employee&gt; <span class="hljs-title function_">getAllEmployee</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>实现类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.restful.service;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.restful.dao.EmployeeDao;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmployeeService</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeDao employeeDao;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Employee <span class="hljs-title function_">getEmployeeById</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> employeeDao.getEmpById(id);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmployee</span><span class="hljs-params">(Employee employee)</span> &#123;<br>        employeeDao.addEmp(employee);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmployee</span><span class="hljs-params">(Employee employee)</span> &#123;<br><br>        <span class="hljs-comment">// 更新员工信息时，可能只是更新一部分数据</span><br>        <span class="hljs-comment">// 而如果 employee 对象中只有想更新的数据赋了值，但不想更新的数据为 null</span><br>        <span class="hljs-comment">// 那么在做 dao 操作时就会用 null 把原来的值覆盖了</span><br>        <span class="hljs-comment">// 为了避免这种情况，先去数据库中查原值，再把要修改的值替换原值，得到了一个对象</span><br>        <span class="hljs-comment">// 再对这个对象做 dao 操作</span><br><br>        <span class="hljs-comment">// 获取要修改的员工信息的 id</span><br>        <span class="hljs-type">Long</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> employee.getId();<br>        <span class="hljs-comment">// 如果 id 为空，意味着没有传要修改员工的 id 过来，抛异常</span><br>        <span class="hljs-keyword">if</span> (id == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br><br>        <span class="hljs-comment">// 1. 如果有 id 先查值</span><br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">originEmployee</span> <span class="hljs-operator">=</span> employeeDao.getEmpById(id);<br><br>        <span class="hljs-comment">// 如果有内容就覆盖原对象中的值</span><br>        <span class="hljs-comment">// 这样如果要更新的对象没有相应的值，但原对象有，不会发生 null 数据的问题</span><br>        <span class="hljs-keyword">if</span> (StringUtils.hasText(employee.getName())) &#123;<br>            originEmployee.setName(employee.getName());<br>        &#125;<br>        <span class="hljs-keyword">if</span> (StringUtils.hasText(employee.getAddress())) &#123;<br>            originEmployee.setAddress(employee.getAddress());<br>        &#125;<br>        <span class="hljs-keyword">if</span> (StringUtils.hasText(employee.getEmail())) &#123;<br>            originEmployee.setEmail(employee.getEmail());<br>        &#125;<br>        <span class="hljs-keyword">if</span> (StringUtils.hasText(employee.getGender())) &#123;<br>            originEmployee.setGender(employee.getGender());<br>        &#125;<br>        <span class="hljs-keyword">if</span> (employee.getAge() != <span class="hljs-literal">null</span>) &#123;<br>            originEmployee.setAge(employee.getAge());<br>        &#125;<br>        <span class="hljs-keyword">if</span> (employee.getSalary() != <span class="hljs-literal">null</span>) &#123;<br>            originEmployee.setSalary(employee.getSalary());<br>        &#125;<br><br>        <span class="hljs-comment">// 2. 更新数据</span><br>        employeeDao.updateEmp(originEmployee);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEmployee</span><span class="hljs-params">(Long id)</span> &#123;<br>        employeeDao.deleteEmpById(id);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> List&lt;Employee&gt; <span class="hljs-title function_">getAllEmployee</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> employeeDao.getEmployees();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p><code>Controller</code> 层：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs sjava">package org.wind.springmvc.restful.controller;<br><br>import org.springframework.beans.factory.annotation.Autowired;<br>import org.springframework.web.bind.annotation.*;<br>import org.wind.springmvc.restful.bean.Employee;<br>import org.wind.springmvc.restful.common.R;<br>import org.wind.springmvc.restful.service.EmployeeService;<br><br>import java.util.List;<br><br>@RestController<br>public class EmployeeRestController &#123;<br><br>    @Autowired<br>    EmployeeService employeeService;<br><br>    // 根据 id 获取员工信息<br>    @GetMapping(&quot;/employee/&#123;id&#125;&quot;)<br>    public R&lt;Employee&gt; get(@PathVariable(&quot;id&quot;) Long id) &#123;<br>        Employee employeeById = employeeService.getEmployeeById(id);<br><br>        return R.ok(employeeById);<br>    &#125;<br><br>    // 根据 id 删除员工信息<br>    @DeleteMapping(&quot;/employee/&#123;id&#125;&quot;)<br>    public R&lt;Object&gt; delete(@PathVariable(&quot;id&quot;) Long id) &#123;<br>        employeeService.deleteEmployee(id);<br>        return R.ok();<br>    &#125;<br><br>    // 增加员工信息<br>    @PostMapping(&quot;/employee&quot;)<br>    public R&lt;Object&gt; add(@RequestBody Employee employee) &#123;<br>        employeeService.addEmployee(employee);<br>        return R.ok();<br>    &#125;<br><br>    // 根据 id 修改员工信息<br>    @PutMapping(&quot;/employee&quot;)<br>    public R&lt;Object&gt; update(@RequestBody Employee employee) &#123;<br>        employeeService.updateEmployee(employee);<br>        return R.ok();<br>    &#125;<br><br>    // 查询所有员工信息<br>    @GetMapping(&quot;/employees&quot;)<br>    public R&lt;Object&gt; all() &#123;<br>        List&lt;Employee&gt; employees = employeeService.getAllEmployee();<br>        return R.ok(employees);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="cors-记录"><code>CORS</code> 记录</h3>
<ul>
<li><p>在前端写 <code>AJAX</code>
请求访问后端写好的接口时，经常会遇到一个错误：</p>
<ul>
<li><code>xxx has been blocked by CORS policy: Response to preflight request doesn't pass access control check: No 'Access-Control-Allow-Origin' header is present on the requested resource.</code></li>
</ul></li>
<li><p>以上错误是由于 <code>CORS</code> 策略引发的，即<a
target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">同源策略</a></p>
<ul>
<li>如果不是同一个（域名、端口和协议）则会引发跨域问题</li>
</ul></li>
<li><p>解决 <code>CORS</code> 方法：</p>
<ul>
<li><code>jsonp</code>（JSON with Padding） 方法</li>
<li>反向代理配置，开发时可以用 <code>vite</code> 配置，部署时可以用
<code>nginx</code> 配置，等等...，这里不演示</li>
<li>后端做处理，允许前端跨域：使用 <code>@CrossOrigin</code>
注解，原理是在响应头中加了 <code>Access-Control-Allow-Origin: *</code>
<a
target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin">MDN文档</a></li>
</ul></li>
</ul>
<h4 id="注解-crossorigin-记录">注解 <code>@CrossOrigin</code> 记录</h4>
<ul>
<li>这个注解在 <code>SpringMVC</code>
中用于解决跨域问题，可以在类上注解，也可以在方法上注解，<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc-cors.html">官方文档</a></li>
</ul>
<h2 id="接口-handlerinterceptor-拦截器记录">6. 接口
<code>HandlerInterceptor</code> （拦截器）记录</h2>
<h3
id="什么是拦截器handlerinterceptor记录">什么是拦截器（<code>HandlerInterceptor</code>）记录</h3>
<ul>
<li><p>类似于 <code>Filter</code> 过滤器，<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-servlet/handlermapping-interceptor.html">官方文档</a></p></li>
<li><p>用于在请求到达 <code>Controller</code>
目标方法前和目标方法执行后做一些操作，比如：</p>
<ul>
<li>登录权限验证</li>
<li>日志记录</li>
<li>等...</li>
</ul></li>
<li><p><code>SpringMVC</code> 中的 <code>HandlerInterceptor</code>
接口有三个方法：</p>
<ul>
<li><p><code>preHandle</code> 方法：目标方法执行前调用这个方法</p>
<ul>
<li>返回值为 <code>boolean</code> 如果为 <code>true</code>
则放行，<code>false</code> 则不放行（目标方法不执行）</li>
</ul></li>
<li><p><code>postHandle</code>
方法：目标方法成功执行后调用这个方法</p></li>
<li><p><code>afterCompletion</code>
方法：完成请求处理（渲染视图完成）后再调用这个方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br>    <br>    <span class="hljs-comment">// 目标方法执行前调用</span><br>	<span class="hljs-keyword">default</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span><br>			<span class="hljs-keyword">throws</span> Exception &#123;<br><br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>	&#125;<br>    <br>    <span class="hljs-comment">// 目标方法成功执行后调用</span><br>	<span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler,</span><br><span class="hljs-params">			<span class="hljs-meta">@Nullable</span> ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>	&#125;<br><br>    <span class="hljs-comment">// 渲染视图完成后调用</span><br>	<span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler,</span><br><span class="hljs-params">			<span class="hljs-meta">@Nullable</span> Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h3 id="如何编写一个拦截器记录">如何编写一个拦截器记录</h3>
<ul>
<li><p>写一个类实现 <code>HandlerInterceptor</code> 接口，并把这个类放到
<code>IoC</code> 容器中</p></li>
<li><p>配置需要拦截的请求路径：</p>
<ul>
<li><a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-config/interceptors.html">官方文档</a></li>
<li>配置文件：<code>xml</code> 文件</li>
<li>配置类：<code>WebMvcConfigurer</code> 放到容器中</li>
</ul></li>
<li><p>实现 <code>HandlerInterceptor</code> 接口，并重写方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.interceptor;<br><br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandlerInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor.preHandle&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor.postHandle&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor.afterCompletion&quot;</span>);<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>配置拦截器：</p>
<ul>
<li><p>方法 1：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.config;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.interceptor.MyHandlerInterceptor;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MySpringMVCConfig</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    MyHandlerInterceptor myHandlerInterceptor;<br><br>    <span class="hljs-meta">@Bean</span><br>    WebMvcConfigurer <span class="hljs-title function_">webMvcConfigurer</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebMvcConfigurer</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> &#123;<br>                registry.addInterceptor(myHandlerInterceptor)<br>                        <span class="hljs-comment">// 添加路径规则，拦截所有请求</span><br>                        .addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>)<br>                        <span class="hljs-comment">// 不拦截下面的请求</span><br>                        .excludePathPatterns(<span class="hljs-string">&quot;/login&quot;</span>);<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>方法 2：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.config;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.interceptor.MyHandlerInterceptor;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MySpringMVCConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    MyHandlerInterceptor myHandlerInterceptor;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> &#123;<br>        registry.addInterceptor(myHandlerInterceptor)<br>            	<span class="hljs-comment">// 添加路径规则，拦截所有请求</span><br>                .addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>)<br>	            <span class="hljs-comment">// 不拦截下面的请求</span><br>                .excludePathPatterns(<span class="hljs-string">&quot;/login&quot;</span>);<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h3 id="多个拦截器的执行顺序记录">多个拦截器的执行顺序记录</h3>
<ul>
<li><p>多写几个拦截器进行测试：</p></li>
<li><p><code>MyHandlerInterceptor</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.interceptor;<br><br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandlerInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor.preHandle&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor.postHandle&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor.afterCompletion&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>MyHandlerInterceptor1</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.interceptor;<br><br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandlerInterceptor1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor1.preHandle&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor1.postHandle&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor1.afterCompletion&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>MyHandlerInterceptor2</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.interceptor;<br><br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandlerInterceptor2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor2.preHandle&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor2.postHandle&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor2.afterCompletion&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>配置类中添加拦截器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.config;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.interceptor.MyHandlerInterceptor;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.interceptor.MyHandlerInterceptor1;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.interceptor.MyHandlerInterceptor2;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MySpringMVCConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    MyHandlerInterceptor myHandlerInterceptor;<br><br>    <span class="hljs-meta">@Autowired</span><br>    MyHandlerInterceptor1 myHandlerInterceptor1;<br><br>    <span class="hljs-meta">@Autowired</span><br>    MyHandlerInterceptor2 myHandlerInterceptor2;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> &#123;<br>        registry.addInterceptor(myHandlerInterceptor)<br>                .addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>)<br>                .excludePathPatterns(<span class="hljs-string">&quot;/login&quot;</span>);<br><br>        registry.addInterceptor(myHandlerInterceptor1)<br>                .addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>)<br>                .excludePathPatterns(<span class="hljs-string">&quot;/login&quot;</span>);<br><br>        registry.addInterceptor(myHandlerInterceptor2)<br>                .addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>)<br>                .excludePathPatterns(<span class="hljs-string">&quot;/login&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>发请求进行测试，得出顺序为：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs txt">MyHandlerInterceptor.preHandle<br>MyHandlerInterceptor1.preHandle<br>MyHandlerInterceptor2.preHandle<br>MyHandlerInterceptor2.postHandle<br>MyHandlerInterceptor1.postHandle<br>MyHandlerInterceptor.postHandle<br>MyHandlerInterceptor2.afterCompletion<br>MyHandlerInterceptor1.afterCompletion<br>MyHandlerInterceptor.afterCompletion<br></code></pre></td></tr></table></figure></li>
<li><p>可以得出结论：</p>
<ul>
<li><code>preHandle</code> 按顺序执行</li>
<li><code>postHandle</code> 倒序执行</li>
<li><code>afterCompletion</code> 倒序执行</li>
</ul></li>
<li><p>如果 <code>MyHandlerInterceptor1</code> 中的
<code>preHandle</code> 不放行：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.interceptor;<br><br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandlerInterceptor1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor1.preHandle&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor1.postHandle&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyHandlerInterceptor1.afterCompletion&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>测试结果为：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">MyHandlerInterceptor.preHandle<br>MyHandlerInterceptor1.preHandle<br>MyHandlerInterceptor.afterCompletion<br></code></pre></td></tr></table></figure></li>
<li><p>得出结论：</p>
<ul>
<li><code>postHandle</code> 只有在所有拦截器的 <code>preHandle</code>
方法放行后才会执行</li>
<li>如果在其中的一个 <code>preHandle</code> 不放行，那么所有拦截器的
<code>postHandle</code> 都不执行</li>
<li>如果在其中的一个 <code>preHandle</code>
不放行，那么不放行的拦截器之前的所有拦截器的
<code>afterCompletion</code> 都执行</li>
<li>即使 <code>postHandle</code> 在执行中出错，但所有的
<code>afterCompletion</code> 都会执行，因为在执行
<code>postHandle</code> 前所有的 <code>preHandler</code> 都放行了</li>
</ul></li>
</ul>
<h3 id="springmvc-中写一个过滤器filter记录"><code>SpringMVC</code>
中写一个过滤器（Filter）记录</h3>
<ul>
<li><p>编写一个实现 <code>Filter</code> 接口的类，并放到容器中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.filter;<br><br><span class="hljs-keyword">import</span> jakarta.servlet.*;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Filter</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException &#123;<br>        System.out.println(<span class="hljs-string">&quot;before doFilter&quot;</span>);<br>        chain.doFilter(request, response);<br>        System.out.println(<span class="hljs-string">&quot;after doFilter&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(FilterConfig filterConfig)</span> <span class="hljs-keyword">throws</span> ServletException &#123;<br>        Filter.<span class="hljs-built_in">super</span>.init(filterConfig);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> &#123;<br>        Filter.<span class="hljs-built_in">super</span>.destroy();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>但这样所有的请求都会进行过滤，即 <code>@WebFilter</code>
注解用不了了</p></li>
</ul>
<h3 id="拦截器和过滤器的区别记录">拦截器和过滤器的区别记录</h3>
<table>

<thead>
<tr>
<th></th>
<th>拦截器</th>
<th>过滤器</th>
</tr>
</thead>
<tbody>
<tr>
<td>接口</td>
<td>HandlerInterceptor</td>
<td>Filter</td>
</tr>
<tr>
<td>定义</td>
<td>Spring 定义</td>
<td>Apache 定义</td>
</tr>
<tr>
<td>放行</td>
<td>preHandle 方法返回 true 时放行</td>
<td>调用 chain.doFilter 方法放行</td>
</tr>
<tr>
<td>整合性</td>
<td>可以直接整合 Spring 容器的所有组件</td>
<td>不受 Spring
容器管理，无法直接使用容器中的组件，需要放到容器中，才可以使用</td>
</tr>
<tr>
<td>拦截范围</td>
<td>拦截 SpringMVC 能处理的请求</td>
<td>拦截 Web 应用所有请求</td>
</tr>
<tr>
<td>执行顺序</td>
<td>在过滤器执行后，拦截器才执行，拦截器全部执行后，过滤器又再执行</td>
<td>先比拦截器先，后比拦截器后</td>
</tr>
</tbody>
</table>
<ul>
<li>在 <code>SpringMVC</code> 的应用中，推荐使用拦截器</li>
</ul>
<h2 id="异常处理记录">7. 异常处理记录</h2>
<ul>
<li><p><a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-exceptionhandler.html">官方文档</a></p></li>
<li><p>编程式异常处理：通过写处理异常代码方式处理</p>
<ul>
<li>try ... catch</li>
<li>throw</li>
</ul></li>
<li><p>声明式异常处理：通过注解等方式进行处理</p>
<ul>
<li><code>@ExceptionHandler</code>：<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-exceptionhandler.html">官方文档</a></li>
<li><code>@ControllerAdvice</code>：<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-advice.html">官方文档</a></li>
</ul></li>
<li><p>开始之前写一个返回对象，为了统一返回格式：<code>R.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.common;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">R</span>&lt;T&gt; &#123;<br><br>    <span class="hljs-keyword">private</span> Integer code;<br>    <span class="hljs-keyword">private</span> String msg;<br>    <span class="hljs-comment">// 数据类型也可以用 Object</span><br>    <span class="hljs-keyword">private</span> T data;<br><br>    <span class="hljs-comment">// 成功时返回一个对象，数据可以自己传过来</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; R&lt;T&gt; <span class="hljs-title function_">ok</span><span class="hljs-params">(T data)</span> &#123;<br>        R&lt;T&gt; tr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">R</span>&lt;&gt;();<br>        tr.setCode(<span class="hljs-number">200</span>);<br>        tr.setMsg(<span class="hljs-string">&quot;ok&quot;</span>);<br>        tr.setData(data);<br>        <span class="hljs-keyword">return</span> tr;<br>    &#125;<br><br>    <span class="hljs-comment">// 上面方法的重载，成功且没有数据</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> R&lt;Object&gt; <span class="hljs-title function_">ok</span><span class="hljs-params">()</span> &#123;<br>        R&lt;Object&gt; tr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">R</span>&lt;&gt;();<br>        tr.setCode(<span class="hljs-number">200</span>);<br>        tr.setMsg(<span class="hljs-string">&quot;ok&quot;</span>);<br>        <span class="hljs-keyword">return</span> tr;<br>    &#125;<br><br>    <span class="hljs-comment">// 失败时返回一个对象，不可以指定数据</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> R <span class="hljs-title function_">error</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">R</span> <span class="hljs-variable">tr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">R</span>();<br>        tr.setCode(<span class="hljs-number">500</span>);<br>        tr.setMsg(<span class="hljs-string">&quot;error&quot;</span>);<br>        <span class="hljs-keyword">return</span> tr;<br>    &#125;<br><br>    <span class="hljs-comment">// 失败方法重载，可以自定义状态码和消息</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> R <span class="hljs-title function_">error</span><span class="hljs-params">(Integer code, String msg)</span> &#123;<br>        <span class="hljs-type">R</span> <span class="hljs-variable">tr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">R</span>();<br>        tr.setCode(code);<br>        tr.setMsg(msg);<br>        <span class="hljs-keyword">return</span> tr;<br>    &#125;<br><br>    <span class="hljs-comment">// 失败方法重载，可以自定义状态码和消息和数据</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> R <span class="hljs-title function_">error</span><span class="hljs-params">(Integer code, String msg, Object data)</span> &#123;<br>        <span class="hljs-type">R</span> <span class="hljs-variable">tr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">R</span>();<br>        tr.setCode(code);<br>        tr.setMsg(msg);<br>        tr.setData(data);<br>        <span class="hljs-keyword">return</span> tr;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再写一个类作测试 <code>TestController.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestController</span> &#123;&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="编程式异常处理记录">编程式异常处理记录</h3>
<ul>
<li><p>编写 <code>Mapping</code> 测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/test&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">test</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;i&quot;, defaultValue = &quot;0&quot;)</span> Integer i)</span> &#123;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 这里有可能出现异常（当 i 为 0 时）</span><br>            <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span> / i;<br>            <span class="hljs-comment">// 成功就返回成功对象</span><br>            <span class="hljs-keyword">return</span> R.ok(j);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-comment">// 失败返回失败对象</span><br>            <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">500</span>, <span class="hljs-string">&quot;执行异常&quot;</span>);<br>        &#125;<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>这样写，如果有很多 <code>Mapping</code>
在处理请求时都有可能发生异常，那么就要写很多个
<code>try...catch...</code> 语句</p></li>
</ul>
<h3 id="注解式异常处理记录">注解式异常处理记录</h3>
<ul>
<li><p>编写 <code>Mapping</code> 与 <code>ExceptionHandler</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/test&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">test</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;i&quot;, defaultValue = &quot;0&quot;)</span> Integer i)</span> &#123;<br>        <span class="hljs-comment">// 这里有可能出现异常（当 i 为 0 时）</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span> / i;<br>        <span class="hljs-comment">// 成功就返回成功对象</span><br>        <span class="hljs-keyword">return</span> R.ok(j);<br><br>    &#125;<br><br>    <span class="hljs-comment">// 当发生指定异常时会调用下面的方法</span><br>    <span class="hljs-meta">@ExceptionHandler(ArithmeticException.class)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">handleArithmeticException</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">500</span>, <span class="hljs-string">&quot;执行异常&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>如果想要获取到异常的信息，可以在被注解的方法参数上写一个异常类参数用于接收异常信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/test&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">test</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;i&quot;, defaultValue = &quot;0&quot;)</span> Integer i)</span> &#123;<br>        <span class="hljs-comment">// 这里有可能出现异常（当 i 为 0 时）</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span> / i;<br>        <span class="hljs-comment">// 成功就返回成功对象</span><br>        <span class="hljs-keyword">return</span> R.ok(j);<br><br>    &#125;<br><br>    <span class="hljs-comment">// 有一个专门处理指定异常的方法</span><br>    <span class="hljs-meta">@ExceptionHandler(ArithmeticException.class)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">handleArithmeticException</span><span class="hljs-params">(ArithmeticException e)</span> &#123;<br>        <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">500</span>, <span class="hljs-string">&quot;执行异常：&quot;</span> + e.getMessage());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>如果发生其它类型的异常可以在 <code>@ExceptionHandler</code>
注解参数中再写一个要处理的异常</p></li>
<li><p>也可以再写一个方法处理：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><br><span class="hljs-keyword">import</span> java.io.FileInputStream;<br><span class="hljs-keyword">import</span> java.io.FileNotFoundException;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/test&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">test</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;i&quot;, defaultValue = &quot;0&quot;)</span> Integer i)</span> <span class="hljs-keyword">throws</span> FileNotFoundException &#123;<br>        <span class="hljs-comment">// 这里有可能出现异常（当 i 为 0 时）</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span> / i;<br><br>        <span class="hljs-comment">// 有可能文件不存在</span><br>        <span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fileInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;D:\\abc.abc&quot;</span>);<br><br>        <span class="hljs-comment">// 成功就返回成功对象</span><br>        <span class="hljs-keyword">return</span> R.ok(j);<br><br>    &#125;<br><br>    <span class="hljs-comment">// 有一个专门处理指定异常的方法</span><br>    <span class="hljs-meta">@ExceptionHandler(ArithmeticException.class)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">handleArithmeticException</span><span class="hljs-params">(ArithmeticException e)</span> &#123;<br>        <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">500</span>, <span class="hljs-string">&quot;执行异常：&quot;</span> + e.getMessage());<br>    &#125;<br><br>    <span class="hljs-comment">// 处理文件找不到的异常的方法</span><br>    <span class="hljs-meta">@ExceptionHandler(FileNotFoundException.class)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">handleFileNotFoundException</span><span class="hljs-params">(FileNotFoundException e)</span> &#123;<br>        <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">300</span>, <span class="hljs-string">&quot;执行异常&quot;</span> + e.getMessage());<br>    &#125;<br><br>    <span class="hljs-comment">// 处理其它异常的方法</span><br>    <span class="hljs-meta">@ExceptionHandler(Throwable.class)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">handleThrowable</span><span class="hljs-params">(Throwable throwable)</span> &#123;<br>        <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">500</span>, throwable.getMessage());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="注解-exceptionhandler-记录">注解 <code>@ExceptionHandler</code>
记录</h3>
<ul>
<li>这个作用是当发生注解参数 <code>value</code>
指定的异常时调用被注解标注的方法，只能标注在方法上</li>
<li>参数 <code>value</code>：类型为
<code>Class&lt;? extends Throwable&gt;[]</code>，指定什么异常会处理，可以写多个异常类</li>
</ul>
<h3 id="全局异常处理">全局异常处理</h3>
<ul>
<li><p>在上面的代码中，用注解 <code>@ExceptionHandler</code>
注解标注的方法只能处理所在类的异常，不能处理其它类发生的异常</p></li>
<li><p>这时就需要用到 <code>@ControllerAdvice</code> 了</p></li>
<li><p>即用全局异常处理器，全局异常处理器里面有多个处理异常的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.advice;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><br><span class="hljs-comment">// 全局异常处理器</span><br><span class="hljs-comment">//@ResponseBody</span><br><span class="hljs-comment">//@ControllerAdvice</span><br><span class="hljs-meta">@RestControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalExceptionHandler</span> &#123;<br><br>    <span class="hljs-comment">//@ResponseBody</span><br>    <span class="hljs-meta">@ExceptionHandler(Exception.class)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">error</span><span class="hljs-params">(Exception e)</span> &#123;<br>        <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">500</span>, e.getMessage());<br>    &#125;<br><br>    <span class="hljs-meta">@ExceptionHandler(ArithmeticException.class)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">error</span><span class="hljs-params">(ArithmeticException e)</span> &#123;<br>        <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">500</span>, e.getMessage());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>注意：</p>
<ul>
<li>如果在处理异常的方法上不加 <code>@ResponseBody</code>
注解，那么返回的是视图名称，会出错</li>
<li>可以在这个全局异常处理器类上加 <code>@ResponseBody</code>
注解，这样所有异常处理方法返回的都是对象了</li>
<li>如果需要在类上加 <code>@ResponseBody</code> 和
<code>@ControllerAdvice</code> 注解，在 <code>SpringMVC</code>
有个二合一注解，即 <code>@RestControllerAdvice</code> 注解</li>
</ul></li>
</ul>
<h3 id="注解-controlleradvice-记录">注解 <code>@ControllerAdvice</code>
记录</h3>
<ul>
<li>用于指定一个类作为全局异常处理器，并把这个类放到 <code>IoC</code>
容器中</li>
<li>被这个注解标注的类中应有多个异常处理方法（被
<code>@ExceptionHandler</code> 注解标注的方法）</li>
</ul>
<h3 id="注解-restcontrolleradvice-记录">注解
<code>@RestControllerAdvice</code> 记录</h3>
<ul>
<li><code>@RestControllerAdvice</code> = <code>@ControllerAdvice</code>
+ <code>@ResponseBody</code></li>
</ul>
<h3 id="异常处理优先级记录">异常处理优先级记录</h3>
<ul>
<li>本类有异常处理方法，就用本类的异常处理方法，即
<code>本类 &gt; 全局</code></li>
<li>在本类中有多个异常处理的方法都能处理发生的异常，就优先使用精确匹配的方法，即
<code>精确 &gt; 模糊</code></li>
<li>如果本类异常处理方法和全局异常处理器都不能处理异常，就用
<code>SpringMVC</code> 默认异常处理</li>
</ul>
<h3 id="一个异常解决方案记录">一个异常解决方案记录</h3>
<ul>
<li><p>定义一个业务异常类：<code>BizException.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.exception;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BizException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RuntimeException</span> &#123;<br><br>    <span class="hljs-comment">// 业务异常码</span><br>    <span class="hljs-keyword">private</span> Integer code;<br>    <span class="hljs-comment">// 业务异常信息提示</span><br>    <span class="hljs-keyword">private</span> String msg;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BizException</span><span class="hljs-params">(Integer code, String msg)</span> &#123;<br>        <span class="hljs-built_in">super</span>(msg);<br>        <span class="hljs-built_in">this</span>.code = code;<br>        <span class="hljs-built_in">this</span>.msg = msg;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BizException</span><span class="hljs-params">(BizExceptionEnum bizExceptionEnum)</span> &#123;<br>        <span class="hljs-built_in">super</span>(bizExceptionEnum.getMsg());<br>        <span class="hljs-built_in">this</span>.code = bizExceptionEnum.getCode();<br>        <span class="hljs-built_in">this</span>.msg = bizExceptionEnum.getMsg();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>把异常码和信息枚举出来，定义成一个类：<code>BizExceptionEnum.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.exception;<br><br><span class="hljs-keyword">import</span> lombok.Getter;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">BizExceptionEnum</span> &#123;<br><br>    ORDER_CLOSED(<span class="hljs-number">10001</span>, <span class="hljs-string">&quot;订单已关闭&quot;</span>),<br>    ORDER_NOT_EXIST(<span class="hljs-number">10002</span>, <span class="hljs-string">&quot;订单不存在&quot;</span>),<br>    ORDER_TIMEOUT(<span class="hljs-number">10003</span>, <span class="hljs-string">&quot;订单超时&quot;</span>),<br><br>    PRODUCT_STOCK_NOT_ENOUGH(<span class="hljs-number">20003</span>, <span class="hljs-string">&quot;库存不足&quot;</span>),<br>    PRODUCT_HAS_SOLD(<span class="hljs-number">20002</span>, <span class="hljs-string">&quot;商品已售完&quot;</span>),<br>    PRODUCT_HAS_CLOSED(<span class="hljs-number">20001</span>, <span class="hljs-string">&quot;商品已下架&quot;</span>);<br><br>    <span class="hljs-meta">@Getter</span><br>    <span class="hljs-keyword">private</span> Integer code;<br>    <span class="hljs-meta">@Getter</span><br>    <span class="hljs-keyword">private</span> String msg;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">BizExceptionEnum</span><span class="hljs-params">(Integer code, String msg)</span> &#123;<br>        <span class="hljs-built_in">this</span>.code = code;<br>        <span class="hljs-built_in">this</span>.msg = msg;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>需要抛异常时：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BizException</span>(BizExceptionEnum.ORDER_CLOSED.getCode(), BizExceptionEnum.ORDER_CLOSED.getMsg());<br></code></pre></td></tr></table></figure></li>
<li><p>再在全局异常处理器中添加相应处理方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.advice;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.exception.BizException;<br><br><span class="hljs-meta">@RestControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalExceptionHandler</span> &#123;<br><br>    <span class="hljs-meta">@ExceptionHandler(BizException.class)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">error</span><span class="hljs-params">(BizException e)</span> &#123;<br>        <span class="hljs-keyword">return</span> R.error(e.getCode(), e.getMessage());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>总结步骤：</p>
<ul>
<li>写一个业务异常类</li>
<li>写一个异常枚举类，列出可能出现的异常码和信息</li>
<li>出现问题抛业务异常</li>
<li>全局处理器加处理方法</li>
</ul></li>
</ul>
<h2 id="数据校验">8. 数据校验</h2>
<ul>
<li><p>数据拿到后要进行合法性校验，看看符不符合要求，前端后端都要做</p></li>
<li><p>导入 <code>starter</code>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>注解官方文档：<a
target="_blank" rel="noopener" href="https://jakarta.ee/learn/docs/jakartaee-tutorial/current/beanvalidation/bean-validation/bean-validation.html">Jakarta
Bean Validation</a></p></li>
<li><p>开启数据校验步骤（三步）</p>
<ul>
<li>导入数据校验用的包</li>
<li>用注解标注需要校验的字段或属性</li>
<li>使用 <code>@Valid</code> 注解告诉 <code>SpringMVC</code>
开启进行校验，<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-validation.html">官方文档</a></li>
</ul></li>
</ul>
<table>

<thead>
<tr>
<th>注解</th>
<th>注解描述</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@AssertFalse</code></td>
<td>属性值必须为 <code>false</code></td>
<td><span class="citation"
data-cites="AssertFalse&lt;br">@AssertFalse&lt;br</span>/&gt;boolean
isUnsupported;</td>
</tr>
<tr>
<td><code>@AssertTrue</code></td>
<td>属性值必须为 <code>true</code></td>
<td><span class="citation"
data-cites="AssertTrue&lt;br">@AssertTrue&lt;br</span>/&gt;boolean
isActive;</td>
</tr>
<tr>
<td><code>@DecimalMax</code></td>
<td>属性值小于等于指定的十进制数</td>
<td><span class="citation"
data-cites="DecimalMax">@DecimalMax</span>("30.00")<br/>BigDecimal
discount;</td>
</tr>
<tr>
<td><code>@DecimalMin</code></td>
<td>属性值大于等于指定的十进制数</td>
<td><span class="citation"
data-cites="DecimalMin">@DecimalMin</span>("5.00")<br/>BigDecimal
discount;</td>
</tr>
<tr>
<td><code>@Digits</code></td>
<td>属性值必须为指定范围内的数字，<code>integer</code>
表示数字最大整数位，<code>fraction</code> 表示数字最大小数位</td>
<td><span class="citation" data-cites="Digits">@Digits</span>(integer=6,
fraction=2)<br/>BigDecimal price;</td>
</tr>
<tr>
<td><code>@Email</code></td>
<td>属性值必须为有效的电子邮件地址</td>
<td><span class="citation"
data-cites="Email&lt;br">@Email&lt;br</span>/&gt;String
emailaddress;</td>
</tr>
<tr>
<td><code>@Future</code></td>
<td>属性值必须为未来日期</td>
<td><span class="citation"
data-cites="Future&lt;br">@Future&lt;br</span>/&gt;Date eventDate;</td>
</tr>
<tr>
<td><code>@FutureOrPresent</code></td>
<td>属性值必须为现在或者未来日期</td>
<td><span class="citation"
data-cites="FutureOrPresent&lt;br">@FutureOrPresent&lt;br</span>/&gt;Time
travelTime;</td>
</tr>
<tr>
<td><code>@Max</code></td>
<td>属性值小于等于指定值</td>
<td><span class="citation" data-cites="Max">@Max</span>(10)<br/>int
quantity;</td>
</tr>
<tr>
<td><code>@Min</code></td>
<td>属性值大于等于指定值</td>
<td><span class="citation" data-cites="Min">@Min</span>(5)<br/>int
quantity;</td>
</tr>
<tr>
<td><code>@Negative</code></td>
<td>属性值必须为负数</td>
<td><span class="citation"
data-cites="Negative&lt;br">@Negative&lt;br</span>/&gt;int
basementFloor;</td>
</tr>
<tr>
<td><code>@NegativeOrZero</code></td>
<td>属性值必须为零或负数</td>
<td><span class="citation"
data-cites="NegativeOrZero&lt;br">@NegativeOrZero&lt;br</span>/&gt;int
debtValue;</td>
</tr>
<tr>
<td><code>@NotBlank</code></td>
<td>属性值必须有一个非空格字符</td>
<td><span class="citation"
data-cites="NotBlank&lt;br">@NotBlank&lt;br</span>/&gt;String
message;</td>
</tr>
<tr>
<td><code>@NotEmpty</code></td>
<td>属性值不能为空，不能有空格</td>
<td><span class="citation"
data-cites="NotEmpty&lt;br">@NotEmpty&lt;br</span>/&gt;String
message;;</td>
</tr>
<tr>
<td><code>@NotNull</code></td>
<td>属性值不能为空，可以有空格</td>
<td><span class="citation"
data-cites="NotNull&lt;br">@NotNull&lt;br</span>/&gt;String
username;</td>
</tr>
<tr>
<td><code>@Null</code></td>
<td>属性值必须为空</td>
<td><span class="citation"
data-cites="Null&lt;br">@Null&lt;br</span>/&gt;String unusedString;</td>
</tr>
<tr>
<td><code>@Past</code></td>
<td>属性值必须为过去日期</td>
<td><span class="citation"
data-cites="Past&lt;br">@Past&lt;br</span>/&gt;Date birthday;</td>
</tr>
<tr>
<td><code>@PastOrPresent</code></td>
<td>属性值必须为过去或者现在日期</td>
<td><span class="citation"
data-cites="PastOrPresent&lt;br">@PastOrPresent&lt;br</span>/&gt;Date
travelDate;</td>
</tr>
<tr>
<td><code>@Pattern</code></td>
<td>属性值必须符合注解参数 <code>regexp</code> 指定的正则表达式</td>
<td><span class="citation"
data-cites="Pattern">@Pattern</span>(regexp="\(\d{3}\)\d{3}-\d{4}")<br/>String
phoneNumber;</td>
</tr>
<tr>
<td><code>@Positive</code></td>
<td>属性值必须为正数</td>
<td><span class="citation"
data-cites="Positive&lt;br">@Positive&lt;br</span>/&gt;BigDecimal
area;</td>
</tr>
<tr>
<td><code>@PositiveOrZero</code></td>
<td>属性值必须为正数或零</td>
<td><span class="citation"
data-cites="PositiveOrZero&lt;br">@PositiveOrZero&lt;br</span>/&gt;int
totalGoals;</td>
</tr>
<tr>
<td><code>@Size</code></td>
<td>评估属性在不在 <code>min</code> 和 <code>max</code>
范围内，数组就评估长度，字符串评估个数，等等...</td>
<td><span class="citation" data-cites="Size">@Size</span>(min=2,
max=240)<br/>String briefMessage;</td>
</tr>
</tbody>
</table>
<ul>
<li><p>对 <code>Bean</code> 作数据校验，要先更改 <code>Bean</code>
类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.bean;<br><br><span class="hljs-keyword">import</span> jakarta.validation.constraints.*;<br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Long id;<br><br>    <span class="hljs-meta">@NotBlank(message = &quot;姓名不能为空&quot;)</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-meta">@NotNull(message = &quot;年龄不能为空&quot;)</span><br>    <span class="hljs-meta">@Max(value = 120, message = &quot;年龄不能超过 120 岁&quot;)</span><br>    <span class="hljs-meta">@Min(value = 0, message = &quot;年龄不能小于 0 岁&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer age;<br><br>    <span class="hljs-meta">@Email(message = &quot;邮箱格式不正确&quot;)</span><br>    <span class="hljs-keyword">private</span> String email;<br><br>    <span class="hljs-keyword">private</span> String gender;<br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-keyword">private</span> BigDecimal salary;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>更改好 <code>Bean</code> 类后，还没有开启数据校验，还要使用
<code>@Valid</code> 注解告诉 <code>SpringMVC</code> 做校验：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> jakarta.validation.Valid;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.service.EmployeeService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeRestController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeService employeeService;<br>    <br>    <span class="hljs-comment">// 增加员工信息</span><br>    <span class="hljs-meta">@PostMapping(&quot;/employee&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> <span class="hljs-meta">@Valid</span> Employee employee)</span> &#123;<br>        employeeService.addEmployee(employee);<br>        <span class="hljs-keyword">return</span> R.ok();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="注解-valid-记录">注解 <code>@Valid</code> 记录</h3>
<ul>
<li>作用是告诉 <code>SpringMVC</code> 对属性做数据校验，即有
<code>@Max</code>、<code>@Min</code>、<code>@Email</code>
等注解的属性做校验</li>
<li>一般标注在请求参数上，如果校验成功就继续执行方法，失败就抛异常</li>
</ul>
<h3 id="校验异常封装记录">校验异常封装记录</h3>
<ul>
<li><p>上面的代码有一个问题，就是如果数据校验失败了会抛一个异常，而异常信息可读性太差</p></li>
<li><p>所以需要对异常进行封装，此时要用到类 <code>BindingResult</code>
或者 <code>Errors</code>，<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-validation.html">官方文档</a>，类
<code>BindingResult</code> 必须放在 <code>@Valid</code>
注解的参数后面</p></li>
<li><p>修改上面代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> jakarta.validation.Valid;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.validation.BindingResult;<br><span class="hljs-keyword">import</span> org.springframework.validation.FieldError;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.service.EmployeeService;<br><br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeRestController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeService employeeService;<br><br>    <span class="hljs-comment">// 增加员工信息</span><br>    <span class="hljs-meta">@PostMapping(&quot;/employee&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> <span class="hljs-meta">@Valid</span> Employee employee, BindingResult bindingResult)</span> &#123;<br><br>        <span class="hljs-comment">// 校验通过，没发生错误</span><br>        <span class="hljs-keyword">if</span> (!bindingResult.hasErrors()) &#123;<br>            employeeService.addEmployee(employee);<br>            <span class="hljs-keyword">return</span> R.ok();<br>        &#125;<br><br>        <span class="hljs-comment">// 如果程序到了这里，说明校验发生了错误</span><br><br>        Map&lt;String, String&gt; errorsMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>        <span class="hljs-comment">// 获取所有属性错误的信息，进行遍历，把错误属性名作为 key 错误信息作为 value 放到 Map 中</span><br>        <span class="hljs-keyword">for</span> (FieldError fieldError : bindingResult.getFieldErrors()) &#123;<br>            <span class="hljs-comment">// 获取到属性名</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">field</span> <span class="hljs-operator">=</span> fieldError.getField();<br>            <span class="hljs-comment">// 获取错误信息，即在属性注解上的 message 注解参数</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">defaultMessage</span> <span class="hljs-operator">=</span> fieldError.getDefaultMessage();<br>            <span class="hljs-comment">// 放到 Map 中</span><br>            errorsMap.put(field, defaultMessage);<br>        &#125;<br>        <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">500</span>, <span class="hljs-string">&quot;数据校验失败&quot;</span>, errorsMap);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>由此，数据校验变成了四步：</p>
<ul>
<li>导入数据校验用的包</li>
<li>用注解标注需要校验的字段或属性</li>
<li>使用 <code>@Valid</code> 注解开启进行校验</li>
<li>用 <code>BindingResult</code> 参数作异常处理</li>
</ul></li>
</ul>
<h3 id="校验异常全局处理记录">校验异常全局处理记录</h3>
<ul>
<li><p>上面的代码还是有一个问题，如果有多个需要进行校验属性的方法，那就要写多个
<code>BindingResult</code> 方法参数了</p></li>
<li><p>所以异常处理最好是交给全局异常处理器进行处理</p></li>
<li><p>那么数据校验失败异常怎么捕获和处理</p></li>
<li><p>先要知道数据校验失败抛的是什么异常，修改全局异常处理器，打印一下异常的名：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.advice;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><br><span class="hljs-meta">@RestControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalExceptionHandler</span> &#123;<br><br>    <span class="hljs-meta">@ExceptionHandler(Throwable.class)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">error</span><span class="hljs-params">(Throwable e)</span> &#123;<br>        System.out.println(e.getClass());<br>        <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">500</span>, e.getMessage());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再修改 <code>Mapping</code> 不在方法中做异常处理：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> jakarta.validation.Valid;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.validation.BindingResult;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.service.EmployeeService;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeRestController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeService employeeService;<br><br>    <span class="hljs-comment">// 增加员工信息</span><br>    <span class="hljs-meta">@PostMapping(&quot;/employee&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> <span class="hljs-meta">@Valid</span> Employee employee<span class="hljs-comment">/*, BindingResult bindingResult*/</span>)</span> &#123;<br><br>        employeeService.addEmployee(employee);<br>        <span class="hljs-keyword">return</span> R.ok();<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>发送请求后控制台打印了一个信息：<code>org.springframework.web.bind.MethodArgumentNotValidException</code></p></li>
<li><p>好了，异常类获取到了，可以在全局异常处理器中写一个处理这个异常类的异常处理方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.advice;<br><br><span class="hljs-keyword">import</span> org.springframework.validation.BindingResult;<br><span class="hljs-keyword">import</span> org.springframework.validation.FieldError;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.MethodArgumentNotValidException;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-comment">// 全局异常处理器</span><br><span class="hljs-meta">@RestControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalExceptionHandler</span> &#123;<br>    <br>    <span class="hljs-meta">@ExceptionHandler(MethodArgumentNotValidException.class)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">error</span><span class="hljs-params">(MethodArgumentNotValidException e)</span> &#123;<br>        <span class="hljs-comment">// 拿到错误信息对象</span><br>        <span class="hljs-type">BindingResult</span> <span class="hljs-variable">bindingResult</span> <span class="hljs-operator">=</span> e.getBindingResult();<br><br>        <span class="hljs-comment">// 创建一个 Map 错误用于存放错误信息</span><br>        Map&lt;String, String&gt; errorsMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>        <span class="hljs-comment">// 获取所有错误信息</span><br>        List&lt;FieldError&gt; fieldErrors = bindingResult.getFieldErrors();<br><br>        <span class="hljs-comment">// 遍历所有的错误信息</span><br>        <span class="hljs-keyword">for</span> (FieldError fieldError : fieldErrors) &#123;<br>            <span class="hljs-comment">// 取出错误属性名</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">field</span> <span class="hljs-operator">=</span> fieldError.getField();<br>            <span class="hljs-comment">// 取出错误原因</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">defaultMessage</span> <span class="hljs-operator">=</span> fieldError.getDefaultMessage();<br>            <span class="hljs-comment">// 放到 Map 中</span><br>            errorsMap.put(field, defaultMessage);<br>        &#125;<br><br>        <span class="hljs-comment">// 返回错误对象</span><br>        <span class="hljs-keyword">return</span> R.error(<span class="hljs-number">500</span>, <span class="hljs-string">&quot;数据校验失败&quot;</span>, errorsMap);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="自定义数据校验注解记录">自定义数据校验注解记录</h3>
<ul>
<li><p><a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/core/validation/beanvalidation.html#validation-beanvalidation-spring-constraints">官方文档</a></p></li>
<li><p>创建一个注解类
<code>Gender.java</code>，格式其它数据校验注解差不多，并在
<code>@Constraint</code> 参数中指定校验类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.annotation;<br><br><span class="hljs-keyword">import</span> jakarta.validation.Constraint;<br><span class="hljs-keyword">import</span> jakarta.validation.Payload;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.validator.GenderValidator;<br><br><span class="hljs-keyword">import</span> java.lang.annotation.Documented;<br><span class="hljs-keyword">import</span> java.lang.annotation.Retention;<br><span class="hljs-keyword">import</span> java.lang.annotation.Target;<br><br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> java.lang.annotation.ElementType.*;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> java.lang.annotation.RetentionPolicy.RUNTIME;<br><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Constraint(validatedBy = &#123;GenderValidator.class&#125;)</span> <span class="hljs-comment">// 校验器才是真正做校验功能</span><br><span class="hljs-meta">@Target(&#123;FIELD&#125;)</span><br><span class="hljs-meta">@Retention(RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Gender &#123;<br><br>    String <span class="hljs-title function_">message</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">&quot;&quot;</span>;<br><br>    Class&lt;?&gt;[] groups() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Payload</span>&gt;[] payload() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>其中靠的是 <code>@Constraint</code>
注解进行校验，所以要创建一个校验类
<code>GenderValidator.java</code>，实现其中的校验方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.validator;<br><br><span class="hljs-keyword">import</span> jakarta.validation.ConstraintValidator;<br><span class="hljs-keyword">import</span> jakarta.validation.ConstraintValidatorContext;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.annotation.Gender;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenderValidator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ConstraintValidator</span>&lt;Gender, String&gt; &#123;<br><br>    <span class="hljs-comment">// 校验是否通过，true 表示通过，false 表示不通过</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValid</span><span class="hljs-params">(String value, ConstraintValidatorContext context)</span> &#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;男&quot;</span>.equals(value) || <span class="hljs-string">&quot;女&quot;</span>.equals(value));<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>总结步骤：</p>
<ul>
<li>自定义一个注解，并在注解中 <code>@Constraint</code>
注解指定校验器</li>
<li>自定义一个校验器实现
<code>ConstraintValidator&lt;A extends Annotation, T&gt;</code>
接口</li>
</ul></li>
</ul>
<h3 id="校验注解中的-message-参数的动态信息国际化记录">校验注解中的
<code>message</code> 参数的动态信息（国际化）记录</h3>
<ul>
<li><p>官方文档</p></li>
<li><p>在校验注解中，一般都有一个注解参数
<code>message</code>，这个参数可以灵活地从配置文件
<code>messages.properties</code> 中获取</p></li>
<li><p>为什么是
<code>messages.properties</code>，因为默认配置就是这个名称，如果想换名称可以在
<code>application.properties</code> 配置文件中更改：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.messages.basename</span>=<span class="hljs-string">messages</span><br></code></pre></td></tr></table></figure></li>
<li><p>如果是不同国家语言就从不同国家代码文件中获取，比如：</p>
<ul>
<li><code>messages_zh_CN.properties</code> 是中文的配置文件</li>
<li><code>messages_en_US.properties</code> 是英文的配置文件</li>
</ul></li>
<li><p>用法：<code>校验注解(message = "&#123;xxx.xxx&#125;")</code></p>
<ul>
<li>其中 <code>&#123;&#125;</code> 内填的就是配置文件中的属性</li>
</ul></li>
<li><p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.annotation.Gender;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> &#123;<br><br>    <span class="hljs-comment">//@Gender(message = &quot;性别只能为：男 或 女&quot;)</span><br>    <span class="hljs-meta">@Gender(message = &quot;&#123;gender.message&#125;&quot;)</span> <span class="hljs-comment">// 指定模板字符串，动态从配置文件中取</span><br>    <span class="hljs-keyword">private</span> String gender;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>默认配置文件 <code>messages.properties</code>：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">gender.message</span>=<span class="hljs-string">性别只能为：男 或 女</span><br></code></pre></td></tr></table></figure></li>
<li><p>配置文件 <code>messages_zh_CN.properties</code>：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">gender.message</span>=<span class="hljs-string">性别只能为：男 或 女</span><br></code></pre></td></tr></table></figure></li>
<li><p>配置文件 <code>messages_en_US.properties</code>：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">gender.message</span>=<span class="hljs-string">Gender must be one of: Male, Female</span><br></code></pre></td></tr></table></figure></li>
<li><p><code>SpringMVC</code> 是如何判断语言环境的呢？</p>
<ul>
<li>在请求头有一个 <code>Accept-Language</code>
属性，根据这个属性进行判断的</li>
</ul></li>
</ul>
<h3 id="被校验注解标注的类改造记录">被校验注解标注的类改造记录</h3>
<ul>
<li><p>在 <code>POJO</code>
类上加校验注解不符合一个设计模式：单一职责</p></li>
<li><p>比如多个方法对同一个 <code>POJO</code>
类做不同的数据校验，就要用分组参数 <code>groups</code>，太麻烦</p></li>
<li><p><code>JavaBean</code> 也要分层，比如数据脱敏等...</p></li>
<li><p>因此产生了各种 <code>O</code> 即分层模型</p>
<ul>
<li><p>PO（persistent object）：持久对象</p></li>
<li><p>VO（value object）：值对象（常用）</p></li>
<li><p>DAO（Data Access Objects）：数据访问接口（常用）</p></li>
<li><p>BO（Business Object）：业务对象</p></li>
<li><p>DTO（Data Transfer Object）：数据传输对象</p></li>
<li><p>POJO（Plain Old Java Objects）：简单的 Java 对象（常用）</p></li>
</ul></li>
<li><p>用 <code>VO</code> 代替 <code>DAO</code> 作数据校验：</p>
<ul>
<li><p>保持 <code>DAO</code> 功能单一性 <code>Employee.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> String email;<br>    <span class="hljs-keyword">private</span> String gender;<br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-keyword">private</span> BigDecimal salary;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>添加员工信息的 <code>VO</code> 类
<code>EmployeeAddVO.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.vo.req;<br><br><span class="hljs-keyword">import</span> jakarta.validation.constraints.*;<br><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.annotation.Gender;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeAddVO</span> &#123;<br><br>    <span class="hljs-comment">// 添加时不用 id</span><br><br>    <span class="hljs-meta">@NotBlank(message = &quot;姓名不能为空&quot;)</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-meta">@NotNull(message = &quot;年龄不能为空&quot;)</span><br>    <span class="hljs-meta">@Max(value = 120, message = &quot;年龄不能超过 120 岁&quot;)</span><br>    <span class="hljs-meta">@Min(value = 0, message = &quot;年龄不能小于 0 岁&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer age;<br><br>    <span class="hljs-meta">@Email(message = &quot;邮箱格式不正确&quot;)</span><br>    <span class="hljs-keyword">private</span> String email;<br><br>    <span class="hljs-meta">@Gender(message = &quot;&#123;gender.message&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String gender;<br><br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-keyword">private</span> BigDecimal salary;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>更改 <code>EmployeeRestController.java</code>
代码中的添加员工信息 <code>add</code> 方法，用 <code>VO</code> 代替
<code>DAO</code> 作数据校验（分层）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> jakarta.validation.Valid;<br><span class="hljs-keyword">import</span> org.springframework.beans.BeanUtils;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.service.EmployeeService;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.vo.req.EmployeeAddVO;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeRestController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeService employeeService;<br><br>    <span class="hljs-comment">// 增加员工信息</span><br>    <span class="hljs-meta">@PostMapping(&quot;/employee&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> <span class="hljs-meta">@Valid</span> EmployeeAddVO vo)</span> &#123;<br><br>        <span class="hljs-comment">// 把 vo 转为 dao</span><br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>();<br>        <br>        <span class="hljs-comment">// 可以一个一个属性进行复制</span><br>        <span class="hljs-comment">//employee.setName(vo.getName());</span><br>        <span class="hljs-comment">//employee.setAge(vo.getAge());</span><br>        <span class="hljs-comment">//employee.setEmail(vo.getEmail());</span><br>        <span class="hljs-comment">//employee.setGender(vo.getGender());</span><br>        <span class="hljs-comment">//employee.setAddress(vo.getAddress());</span><br>        <span class="hljs-comment">//employee.setSalary(vo.getSalary());</span><br><br>        <span class="hljs-comment">// 用 Spring 的工具类快速复制属性</span><br>        BeanUtils.copyProperties(vo, employee);<br><br>        employeeService.addEmployee(employee);<br>        <span class="hljs-keyword">return</span> R.ok();<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>更新员工信息的 <code>VO</code> 类
<code>EmployeeUpdateVO.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.vo.req;<br><br><span class="hljs-keyword">import</span> jakarta.validation.constraints.NotNull;<br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeUpdateVO</span> &#123;<br><br>    <span class="hljs-meta">@NotNull(message = &quot;id 不能为空&quot;)</span><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> String email;<br>    <span class="hljs-keyword">private</span> String gender;<br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-keyword">private</span> BigDecimal salary;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>更改 <code>EmployeeRestController.java</code>
代码中的更新员工信息 <code>update</code> 方法，用 <code>VO</code> 代替
<code>DAO</code> 作数据校验（分层）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> jakarta.validation.Valid;<br><span class="hljs-keyword">import</span> org.springframework.beans.BeanUtils;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.service.EmployeeService;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.vo.req.EmployeeUpdateVO;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeRestController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeService employeeService;<br>    <br>    <span class="hljs-comment">// 根据 id 修改员工信息</span><br>    <span class="hljs-meta">@PutMapping(&quot;/employee&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> <span class="hljs-meta">@Valid</span> EmployeeUpdateVO vo)</span> &#123;<br><br>        <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>();<br><br>        <span class="hljs-comment">// 复制属性</span><br>        BeanUtils.copyProperties(vo, employee);<br><br>        employeeService.updateEmployee(employee);<br>        <span class="hljs-keyword">return</span> R.ok();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>对响应数据中的 <code>salary</code>
字段数据进行脱敏，即不希望返回员工 <code>salary</code> 数据，写一个返回
<code>VO</code> 类 <code>EmployRespVO.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.vo.resp;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployRespVO</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> String email;<br>    <span class="hljs-keyword">private</span> String gender;<br>    <span class="hljs-keyword">private</span> String address;<br>    <br>    <span class="hljs-comment">// 对 salary 脱敏</span><br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>更改 <code>EmployeeRestController.java</code>
代码中的获取所有员工信息 <code>all</code> 方法，用 <code>VO</code> 代替
<code>DAO</code> 作数据校验（分层）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.controller;<br><br><span class="hljs-keyword">import</span> jakarta.validation.Valid;<br><span class="hljs-keyword">import</span> org.springframework.beans.BeanUtils;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.bean.Employee;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.common.R;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.service.EmployeeService;<br><span class="hljs-keyword">import</span> org.wind.springmvc.practice.vo.resp.EmployRespVO;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.stream.Collectors;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeRestController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmployeeService employeeService;<br><br>    <span class="hljs-comment">// 查询所有员工信息</span><br>    <span class="hljs-meta">@GetMapping(&quot;/employees&quot;)</span><br>    <span class="hljs-keyword">public</span> R&lt;Object&gt; <span class="hljs-title function_">all</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 查询数据库获取数据</span><br>        List&lt;Employee&gt; employees = employeeService.getAllEmployee();<br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        // 真正要返回的脱敏后的数据</span><br><span class="hljs-comment">        List&lt;EmployRespVO&gt; employRespVOList = new ArrayList&lt;&gt;();</span><br><span class="hljs-comment">        // 进行属性复制</span><br><span class="hljs-comment">        for (Employee employee : employees) &#123;</span><br><span class="hljs-comment">            EmployRespVO vo = new EmployRespVO();</span><br><span class="hljs-comment">            BeanUtils.copyProperties(employee, vo);</span><br><span class="hljs-comment">            employRespVOList.add(vo);</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">        */</span><br><br>        <span class="hljs-comment">// stream api 写法</span><br>        List&lt;EmployRespVO&gt; employRespVOList = employees.stream()<br>                .map(employee -&gt; &#123;<br>                    <span class="hljs-type">EmployRespVO</span> <span class="hljs-variable">vo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmployRespVO</span>();<br>                    BeanUtils.copyProperties(employee, vo);<br>                    <span class="hljs-keyword">return</span> vo;<br>                &#125;).collect(Collectors.toList());<br><br>        <span class="hljs-keyword">return</span> R.ok(employRespVOList);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h2 id="接口文档记录">9. 接口文档记录</h2>
<ul>
<li><p>推荐使用：<a
target="_blank" rel="noopener" href="https://doc.xiaominfo.com/">Knife4j</a></p></li>
<li><p>在 <code>pom.xml</code> 配置文件中导入依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.xiaoymin<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>knife4j-openapi3-jakarta-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.4.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>在 <code>src/main/resources</code>
下编写配置文件：<code>application.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># springdoc-openapi项目配置</span><br><span class="hljs-attr">springdoc:</span><br>  <span class="hljs-attr">swagger-ui:</span><br>    <span class="hljs-attr">path:</span> <span class="hljs-string">/swagger-ui.html</span><br>    <span class="hljs-attr">tags-sorter:</span> <span class="hljs-string">alpha</span><br>    <span class="hljs-attr">operations-sorter:</span> <span class="hljs-string">alpha</span><br>  <span class="hljs-attr">api-docs:</span><br>    <span class="hljs-attr">path:</span> <span class="hljs-string">/v3/api-docs</span><br>  <span class="hljs-attr">group-configs:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">group:</span> <span class="hljs-string">&#x27;default&#x27;</span><br>      <span class="hljs-attr">paths-to-match:</span> <span class="hljs-string">&#x27;/**&#x27;</span><br>      <span class="hljs-comment"># 指定 controller 包路径</span><br>      <span class="hljs-attr">packages-to-scan:</span> <span class="hljs-string">com.xiaominfo.knife4j.demo.web</span><br><span class="hljs-comment"># knife4j的增强配置，不需要增强可以不配</span><br><span class="hljs-attr">knife4j:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">setting:</span><br>    <span class="hljs-attr">language:</span> <span class="hljs-string">zh_cn</span><br></code></pre></td></tr></table></figure></li>
<li><p>启动项目，打开网址
<code>http://localhost:8080/doc.html</code></p></li>
<li><p>然后用注解进行接口作用的解释：<code>https://github.com/swagger-api/swagger-core/wiki/Swagger-2.X---Annotations</code></p></li>
<li><p>比如
<code>@Tag</code>、<code>@Parameters</code>、<code>@Schema</code>等</p></li>
</ul>
<h2 id="日期数据转换记录">10. 日期数据转换记录</h2>
<ul>
<li><p>当数据库字段中有一个日期字段，那么在 <code>Java</code>
中对应的就是 <code>Date</code> 类</p></li>
<li><p>前端进行查询的时候，后端返回结果中的日期没问题，但格式不太美观</p></li>
<li><p>但前端提交日期数据时，比如
<code>2000-01-01 00:00:00</code>，后端会出现反序列化失败，即必须要用指定的格式才可以：<code>2001-01-01T00:00:00.000+00:00</code>，也不太美观</p></li>
<li><p>如何自定义日期数据提交格式呢？用日期数据转换，即用
<code>@JsonFormat</code> 注解</p></li>
<li><p>在需要自定义日期格式的 <code>VO</code> 上加
<code>@JsonFormat</code> 注解，并指定格式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.springmvc.practice.bean;<br><br><span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonFormat;<br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.util.Date;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Long id;<br>    <br>    <span class="hljs-comment">// 指定日期格式为 年-月-日 时:分:秒 并指定时区为东 8 区</span><br>    <span class="hljs-meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;, timezone = &quot;GMT+8&quot;)</span><br>    <span class="hljs-keyword">private</span> Date birth;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="注解-jsonformat-记录">注解 <code>@JsonFormat</code> 记录</h3>
<ul>
<li><a
target="_blank" rel="noopener" href="https://github.com/FasterXML/jackson-annotations/wiki/Jackson-Annotations#deserialization-and-serialization-details">官方文档</a></li>
<li>用于自定义日期数据转换格式</li>
</ul>
<h2 id="springmvc-源码粗略分析记录">11. <code>SpringMVC</code>
源码粗略分析记录</h2>
<ul>
<li><p><code>SpringMVC</code> 中的所有请求都是由
<code>DispatcherServlet</code> 类进行处理的</p>
<ul>
<li><p>可以看到 <code>DispatcherServlet</code> 也是一个
<code>HttpServlet</code>：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">java<span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.Object</span><br>	jakarta<span class="hljs-selector-class">.servlet</span><span class="hljs-selector-class">.GenericServlet</span><br>		jakarta<span class="hljs-selector-class">.servlet</span><span class="hljs-selector-class">.http</span><span class="hljs-selector-class">.HttpServlet</span><br>			org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.web</span><span class="hljs-selector-class">.servlet</span><span class="hljs-selector-class">.HttpServletBean</span><br>				org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.web</span><span class="hljs-selector-class">.servlet</span><span class="hljs-selector-class">.FrameworkServlet</span><br>					org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.web</span><span class="hljs-selector-class">.servlet</span>.DispatcherServlet<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p><code>DispatcherServlet</code> 中的九大组件：</p>
<ul>
<li><p><code>MultipartResolver</code>：文件上传解析器（重点）</p></li>
<li><p><code>LocaleResolver</code>：做国际化的解析器</p></li>
<li><p><code>ThemeResolver</code>：做主题用的解析器（已过时）</p></li>
<li><p><code>List&lt;HandlerMapping&gt;</code>：控制器映射（重点）</p></li>
<li><p><code>List&lt;HandlerAdapter&gt;</code>：控制器适配器（重点）</p></li>
<li><p><code>List&lt;HandlerExceptionResolver&gt;</code>：异常解析器（重点）</p></li>
<li><p><code>RequestToViewNameTranslator</code>：视图名字翻译器</p></li>
<li><p><code>FlashMapManager</code>：缓存管理器</p></li>
<li><p><code>List&lt;ViewResolver&gt;</code>：视图解析器（较重点）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispatcherServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FrameworkServlet</span> &#123;<br><br>    <span class="hljs-comment">// 文件上传解析器（重点）</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> MultipartResolver multipartResolver;<br><br>    <span class="hljs-comment">// 做国际化的解析器</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> LocaleResolver localeResolver;<br><br>    <span class="hljs-comment">// 做主题用的解析器（已过时）</span><br>	<span class="hljs-meta">@Deprecated</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> ThemeResolver themeResolver;<br><br>    <span class="hljs-comment">// 控制器映射（重点）</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> List&lt;HandlerMapping&gt; handlerMappings;<br>    <br>	<span class="hljs-comment">// 控制器适配器（重点）</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> List&lt;HandlerAdapter&gt; handlerAdapters;<br><br>    <span class="hljs-comment">// 异常解析器（重点）</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> List&lt;HandlerExceptionResolver&gt; handlerExceptionResolvers;<br><br>    <span class="hljs-comment">// 视图名字翻译器</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> RequestToViewNameTranslator viewNameTranslator;<br><br>    <span class="hljs-comment">// 缓存管理器</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> FlashMapManager flashMapManager;<br><br>    <span class="hljs-comment">// 视图解析器（较重点）</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> List&lt;ViewResolver&gt; viewResolvers;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p><code>DispatcherServlet</code> 类的 <code>doDispatch</code>
方法负责请求的处理，可以打个断点进行调试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs java">    <span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispatcherServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FrameworkServlet</span> &#123;<br><br>&gt;&gt;&gt;     <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doDispatch</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>            <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">processedRequest</span> <span class="hljs-operator">=</span> request;<br>            <span class="hljs-type">HandlerExecutionChain</span> <span class="hljs-variable">mappedHandler</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">multipartRequestParsed</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><br>    		<span class="hljs-comment">// 判断是不是异步处理</span><br>            <span class="hljs-type">WebAsyncManager</span> <span class="hljs-variable">asyncManager</span> <span class="hljs-operator">=</span> WebAsyncUtils.getAsyncManager(request);<br><br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-comment">// 定义了一个视图引用，如果前后端不分离就有返回视图</span><br>                <span class="hljs-type">ModelAndView</span> <span class="hljs-variable">mv</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>                <span class="hljs-comment">// 提前准备一个异常引用，如果发生异常再进行异常处理</span><br>                <span class="hljs-type">Exception</span> <span class="hljs-variable">dispatchException</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-comment">// 检查是否有文件的上传</span><br>                    processedRequest = checkMultipart(request);<br>                    multipartRequestParsed = (processedRequest != request);<br><br>                    <span class="hljs-comment">// 获取处理器</span><br>                    <span class="hljs-comment">// Determine handler for the current request.</span><br>                    mappedHandler = getHandler(processedRequest);<br>                    <span class="hljs-comment">// 找不到，调用 noHandlerFound 方法</span><br>                    <span class="hljs-keyword">if</span> (mappedHandler == <span class="hljs-literal">null</span>) &#123;<br>                        noHandlerFound(processedRequest, response);<br>                        <span class="hljs-keyword">return</span>;<br>                    &#125;<br><br>                    <span class="hljs-comment">// Determine handler adapter for the current request.</span><br>                    <span class="hljs-type">HandlerAdapter</span> <span class="hljs-variable">ha</span> <span class="hljs-operator">=</span> getHandlerAdapter(mappedHandler.getHandler());<br><br>                    <span class="hljs-comment">// Process last-modified header, if supported by the handler.</span><br>                    <span class="hljs-type">String</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> request.getMethod();<br>                    <span class="hljs-type">boolean</span> <span class="hljs-variable">isGet</span> <span class="hljs-operator">=</span> HttpMethod.GET.matches(method);<br>                    <span class="hljs-keyword">if</span> (isGet || HttpMethod.HEAD.matches(method)) &#123;<br>                        <span class="hljs-type">long</span> <span class="hljs-variable">lastModified</span> <span class="hljs-operator">=</span> ha.getLastModified(request, mappedHandler.getHandler());<br>                        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletWebRequest</span>(request, response).checkNotModified(lastModified) &amp;&amp; isGet) &#123;<br>                            <span class="hljs-keyword">return</span>;<br>                        &#125;<br>                    &#125;<br><br>                    <span class="hljs-keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;<br>                        <span class="hljs-keyword">return</span>;<br>                    &#125;<br><br>                    <span class="hljs-comment">// Actually invoke the handler.</span><br>                    mv = ha.handle(processedRequest, response, mappedHandler.getHandler());<br><br>                    <span class="hljs-keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;<br>                        <span class="hljs-keyword">return</span>;<br>                    &#125;<br><br>                    applyDefaultViewName(processedRequest, mv);<br>                    mappedHandler.applyPostHandle(processedRequest, response, mv);<br>                &#125;<br>                <span class="hljs-keyword">catch</span> (Exception ex) &#123;<br>                    dispatchException = ex;<br>                &#125;<br>                <span class="hljs-keyword">catch</span> (Throwable err) &#123;<br>                    <span class="hljs-comment">// As of 4.3, we&#x27;re processing Errors thrown from handler methods as well,</span><br>                    <span class="hljs-comment">// making them available for @ExceptionHandler methods and other scenarios.</span><br>                    dispatchException = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletException</span>(<span class="hljs-string">&quot;Handler dispatch failed: &quot;</span> + err, err);<br>                &#125;<br>                processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);<br>            &#125;<br>            <span class="hljs-keyword">catch</span> (Exception ex) &#123;<br>                triggerAfterCompletion(processedRequest, response, mappedHandler, ex);<br>            &#125;<br>            <span class="hljs-keyword">catch</span> (Throwable err) &#123;<br>                triggerAfterCompletion(processedRequest, response, mappedHandler,<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletException</span>(<span class="hljs-string">&quot;Handler processing failed: &quot;</span> + err, err));<br>            &#125;<br>            <span class="hljs-keyword">finally</span> &#123;<br>                <span class="hljs-keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;<br>                    <span class="hljs-comment">// Instead of postHandle and afterCompletion</span><br>                    <span class="hljs-keyword">if</span> (mappedHandler != <span class="hljs-literal">null</span>) &#123;<br>                        mappedHandler.applyAfterConcurrentHandlingStarted(processedRequest, response);<br>                    &#125;<br>                    asyncManager.setMultipartRequestParsed(multipartRequestParsed);<br>                &#125;<br>                <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">// Clean up any resources used by a multipart request.</span><br>                    <span class="hljs-keyword">if</span> (multipartRequestParsed || asyncManager.isMultipartRequestParsed()) &#123;<br>                        cleanupMultipart(processedRequest);<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br><br>    &#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="检查请求是否有文件上传记录">检查请求是否有文件上传记录</h3>
<ul>
<li><p>检查是否有文件上传
<code>processedRequest = checkMultipart(request);</code> 会调用
<code>DispatcherServlet</code> 类的 <code>checkMultipart()</code>
方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispatcherServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FrameworkServlet</span> &#123;<br><br>    <span class="hljs-keyword">protected</span> HttpServletRequest <span class="hljs-title function_">checkMultipart</span><span class="hljs-params">(HttpServletRequest request)</span> <span class="hljs-keyword">throws</span> MultipartException &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.multipartResolver != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-built_in">this</span>.multipartResolver.isMultipart(request)) &#123;<br>            <span class="hljs-keyword">if</span> (WebUtils.getNativeRequest(request, MultipartHttpServletRequest.class) != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">if</span> (DispatcherType.REQUEST.equals(request.getDispatcherType())) &#123;<br>                    logger.trace(<span class="hljs-string">&quot;Request already resolved to MultipartHttpServletRequest, e.g. by MultipartFilter&quot;</span>);<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hasMultipartException(request)) &#123;<br>                logger.debug(<span class="hljs-string">&quot;Multipart resolution previously failed for current request - &quot;</span> +<br>                        <span class="hljs-string">&quot;skipping re-resolution for undisturbed error rendering&quot;</span>);<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.multipartResolver.resolveMultipart(request);<br>                &#125;<br>                <span class="hljs-keyword">catch</span> (MultipartException ex) &#123;<br>                    <span class="hljs-keyword">if</span> (request.getAttribute(WebUtils.ERROR_EXCEPTION_ATTRIBUTE) != <span class="hljs-literal">null</span>) &#123;<br>                        logger.debug(<span class="hljs-string">&quot;Multipart resolution failed for error dispatch&quot;</span>, ex);<br>                        <span class="hljs-comment">// Keep processing error dispatch with regular request handle below</span><br>                    &#125;<br>                    <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">throw</span> ex;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// If not returned before: return original request.</span><br>        <span class="hljs-keyword">return</span> request;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>如果有再调用 <code>multipartResolver</code> 解析文件的方法
<code>resolveMultipart()</code> 对请求进行包装：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.multipart.support;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StandardServletMultipartResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MultipartResolver</span> &#123;<br>    <br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isMultipart</span><span class="hljs-params">(HttpServletRequest request)</span> &#123;<br>        <span class="hljs-comment">// 对原请求进行包装</span><br>		<span class="hljs-keyword">return</span> StringUtils.startsWithIgnoreCase(request.getContentType(),<br>				(<span class="hljs-built_in">this</span>.strictServletCompliance ? MediaType.MULTIPART_FORM_DATA_VALUE : <span class="hljs-string">&quot;multipart/&quot;</span>));<br>	&#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>StandardMultipartHttpServletRequest</code>
类的构造方法进行包装：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.multipart.support;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StandardMultipartHttpServletRequest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractMultipartHttpServletRequest</span> &#123;<br><br>	<span class="hljs-keyword">public</span> <span class="hljs-title function_">StandardMultipartHttpServletRequest</span><span class="hljs-params">(HttpServletRequest request, <span class="hljs-type">boolean</span> lazyParsing)</span><br>			<span class="hljs-keyword">throws</span> MultipartException &#123;<br><br>		<span class="hljs-built_in">super</span>(request);<br>		<span class="hljs-keyword">if</span> (!lazyParsing) &#123;<br>            <span class="hljs-comment">// 调用解析方法</span><br>			parseRequest(request);<br>		&#125;<br>	&#125;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parseRequest</span><span class="hljs-params">(HttpServletRequest request)</span> &#123;<br>		<span class="hljs-keyword">try</span> &#123;<br>			Collection&lt;Part&gt; parts = request.getParts();<br>			<span class="hljs-built_in">this</span>.multipartParameterNames = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashSet</span>&lt;&gt;(parts.size());<br>            <span class="hljs-comment">// 把数据放到 Map 中，value 为 MultipartFile 所以接收数据要用 MultipartFile 类的原因</span><br>			MultiValueMap&lt;String, MultipartFile&gt; files = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedMultiValueMap</span>&lt;&gt;(parts.size());<br>			<span class="hljs-keyword">for</span> (Part part : parts) &#123;<br>				<span class="hljs-type">String</span> <span class="hljs-variable">headerValue</span> <span class="hljs-operator">=</span> part.getHeader(HttpHeaders.CONTENT_DISPOSITION);<br>				<span class="hljs-type">ContentDisposition</span> <span class="hljs-variable">disposition</span> <span class="hljs-operator">=</span> ContentDisposition.parse(headerValue);<br>				<span class="hljs-type">String</span> <span class="hljs-variable">filename</span> <span class="hljs-operator">=</span> disposition.getFilename();<br>				<span class="hljs-keyword">if</span> (filename != <span class="hljs-literal">null</span>) &#123;<br>					files.add(part.getName(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">StandardMultipartFile</span>(part, filename));<br>				&#125;<br>				<span class="hljs-keyword">else</span> &#123;<br>					<span class="hljs-built_in">this</span>.multipartParameterNames.add(part.getName());<br>				&#125;<br>			&#125;<br>			setMultipartFiles(files);<br>		&#125;<br>		<span class="hljs-keyword">catch</span> (Throwable ex) &#123;<br>			handleParseFailure(ex);<br>		&#125;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="获取处理器记录">获取处理器记录</h3>
<h4 id="找到了记录">找到了记录</h4>
<ul>
<li><p><code>mappedHandler = getHandler(processedRequest);</code>
进去看一下 Step Into：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispatcherServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FrameworkServlet</span> &#123;<br>    <br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">protected</span> HandlerExecutionChain <span class="hljs-title function_">getHandler</span><span class="hljs-params">(HttpServletRequest request)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>		<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.handlerMappings != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">// for 循环进行遍历找到合适的处理器，找到了就返回一个处理器执行链</span><br>			<span class="hljs-keyword">for</span> (HandlerMapping mapping : <span class="hljs-built_in">this</span>.handlerMappings) &#123;<br>				<span class="hljs-type">HandlerExecutionChain</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> mapping.getHandler(request);<br>				<span class="hljs-keyword">if</span> (handler != <span class="hljs-literal">null</span>) &#123;<br>					<span class="hljs-keyword">return</span> handler;<br>				&#125;<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>	&#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>此时看一下 <code>HandlerMapping</code> 是什么东西，是一个
<code>ArrayList</code> 集合，里面有 6 个元素，这一堆都是
<code>SpringMVC</code> 支持的请求映射：</p>
<ul>
<li><code>RouterFunctionMapping</code></li>
<li><code>RequestMappingHandlerMapping</code>：因为当前用的是
<code>@RequestMapping</code> 注解，所以会用这个映射</li>
<li><code>WelcomePageHandlerMapping</code></li>
<li><code>BeanNameUrlHandlerMapping</code></li>
<li><code>WelcomePageNotAcceptableHandlerMapping</code></li>
<li><code>SimpleUrlHandlerMapping</code></li>
</ul></li>
<li><p>所以 <code>HandlerMapping</code>
就是把请求路径与处理的方法进行绑定的东西</p></li>
<li><p>当找到了合适的 <code>HandlerMapping</code> 后就会返回一个
<code>HandlerExecutionChain</code> 即处理器执行链，里面有三个东西</p>
<ul>
<li>目标方法</li>
<li>拦截器（自己写的和默认的）</li>
<li>拦截器索引</li>
</ul></li>
</ul>
<h4 id="找不到记录">找不到记录</h4>
<ul>
<li><p>调用 <code>noHandlerFound(processedRequest, response);</code>
然后跳转到错误页结束请求：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispatcherServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FrameworkServlet</span> &#123;<br>    <br>	<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">noHandlerFound</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>		<span class="hljs-keyword">if</span> (pageNotFoundLogger.isWarnEnabled()) &#123;<br>			pageNotFoundLogger.warn(<span class="hljs-string">&quot;No mapping for &quot;</span> + request.getMethod() + <span class="hljs-string">&quot; &quot;</span> + getRequestUri(request));<br>		&#125;<br>		<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.throwExceptionIfNoHandlerFound) &#123;<br>			<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NoHandlerFoundException</span>(request.getMethod(), getRequestUri(request),<br>					<span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletServerHttpRequest</span>(request).getHeaders());<br>		&#125;<br>		<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 跳转到错误页，结束请求</span><br>            <span class="hljs-comment">// HttpServletResponse.SC_NOT_FOUND = 404</span><br>			response.sendError(HttpServletResponse.SC_NOT_FOUND);<br>		&#125;<br>	&#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="获取处理器适配器记录">获取处理器适配器记录</h3>
<ul>
<li><p><code>HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());</code></p>
<ul>
<li><code>mappedHandler.getHandler()</code>
获取目标方法，再获取目标方法适配器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispatcherServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FrameworkServlet</span> &#123;<br>    <br>	<span class="hljs-keyword">protected</span> HandlerAdapter <span class="hljs-title function_">getHandlerAdapter</span><span class="hljs-params">(Object handler)</span> <span class="hljs-keyword">throws</span> ServletException &#123;<br>		<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.handlerAdapters != <span class="hljs-literal">null</span>) &#123;<br>			<span class="hljs-keyword">for</span> (HandlerAdapter adapter : <span class="hljs-built_in">this</span>.handlerAdapters) &#123;<br>                <span class="hljs-comment">// 获取支持目标方法的适配器</span><br>				<span class="hljs-keyword">if</span> (adapter.supports(handler)) &#123;<br>					<span class="hljs-keyword">return</span> adapter;<br>				&#125;<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletException</span>(<span class="hljs-string">&quot;No adapter for handler [&quot;</span> + handler +<br>				<span class="hljs-string">&quot;]: The DispatcherServlet configuration needs to include a HandlerAdapter that supports this handler&quot;</span>);<br>	&#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>适配器是什么，一个
<code>ArrayList</code>，反射工具，点开参数看到有四个：</p>
<ul>
<li><code>RequestMappingHandlerAdapter</code>：因为当前用了
<code>@RequestMapping</code> 注解，所以用这个适配器</li>
<li><code>HandlerFunctionAdapter</code></li>
<li><code>HttpRequestHandlerAdapter</code></li>
<li><code>SimpleControllerHandlerAdapter</code>：可以实现
<code>Controller</code> 接口并放进 <code>IoC</code>
容器中可以做请求处理，那时用的就是这个适配器</li>
</ul></li>
<li><p>调用了 <code>AbstractHandlerMethodAdapter</code> 类的
<code>supports()</code> 方法检测当前适配器支持目标方法否：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet.mvc.method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractHandlerMethodAdapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WebContentGenerator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerAdapter</span>, Ordered &#123;	<br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(Object handler)</span> &#123;<br>		<span class="hljs-keyword">return</span> (handler <span class="hljs-keyword">instanceof</span> HandlerMethod handlerMethod &amp;&amp; supportsInternal(handlerMethod));<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="真正执行处理器记录">真正执行处理器记录</h3>
<ul>
<li><p><code>mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</code>
真正执行目标方法</p>
<ul>
<li><p>在此之前有一个操作：执行拦截器自己写的和 <code>SpringMVC</code>
自带的 <code>preHandle</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>调用了 <code>HandlerExecutionChain</code> 的
<code>applyPreHandle()</code> 方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HandlerExecutionChain</span> &#123;<br>    <br>	<span class="hljs-type">boolean</span> <span class="hljs-title function_">applyPreHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">// 遍历顺序执行</span><br>		<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">this</span>.interceptorList.size(); i++) &#123;<br>			<span class="hljs-type">HandlerInterceptor</span> <span class="hljs-variable">interceptor</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.interceptorList.get(i);<br>			<span class="hljs-keyword">if</span> (!interceptor.preHandle(request, response, <span class="hljs-built_in">this</span>.handler)) &#123;<br>                <span class="hljs-comment">// 如果发生错误，就执行 afterCompletion 拦截器操作，不执行 postHandle 拦截器了</span><br>                <span class="hljs-comment">// 所以这就是为什么 preHandle 拦截后 postHandle 不执行</span><br>				triggerAfterCompletion(request, response, <span class="hljs-literal">null</span>);<br>				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>			&#125;<br>            <span class="hljs-comment">// 每次执行完 preHandle 不出错 interceptorIndex 会增加</span><br>            <span class="hljs-comment">// 所以调用 afterCompletion 会逆序输出</span><br>			<span class="hljs-built_in">this</span>.interceptorIndex = i;<br>		&#125;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>	&#125;<br>    <br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">triggerAfterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, <span class="hljs-meta">@Nullable</span> Exception ex)</span> &#123;<br>        <span class="hljs-comment">// 逆序执行 afterCompletion</span><br>		<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.interceptorIndex; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>			<span class="hljs-type">HandlerInterceptor</span> <span class="hljs-variable">interceptor</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.interceptorList.get(i);<br>			<span class="hljs-keyword">try</span> &#123;<br>				interceptor.afterCompletion(request, response, <span class="hljs-built_in">this</span>.handler, ex);<br>			&#125;<br>			<span class="hljs-keyword">catch</span> (Throwable ex2) &#123;<br>				logger.error(<span class="hljs-string">&quot;HandlerInterceptor.afterCompletion threw exception&quot;</span>, ex2);<br>			&#125;<br>		&#125;<br>	&#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>如果正常执行就会到：<code>applyDefaultViewName(processedRequest, mv);</code>
渲染视图</p></li>
<li><p>再到
<code>mappedHandler.applyPostHandle(processedRequest, response, mv);</code>
执行 <code>postHandle</code> 拦截器方法</p></li>
<li><p>无论有没有异常都执行
<code>processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispatcherServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FrameworkServlet</span> &#123;<br>    <br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processDispatchResult</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response,</span><br><span class="hljs-params">			<span class="hljs-meta">@Nullable</span> HandlerExecutionChain mappedHandler, <span class="hljs-meta">@Nullable</span> ModelAndView mv,</span><br><span class="hljs-params">			<span class="hljs-meta">@Nullable</span> Exception exception)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br><br>		<span class="hljs-type">boolean</span> <span class="hljs-variable">errorView</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><br>        <span class="hljs-comment">// 如果发生异常走这个 if</span><br>		<span class="hljs-keyword">if</span> (exception != <span class="hljs-literal">null</span>) &#123;<br>			<span class="hljs-keyword">if</span> (exception <span class="hljs-keyword">instanceof</span> ModelAndViewDefiningException mavDefiningException) &#123;<br>				logger.debug(<span class="hljs-string">&quot;ModelAndViewDefiningException encountered&quot;</span>, exception);<br>				mv = mavDefiningException.getModelAndView();<br>			&#125;<br>			<span class="hljs-keyword">else</span> &#123;<br>				<span class="hljs-type">Object</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> (mappedHandler != <span class="hljs-literal">null</span> ? mappedHandler.getHandler() : <span class="hljs-literal">null</span>);<br>				mv = processHandlerException(request, response, handler, exception);<br>				errorView = (mv != <span class="hljs-literal">null</span>);<br>			&#125;<br>		&#125;<br><br>        <span class="hljs-comment">// 如果有 ModelAndView 则走这个 if 渲染页面</span><br>		<span class="hljs-comment">// Did the handler return a view to render?</span><br>		<span class="hljs-keyword">if</span> (mv != <span class="hljs-literal">null</span> &amp;&amp; !mv.wasCleared()) &#123;<br>			render(mv, request, response);<br>			<span class="hljs-keyword">if</span> (errorView) &#123;<br>				WebUtils.clearErrorRequestAttributes(request);<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">else</span> &#123;<br>			<span class="hljs-keyword">if</span> (logger.isTraceEnabled()) &#123;<br>				logger.trace(<span class="hljs-string">&quot;No view rendering, null ModelAndView returned.&quot;</span>);<br>			&#125;<br>		&#125;<br><br>		<span class="hljs-keyword">if</span> (WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) &#123;<br>			<span class="hljs-comment">// Concurrent handling started during a forward</span><br>			<span class="hljs-keyword">return</span>;<br>		&#125;<br><br>		<span class="hljs-keyword">if</span> (mappedHandler != <span class="hljs-literal">null</span>) &#123;<br>			<span class="hljs-comment">// Exception (if any) is already handled..</span><br>			mappedHandler.triggerAfterCompletion(request, response, <span class="hljs-literal">null</span>);<br>		&#125;<br>	&#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><p>如果有异常调用 <code>processHandlerException</code>
处理异常：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispatcherServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FrameworkServlet</span> &#123;<br>	<br>    <span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">protected</span> ModelAndView <span class="hljs-title function_">processHandlerException</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response,</span><br><span class="hljs-params">			<span class="hljs-meta">@Nullable</span> Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br><br>		<span class="hljs-comment">// Success and error responses may use different content types</span><br>		request.removeAttribute(HandlerMapping.PRODUCIBLE_MEDIA_TYPES_ATTRIBUTE);<br>		<span class="hljs-comment">// Reset the response body buffer if the response is not committed already,</span><br>		<span class="hljs-comment">// leaving the response headers in place.</span><br>		<span class="hljs-keyword">try</span> &#123;<br>			response.resetBuffer();<br>		&#125;<br>		<span class="hljs-keyword">catch</span> (IllegalStateException illegalStateException) &#123;<br>			<span class="hljs-comment">// the response is already committed, leave it to exception handlers anyway</span><br>		&#125;<br><br>		<span class="hljs-comment">// Check registered HandlerExceptionResolvers...</span><br>		<span class="hljs-type">ModelAndView</span> <span class="hljs-variable">exMv</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>		<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.handlerExceptionResolvers != <span class="hljs-literal">null</span>) &#123;<br>			<span class="hljs-keyword">for</span> (HandlerExceptionResolver resolver : <span class="hljs-built_in">this</span>.handlerExceptionResolvers) &#123;<br>				exMv = resolver.resolveException(request, response, handler, ex);<br>				<span class="hljs-keyword">if</span> (exMv != <span class="hljs-literal">null</span>) &#123;<br>					<span class="hljs-keyword">break</span>;<br>				&#125;<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">if</span> (exMv != <span class="hljs-literal">null</span>) &#123;<br>			<span class="hljs-keyword">if</span> (exMv.isEmpty()) &#123;<br>				request.setAttribute(EXCEPTION_ATTRIBUTE, ex);<br>				<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>			&#125;<br>			<span class="hljs-comment">// We might still need view name translation for a plain error model...</span><br>			<span class="hljs-keyword">if</span> (!exMv.hasView()) &#123;<br>				<span class="hljs-type">String</span> <span class="hljs-variable">defaultViewName</span> <span class="hljs-operator">=</span> getDefaultViewName(request);<br>				<span class="hljs-keyword">if</span> (defaultViewName != <span class="hljs-literal">null</span>) &#123;<br>					exMv.setViewName(defaultViewName);<br>				&#125;<br>			&#125;<br>			<span class="hljs-keyword">if</span> (logger.isTraceEnabled()) &#123;<br>				logger.trace(<span class="hljs-string">&quot;Using resolved error view: &quot;</span> + exMv, ex);<br>			&#125;<br>			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (logger.isDebugEnabled()) &#123;<br>				logger.debug(<span class="hljs-string">&quot;Using resolved error view: &quot;</span> + exMv);<br>			&#125;<br>			WebUtils.exposeErrorRequestAttributes(request, ex, getServletName());<br>			<span class="hljs-keyword">return</span> exMv;<br>		&#125;<br><br>		<span class="hljs-keyword">throw</span> ex;<br>	&#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li>此时可以看一下异常解析器集合（ArrayList）：<code>HandlerExceptionResolver</code>
<ul>
<li><code>DefaultErrorAttributes</code></li>
<li><code>HandlerExceptionResolverComposite</code>
<ul>
<li><code>ExceptionHandlerExceptionResolver</code>：自定义的异常解析器</li>
<li><code>ResponseStatusExceptionResolver</code></li>
<li><code>DefaultHandlerExceptionResolver</code></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>如果有页面则调用 <code>render()</code> 方法：在 IDEA 按
<code>Ctrl + Alt + 方法名</code> 进入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispatcherServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FrameworkServlet</span> &#123;<br><br>	<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">render</span><span class="hljs-params">(ModelAndView mv, HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">// 国际化</span><br>		<span class="hljs-comment">// Determine locale for request and apply it to the response.</span><br>		<span class="hljs-type">Locale</span> <span class="hljs-variable">locale</span> <span class="hljs-operator">=</span><br>				(<span class="hljs-built_in">this</span>.localeResolver != <span class="hljs-literal">null</span> ? <span class="hljs-built_in">this</span>.localeResolver.resolveLocale(request) : request.getLocale());<br>		response.setLocale(locale);<br><br>		View view;<br>		<span class="hljs-type">String</span> <span class="hljs-variable">viewName</span> <span class="hljs-operator">=</span> mv.getViewName();<br>		<span class="hljs-keyword">if</span> (viewName != <span class="hljs-literal">null</span>) &#123;<br>			<span class="hljs-comment">// We need to resolve the view name.</span><br>			view = resolveViewName(viewName, mv.getModelInternal(), locale, request);<br>			<span class="hljs-keyword">if</span> (view == <span class="hljs-literal">null</span>) &#123;<br>				<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletException</span>(<span class="hljs-string">&quot;Could not resolve view with name &#x27;&quot;</span> + mv.getViewName() +<br>						<span class="hljs-string">&quot;&#x27; in servlet with name &#x27;&quot;</span> + getServletName() + <span class="hljs-string">&quot;&#x27;&quot;</span>);<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">else</span> &#123;<br>			<span class="hljs-comment">// No need to lookup: the ModelAndView object contains the actual View object.</span><br>			view = mv.getView();<br>			<span class="hljs-keyword">if</span> (view == <span class="hljs-literal">null</span>) &#123;<br>				<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletException</span>(<span class="hljs-string">&quot;ModelAndView [&quot;</span> + mv + <span class="hljs-string">&quot;] neither contains a view name nor a &quot;</span> +<br>						<span class="hljs-string">&quot;View object in servlet with name &#x27;&quot;</span> + getServletName() + <span class="hljs-string">&quot;&#x27;&quot;</span>);<br>			&#125;<br>		&#125;<br><br>		<span class="hljs-comment">// Delegate to the View object for rendering.</span><br>		<span class="hljs-keyword">if</span> (logger.isTraceEnabled()) &#123;<br>			logger.trace(<span class="hljs-string">&quot;Rendering view [&quot;</span> + view + <span class="hljs-string">&quot;] &quot;</span>);<br>		&#125;<br>		<span class="hljs-keyword">try</span> &#123;<br>			<span class="hljs-keyword">if</span> (mv.getStatus() != <span class="hljs-literal">null</span>) &#123;<br>				request.setAttribute(View.RESPONSE_STATUS_ATTRIBUTE, mv.getStatus());<br>				response.setStatus(mv.getStatus().value());<br>			&#125;<br>            <span class="hljs-comment">// 再调用 view 的 render 方法</span><br>			view.render(mv.getModelInternal(), request, response);<br>		&#125;<br>		<span class="hljs-keyword">catch</span> (Exception ex) &#123;<br>			<span class="hljs-keyword">if</span> (logger.isDebugEnabled()) &#123;<br>				logger.debug(<span class="hljs-string">&quot;Error rendering view [&quot;</span> + view + <span class="hljs-string">&quot;]&quot;</span>, ex);<br>			&#125;<br>			<span class="hljs-keyword">throw</span> ex;<br>		&#125;<br>	&#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><p>在渲染之前要先找到视图名：<code>view = resolveViewName(viewName, mv.getModelInternal(), locale, request);</code></p></li>
<li><p>通过 <code>ViewResolver</code> 找到视图解析器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispatcherServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FrameworkServlet</span> &#123;<br><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">protected</span> View <span class="hljs-title function_">resolveViewName</span><span class="hljs-params">(String viewName, <span class="hljs-meta">@Nullable</span> Map&lt;String, Object&gt; model,</span><br><span class="hljs-params">			Locale locale, HttpServletRequest request)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br><br>		<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.viewResolvers != <span class="hljs-literal">null</span>) &#123;<br>			<span class="hljs-keyword">for</span> (ViewResolver viewResolver : <span class="hljs-built_in">this</span>.viewResolvers) &#123;<br>				<span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> viewResolver.resolveViewName(viewName, locale);<br>				<span class="hljs-keyword">if</span> (view != <span class="hljs-literal">null</span>) &#123;<br>					<span class="hljs-keyword">return</span> view;<br>				&#125;<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>	&#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>调用 <code>resolveViewName</code> 方法获取视图名：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet.view;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewResolverComposite</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ViewResolver</span>, Ordered, InitializingBean,<br>		ApplicationContextAware, ServletContextAware &#123;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">public</span> View <span class="hljs-title function_">resolveViewName</span><span class="hljs-params">(String viewName, Locale locale)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>		<span class="hljs-keyword">for</span> (ViewResolver viewResolver : <span class="hljs-built_in">this</span>.viewResolvers) &#123;<br>            <span class="hljs-comment">// 再调用 resolveViewName 方法</span><br>			<span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> viewResolver.resolveViewName(viewName, locale);<br>			<span class="hljs-keyword">if</span> (view != <span class="hljs-literal">null</span>) &#123;<br>				<span class="hljs-keyword">return</span> view;<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再调用另一个类中的 <code>resolveViewName</code>
方法获取视图名：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet.view;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractCachingViewResolver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WebApplicationObjectSupport</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ViewResolver</span> &#123;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">public</span> View <span class="hljs-title function_">resolveViewName</span><span class="hljs-params">(String viewName, Locale locale)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>		<span class="hljs-keyword">if</span> (!isCache()) &#123;<br>            <span class="hljs-comment">// 再调用 createView 方法</span><br>			<span class="hljs-keyword">return</span> createView(viewName, locale);<br>		&#125;<br>		<span class="hljs-keyword">else</span> &#123;<br>			<span class="hljs-type">Object</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> getCacheKey(viewName, locale);<br>			<span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.viewAccessCache.get(cacheKey);<br>			<span class="hljs-keyword">if</span> (view == <span class="hljs-literal">null</span>) &#123;<br>				<span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>.viewCreationCache) &#123;<br>					view = <span class="hljs-built_in">this</span>.viewCreationCache.get(cacheKey);<br>					<span class="hljs-keyword">if</span> (view == <span class="hljs-literal">null</span>) &#123;<br>						<span class="hljs-comment">// Ask the subclass to create the View object.</span><br>						view = createView(viewName, locale);<br>						<span class="hljs-keyword">if</span> (view == <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-built_in">this</span>.cacheUnresolved) &#123;<br>							view = UNRESOLVED_VIEW;<br>						&#125;<br>						<span class="hljs-keyword">if</span> (view != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-built_in">this</span>.cacheFilter.filter(view, viewName, locale)) &#123;<br>							<span class="hljs-built_in">this</span>.viewAccessCache.put(cacheKey, view);<br>							<span class="hljs-built_in">this</span>.viewCreationCache.put(cacheKey, view);<br>						&#125;<br>					&#125;<br>				&#125;<br>			&#125;<br>			<span class="hljs-keyword">else</span> &#123;<br>				<span class="hljs-keyword">if</span> (logger.isTraceEnabled()) &#123;<br>					logger.trace(formatKey(cacheKey) + <span class="hljs-string">&quot;served from cache&quot;</span>);<br>				&#125;<br>			&#125;<br>			<span class="hljs-keyword">return</span> (view != UNRESOLVED_VIEW ? view : <span class="hljs-literal">null</span>);<br>		&#125;<br>	&#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再调用 <code>createView</code>
方法，<code>Ctrl + Alt + 方法名</code> 进去，因为当前用的
<code>Thymeleaf</code> 所以来到了 <code>ThymeleafViewResolver</code>
类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.thymeleaf.spring6.view;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThymeleafViewResolver</span><br>        <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractCachingViewResolver</span><br>        <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Ordered</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">REDIRECT_URL_PREFIX</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;redirect:&quot;</span>;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">FORWARD_URL_PREFIX</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;forward:&quot;</span>;<br>    <br>	<span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> View <span class="hljs-title function_">createView</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String viewName, <span class="hljs-keyword">final</span> Locale locale)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">// First possible call to check &quot;viewNames&quot;: before processing redirects and forwards</span><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.alwaysProcessRedirectAndForward &amp;&amp; !canHandle(viewName, locale)) &#123;<br>            vrlogger.trace(<span class="hljs-string">&quot;[THYMELEAF] View \&quot;&#123;&#125;\&quot; cannot be handled by ThymeleafViewResolver. Passing on to the next resolver in the chain.&quot;</span>, viewName);<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>        <span class="hljs-comment">// Process redirects (HTTP redirects)</span><br>        <span class="hljs-keyword">if</span> (viewName.startsWith(REDIRECT_URL_PREFIX)) &#123;<br>            vrlogger.trace(<span class="hljs-string">&quot;[THYMELEAF] View \&quot;&#123;&#125;\&quot; is a redirect, and will not be handled directly by ThymeleafViewResolver.&quot;</span>, viewName);<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">redirectUrl</span> <span class="hljs-operator">=</span> viewName.substring(REDIRECT_URL_PREFIX.length(), viewName.length());<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">RedirectView</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedirectView</span>(redirectUrl, isRedirectContextRelative(), isRedirectHttp10Compatible());<br>            <span class="hljs-keyword">return</span> (View) getApplicationContext().getAutowireCapableBeanFactory().initializeBean(view, REDIRECT_URL_PREFIX);<br>        &#125;<br>        <span class="hljs-comment">// Process forwards (to JSP resources)</span><br>        <span class="hljs-keyword">if</span> (viewName.startsWith(FORWARD_URL_PREFIX)) &#123;<br>            <span class="hljs-comment">// The &quot;forward:&quot; prefix will actually create a Servlet/JSP view, and that&#x27;s precisely its aim per the Spring</span><br>            <span class="hljs-comment">// documentation. See http://docs.spring.io/spring-framework/docs/4.2.4.RELEASE/spring-framework-reference/html/mvc.html#mvc-redirecting-forward-prefix</span><br>            vrlogger.trace(<span class="hljs-string">&quot;[THYMELEAF] View \&quot;&#123;&#125;\&quot; is a forward, and will not be handled directly by ThymeleafViewResolver.&quot;</span>, viewName);<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">forwardUrl</span> <span class="hljs-operator">=</span> viewName.substring(FORWARD_URL_PREFIX.length(), viewName.length());<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InternalResourceView</span>(forwardUrl);<br>        &#125;<br>        <span class="hljs-comment">// Second possible call to check &quot;viewNames&quot;: after processing redirects and forwards</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.alwaysProcessRedirectAndForward &amp;&amp; !canHandle(viewName, locale)) &#123;<br>            vrlogger.trace(<span class="hljs-string">&quot;[THYMELEAF] View \&quot;&#123;&#125;\&quot; cannot be handled by ThymeleafViewResolver. Passing on to the next resolver in the chain.&quot;</span>, viewName);<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>        vrlogger.trace(<span class="hljs-string">&quot;[THYMELEAF] View &#123;&#125; will be handled by ThymeleafViewResolver and a &quot;</span> +<br>                        <span class="hljs-string">&quot;&#123;&#125; instance will be created for it&quot;</span>, viewName, getViewClass().getSimpleName());<br>        <span class="hljs-keyword">return</span> loadView(viewName, locale);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>可以看到有两个 <code>if</code> 判断 <code>viewName</code> 是否由
<code>REDIRECT_URL_PREFIX</code> 或 <code>FORWARD_URL_PREFIX</code>
开始</p></li>
<li><p>这就是为什么返回视图名时用 <code>redirect:</code> 表示重定向，用
<code>forward:</code> 表示转发</p></li>
<li><p>那视图拼前缀和后缀的代码在哪里？用另一个
<code>ViewResolver</code> 方便作例子分析：回到 <code>createView</code>
方法，这次看的是 <code>AbstractCachingViewResolver</code> 类，调用了
<code>loadView</code> 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractCachingViewResolver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WebApplicationObjectSupport</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ViewResolver</span> &#123;<br><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">protected</span> View <span class="hljs-title function_">createView</span><span class="hljs-params">(String viewName, Locale locale)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>		<span class="hljs-keyword">return</span> loadView(viewName, locale);<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>按 <code>Ctrl + Alt + 方法名</code> 进入
<code>UrlBasedViewResolver</code> 类的 <code>loadView</code>
方法：发现调用了本类的重载方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.springframework.web.servlet.view;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UrlBasedViewResolver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractCachingViewResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Ordered</span> &#123;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">protected</span> View <span class="hljs-title function_">loadView</span><span class="hljs-params">(String viewName, Locale locale)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">// 再调用重载 bulidView 方法，即下面的方法</span><br>		<span class="hljs-type">AbstractUrlBasedView</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> buildView(viewName);<br>		<span class="hljs-type">View</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> applyLifecycleMethods(viewName, view);<br>		<span class="hljs-keyword">return</span> (view.checkResource(locale) ? result : <span class="hljs-literal">null</span>);<br>	&#125;<br>    <br>    <span class="hljs-keyword">protected</span> AbstractUrlBasedView <span class="hljs-title function_">buildView</span><span class="hljs-params">(String viewName)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>		<span class="hljs-type">AbstractUrlBasedView</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> instantiateView();<br>        <br>        <span class="hljs-comment">// 这一句就是视图名进行拼串</span><br>        <span class="hljs-comment">// 前缀 + 视图名 + 后缀</span><br>		view.setUrl(getPrefix() + viewName + getSuffix());<br>		view.setAttributesMap(getAttributesMap());<br><br>		<span class="hljs-type">String</span> <span class="hljs-variable">contentType</span> <span class="hljs-operator">=</span> getContentType();<br>		<span class="hljs-keyword">if</span> (contentType != <span class="hljs-literal">null</span>) &#123;<br>			view.setContentType(contentType);<br>		&#125;<br><br>		<span class="hljs-type">String</span> <span class="hljs-variable">requestContextAttribute</span> <span class="hljs-operator">=</span> getRequestContextAttribute();<br>		<span class="hljs-keyword">if</span> (requestContextAttribute != <span class="hljs-literal">null</span>) &#123;<br>			view.setRequestContextAttribute(requestContextAttribute);<br>		&#125;<br><br>		<span class="hljs-type">Boolean</span> <span class="hljs-variable">exposePathVariables</span> <span class="hljs-operator">=</span> getExposePathVariables();<br>		<span class="hljs-keyword">if</span> (exposePathVariables != <span class="hljs-literal">null</span>) &#123;<br>			view.setExposePathVariables(exposePathVariables);<br>		&#125;<br>		<span class="hljs-type">Boolean</span> <span class="hljs-variable">exposeContextBeansAsAttributes</span> <span class="hljs-operator">=</span> getExposeContextBeansAsAttributes();<br>		<span class="hljs-keyword">if</span> (exposeContextBeansAsAttributes != <span class="hljs-literal">null</span>) &#123;<br>			view.setExposeContextBeansAsAttributes(exposeContextBeansAsAttributes);<br>		&#125;<br>		String[] exposedContextBeanNames = getExposedContextBeanNames();<br>		<span class="hljs-keyword">if</span> (exposedContextBeanNames != <span class="hljs-literal">null</span>) &#123;<br>			view.setExposedContextBeanNames(exposedContextBeanNames);<br>		&#125;<br><br>		<span class="hljs-keyword">return</span> view;<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>代码
<code>view.setUrl(getPrefix() + viewName + getSuffix());</code>
即是进行视图名拼串，所以返回一个视图只需要返回视图名就可以了</p></li>
<li><p>再调用
<code>view.render(mv.getModelInternal(), request, response);</code>
渲染页面</p></li>
</ul></li>
<li><p>如果上面都没有异常逆序执行拦截器的 <code>afterCompletion</code>
方法</p></li>
<li><p>如果出现了异常，在 <code>processDispatchResult</code> 外还有一个
<code>catch</code> 再逆序执行拦截器 <code>afterCompletion</code>
方法</p></li>
</ul></li>
</ul>
<h3 id="大概总结图记录">大概总结图记录</h3>
<figure>
<img src="/images/SSM_Study/SpringMVC响应请求简略过程.svg" srcset="/img/loading.gif" lazyload
alt="SpringMVC响应请求简略过程" />
<figcaption aria-hidden="true">SpringMVC响应请求简略过程</figcaption>
</figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Java/" class="print-no-link">#Java</a>
      
        <a href="/tags/Spring/" class="print-no-link">#Spring</a>
      
        <a href="/tags/SpringBoot/" class="print-no-link">#SpringBoot</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>SpringMVC 记录（基于 SpringBoot）</div>
      <div>https://windzwindy.github.io/2025/02/23/SpringMVC_Record/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>windzwindy</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年2月23日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2025年2月23日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/02/23/SpringBoot_Record/" title="SpringBoot 小补充记录">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">SpringBoot 小补充记录</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/02/23/Spring_Record/" title="Spring 记录（基于 SpringBoot）">
                        <span class="hidden-mobile">Spring 记录（基于 SpringBoot）</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    
      <script  src="/js/img-lazyload.js" ></script>
    
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
