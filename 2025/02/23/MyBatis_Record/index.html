

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon.png">
  <link rel="icon" href="/img/icon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="windzwindy">
  <meta name="keywords" content="">
  
    <meta name="description" content="MyBatis 记录（基于 SpringBoot） 1. HelloWorld 程序记录  准备数据库环境：helloworld.sql 123456789101112131415CREATE DATABASE &#96;mybatis-example&#96;;USE &#96;mybatis-example&#96;;CREATE TABLE &#96;t_emp&#96;(  id INT AUTO_INCREMENT,  em">
<meta property="og:type" content="article">
<meta property="og:title" content="MyBatis 记录">
<meta property="og:url" content="https://windzwindy.github.io/2025/02/23/MyBatis_Record/index.html">
<meta property="og:site_name" content="WindZwindy Blog">
<meta property="og:description" content="MyBatis 记录（基于 SpringBoot） 1. HelloWorld 程序记录  准备数据库环境：helloworld.sql 123456789101112131415CREATE DATABASE &#96;mybatis-example&#96;;USE &#96;mybatis-example&#96;;CREATE TABLE &#96;t_emp&#96;(  id INT AUTO_INCREMENT,  em">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-02-23T13:10:31.000Z">
<meta property="article:modified_time" content="2025-02-24T13:14:55.846Z">
<meta property="article:author" content="windzwindy">
<meta property="article:tag" content="MyBatis">
<meta property="article:tag" content="DataBase">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>MyBatis 记录 - WindZwindy Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"windzwindy.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":true,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>WindZwindy</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="MyBatis 记录"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-02-23 21:10" pubdate>
          2025年2月23日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          19k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          155 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">MyBatis 记录</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2025年2月24日 晚上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h1 id="mybatis-记录基于-springboot">MyBatis 记录（基于
SpringBoot）</h1>
<h2 id="helloworld-程序记录">1. HelloWorld 程序记录</h2>
<ul>
<li><p>准备数据库环境：<code>helloworld.sql</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE `mybatis<span class="hljs-operator">-</span>example`;<br><br>USE `mybatis<span class="hljs-operator">-</span>example`;<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t_emp`(<br>  id <span class="hljs-type">INT</span> AUTO_INCREMENT,<br>  emp_name <span class="hljs-type">CHAR</span>(<span class="hljs-number">100</span>),<br>  age <span class="hljs-type">INT</span>,<br>  emp_salary <span class="hljs-keyword">DOUBLE</span>(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>),<br>  <span class="hljs-keyword">PRIMARY</span> KEY(id)<br>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t_emp`(emp_name,age,emp_salary) <span class="hljs-keyword">VALUES</span>(&quot;tom&quot;,<span class="hljs-number">18</span>,<span class="hljs-number">200.33</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t_emp`(emp_name,age,emp_salary) <span class="hljs-keyword">VALUES</span>(&quot;jerry&quot;,<span class="hljs-number">19</span>,<span class="hljs-number">666.66</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t_emp`(emp_name,age,emp_salary) <span class="hljs-keyword">VALUES</span>(&quot;andy&quot;,<span class="hljs-number">20</span>,<span class="hljs-number">777.77</span>);<br></code></pre></td></tr></table></figure></li>
<li><p>创建项目</p></li>
<li><p>配置数据源：<code>application.properties</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.datasource.url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/mybatis-example</span><br><span class="hljs-attr">spring.datasource.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.datasource.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-attr">spring.datasource.driver-class-name</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br></code></pre></td></tr></table></figure></li>
<li><p>创建 <code>JavaBean</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Emp</span> &#123;<br>    <br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String empName;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> Double empSalary;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>DAO</code> 接口，命名一般为
<code>xxxMapper</code>，不用写实现类，有了 <code>MyBatis</code> 后就用
<code>xml</code> 配置文件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br><br>    Emp <span class="hljs-title function_">getEmpById</span><span class="hljs-params">(Integer id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>xml</code> 配置文件，如果用的是 <code>IDEA</code>
开发，装一个 <code>MyBatisX</code> 插件方便编写配置文件（在
<code>DAO</code> 接口上 <code>Alt + Enter</code>），一般生成到
<code>src/main/resources/mapper</code> 下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- namespace 防止冲突，如果有多个 mapper 而有 id 相同就会冲突，此时就用 namespace 进行区分 --&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- id 代表 DAO 中的方法名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- resultType 表示方法的返回值类型，要写全类名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- #&#123;&#125; 动态取值，括号内填 DAO 中的方法的参数名 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>上面配置有以下注意：</p>
<ul>
<li><code>namespace</code> 防止冲突，如果有多个 <code>mapper</code> 而有
<code>id</code> 相同就会冲突，此时就用 <code>namespace</code>
进行区分</li>
<li><code>id</code> 代表 <code>DAO</code> 中的方法名</li>
<li><code>resultType</code> 表示方法的返回值类型，要写全类名</li>
<li><code>#&#123;&#125;</code> 动态取值，括号内填 <code>DAO</code>
中的方法的参数名</li>
</ul></li>
<li><p>上面配置文件是 <code>mapper</code> 配置文件，对应的
<code>DAO</code> 接口就是 <code>mapper</code> 接口</p></li>
<li><p>告诉 <code>MyBatis</code> 配置文件在哪，配置
<code>application.properties</code>：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># 表示在类路径下 mapper 文件夹下的所有 xml 文件都是 mapper 配置文件</span><br><span class="hljs-attr">mybatis.mapper-locations</span>=<span class="hljs-string">classpath:mapper/**.xml</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.dao.EmpMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisHelloworldApplicationTests</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpMapper empMapper;<br>    <br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">contextLoads</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">empById</span> <span class="hljs-operator">=</span> empMapper.getEmpById(<span class="hljs-number">1</span>);<br>        System.out.println(<span class="hljs-string">&quot;empById = &quot;</span> + empById);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>查出来了，但 <code>name</code> 和 <code>salary</code>
字段没了，这是因为 <code>JavaBean</code>
的字段和数据库上的字段名没有对应，修改 <code>mapper</code>
配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- namespace 防止冲突，如果有多个 mapper 而有 id 相同就会冲突，此时就用 namespace 进行区分 --&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- id 代表 DAO 中的方法名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- resultType 表示方法的返回值类型，要写全类名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- #&#123;&#125; 动态取值，括号内填 DAO 中的方法的参数名 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select id, emp_name empName, age, emp_salary empSalary<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>再运行，都查出来了</p></li>
</ul>
<h3 id="总结记录">总结记录</h3>
<ul>
<li>导入 <code>MyBatis</code> 依赖</li>
<li>配置数据源信息</li>
<li>编写一个 <code>JavaBean</code> 对应数据库一个表</li>
<li>编写 <code>Mapper</code> 接口（<code>DAO</code> 接口），给接口加一个
<code>@Mapper</code> 注解</li>
<li>编写 <code>mapper</code> 配置文件，在其中写 <code>sql</code>
语句，注意 <code>sql</code> 语句不用以 <code>;</code> 结尾</li>
<li>告诉 <code>MaBatis</code> 所有的 <code>mapper</code>
配置文件在哪个文件夹下</li>
</ul>
<h3 id="mapper-接口的实现类记录"><code>Mapper</code>
接口的实现类记录</h3>
<ul>
<li><p><code>Mapper</code> 接口的实现类是什么，编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisHelloworldApplicationTests</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpMapper empMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">contextLoads</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;empMapper = &quot;</span> + empMapper.getClass());<br>        <br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">empById</span> <span class="hljs-operator">=</span> empMapper.getEmpById(<span class="hljs-number">1</span>);<br>        System.out.println(<span class="hljs-string">&quot;empById = &quot;</span> + empById);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>测试发现是一个动态代理对象</p></li>
</ul>
<h3 id="helloworld-程序增删改查单个记录">HelloWorld
程序增删改查单个记录</h3>
<ul>
<li><p>接着上面的程序继续写，先写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据 id 查询员工信息</span><br>    Emp <span class="hljs-title function_">getEmpById</span><span class="hljs-params">(Integer id)</span>;<br><br>    <span class="hljs-comment">// 添加员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmp</span><span class="hljs-params">(Emp emp)</span>;<br><br>    <span class="hljs-comment">// 更新员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmp</span><span class="hljs-params">(Emp emp)</span>;<br><br>    <span class="hljs-comment">// 根据 id 删除员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEmpById</span><span class="hljs-params">(Integer id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- namespace 防止冲突，如果有多个 mapper 而有 id 相同就会冲突，此时就用 namespace 进行区分 --&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- id 代表 DAO 中的方法名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- resultType 表示方法的返回值类型，要写全类名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- #&#123;&#125; 动态取值，括号内填 DAO 中的方法的参数名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- Emp getEmpById(Integer id); --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select id, emp_name empName, age, emp_salary empSalary<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- void addEmp(Emp emp); --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 当传过来的是对象的时候，sql 语句中的动态参数直接写对象的属性就可以，不用 对象.xxx --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addEmp&quot;</span>&gt;</span><br>        insert into t_emp(emp_name, age, emp_salary)<br>        values (#&#123;empName&#125;, #&#123;age&#125;, #&#123;empSalary&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- void updateEmp(Emp emp); --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateEmp&quot;</span>&gt;</span><br>        update t_emp<br>        set emp_name   = #&#123;empName&#125;,<br>            age        = #&#123;age&#125;,<br>            emp_salary = #&#123;empSalary&#125;<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- void deleteEmpById(Integer id); --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteEmpById&quot;</span>&gt;</span><br>        delete<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序进行测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisHelloworldApplicationTests</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpMapper empMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testCRUD</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">/*Emp emp = new Emp();</span><br><span class="hljs-comment">        emp.setEmpName(&quot;zhangsan&quot;);</span><br><span class="hljs-comment">        emp.setAge(20);</span><br><span class="hljs-comment">        emp.setEmpSalary(10000.0);</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        // 添加</span><br><span class="hljs-comment">        empMapper.addEmp(emp);*/</span><br><br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>        emp.setId(<span class="hljs-number">4</span>);<br>        emp.setEmpName(<span class="hljs-string">&quot;lisi&quot;</span>);<br>        emp.setAge(<span class="hljs-number">19</span>);<br>        emp.setEmpSalary(<span class="hljs-number">10000.0</span>);<br><br>        <span class="hljs-comment">// 修改</span><br>        empMapper.updateEmp(emp);<br>        <br>        <span class="hljs-comment">// 删除</span><br>        empMapper.deleteEmpById(<span class="hljs-number">4</span>);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>注意：如果添加信息成功后，如何获取到自增的 <code>id</code>，用
<code>MyBatis</code> 的主键回填机制：</p>
<ul>
<li><p>在 <code>mapper</code> 配置文件中的语句上添加一个
<code>useGeneratedKeys</code> 参数并赋值为 <code>true</code></p></li>
<li><p>再添加一个 <code>keyProperty</code> 参数，指定自动生成的
<code>id</code> 封装到对象上</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpMapper&quot;</span>&gt;</span><br><br>	<span class="hljs-comment">&lt;!-- void addEmp(Emp emp); --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 当传过来的是对象的时候，sql 语句中的动态参数直接写对象的属性就可以，不用 对象.xxx --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 主键回填机制两步 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- useGeneratedKeys：使用自动生成的 id --&gt;</span><br>    <span class="hljs-comment">&lt;!-- keyProperty：指定生成的 id 回填到哪个属性上 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addEmp&quot;</span> <span class="hljs-attr">useGeneratedKeys</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><br>        insert into t_emp(emp_name, age, emp_salary)<br>        values (#&#123;empName&#125;, #&#123;age&#125;, #&#123;empSalary&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>这样，在添加后就可以获取到 <code>id</code> 了，测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisHelloworldApplicationTests</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpMapper empMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testCRUD</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>        emp.setEmpName(<span class="hljs-string">&quot;zhangsan&quot;</span>);<br>        emp.setAge(<span class="hljs-number">20</span>);<br>        emp.setEmpSalary(<span class="hljs-number">10000.0</span>);<br><br>        <span class="hljs-comment">// 添加</span><br>        empMapper.addEmp(emp);<br>		<br>        <span class="hljs-comment">// 获取自增 id</span><br>        System.out.println(<span class="hljs-string">&quot;emp.getId() = &quot;</span> + emp.getId());<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h3 id="helloworld-程序查询所有记录">HelloWorld 程序查询所有记录</h3>
<ul>
<li><p>如果查询的是多条数据，返回的是集合，此时配置文件中的
<code>resultType</code> 不用写集合类型，就写集合泛型就可以了</p></li>
<li><p>先写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据 id 查询员工信息</span><br>    Emp <span class="hljs-title function_">getEmpById</span><span class="hljs-params">(Integer id)</span>;<br><br>    <span class="hljs-comment">// 查询所有员工信息</span><br>    List&lt;Emp&gt; <span class="hljs-title function_">getAllEmp</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">// 添加员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmp</span><span class="hljs-params">(Emp emp)</span>;<br><br>    <span class="hljs-comment">// 更新员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmp</span><span class="hljs-params">(Emp emp)</span>;<br><br>    <span class="hljs-comment">// 根据 id 删除员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteEmpById</span><span class="hljs-params">(Integer id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- namespace 防止冲突，如果有多个 mapper 而有 id 相同就会冲突，此时就用 namespace 进行区分 --&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- id 代表 DAO 中的方法名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- resultType 表示方法的返回值类型，要写全类名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- #&#123;&#125; 动态取值，括号内填 DAO 中的方法的参数名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- Emp getEmpById(Integer id); --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select id, emp_name empName, age, emp_salary empSalary<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- List&lt;Emp&gt; getAllEmp(); --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAllEmp&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select id, emp_name empName, age, emp_salary empSalary<br>        from t_emp<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- void addEmp(Emp emp); --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 当传过来的是对象的时候，sql 语句中的动态参数直接写对象的属性就可以，不用 对象.xxx --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 主键回填机制两步 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- useGeneratedKeys：使用自动生成的 id --&gt;</span><br>    <span class="hljs-comment">&lt;!-- keyProperty：指定生成的 id 回填到哪个属性上 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addEmp&quot;</span> <span class="hljs-attr">useGeneratedKeys</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><br>        insert into t_emp(emp_name, age, emp_salary)<br>        values (#&#123;empName&#125;, #&#123;age&#125;, #&#123;empSalary&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- void updateEmp(Emp emp); --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateEmp&quot;</span>&gt;</span><br>        update t_emp<br>        set emp_name   = #&#123;empName&#125;,<br>            age        = #&#123;age&#125;,<br>            emp_salary = #&#123;empSalary&#125;<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- void deleteEmpById(Integer id); --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteEmpById&quot;</span>&gt;</span><br>        delete<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpMapper;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisHelloworldApplicationTests</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpMapper empMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testAll</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Emp&gt; allEmp = empMapper.getAllEmp();<br><br>        <span class="hljs-keyword">for</span> (Emp emp : allEmp) &#123;<br>            System.out.println(emp);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="开启-camel-case-属性与-snake-case-字段的映射记录">开启
<code>camel case</code> 属性与 <code>snake case</code>
字段的映射记录</h3>
<ul>
<li><p>如果在 <code>JavaBean</code>
中的属性名用的是驼峰命名，而在数据库中的字段用的是蛇形命名，那么可以开启
<code>MyBatis</code> 的自动映射功能</p></li>
<li><p>比如属性中的 <code>oneTwoThree</code> 和字段中的
<code>one_two_three</code> 就可以自动映射</p></li>
<li><p>在 <code>application.properties</code> 文件中进行配置：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">mybatis.configuration.map-underscore-to-camel-case</span>=<span class="hljs-string">true</span><br></code></pre></td></tr></table></figure></li>
<li><p>再写 <code>mapper</code> 配置文件进行测试：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- List&lt;Emp&gt; getAllEmp(); --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAllEmp&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p><code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpMapper</span> &#123;<br><br>    <span class="hljs-comment">// 查询所有员工信息</span><br>    List&lt;Emp&gt; <span class="hljs-title function_">getAllEmp</span><span class="hljs-params">()</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpMapper;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisHelloworldApplicationTests</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpMapper empMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testAll</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Emp&gt; allEmp = empMapper.getAllEmp();<br><br>        <span class="hljs-keyword">for</span> (Emp emp : allEmp) &#123;<br>            System.out.println(emp);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="开启日志记录">开启日志记录</h3>
<ul>
<li><p>在 <code>application.properties</code>
配置文件中进行配置，格式为：<code>loggin.level.包名=debug</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">logging.level.org.wind.mybatis.mapper</span>=<span class="hljs-string">debug</span><br></code></pre></td></tr></table></figure></li>
<li><p>日志级别有以下几个：</p>
<ul>
<li>trace</li>
<li>debug</li>
<li>info</li>
<li>warn</li>
<li>error</li>
<li>fatal</li>
<li>off</li>
</ul></li>
</ul>
<h3 id="和-的区别记录"><code>#&#123;&#125;</code> 和 <code>$&#123;&#125;</code>
的区别记录</h3>
<ul>
<li><code>#&#123;&#125;</code> 取值是预编译方式，就是
<code>PreparedStatement</code>，预留一个参数占位符编译 <code>sql</code>
语句，再给占位符赋值</li>
<li><code>$&#123;&#125;</code> 取值是拼接方式，就是
<code>Statement</code>，直接编译有参数值的 <code>sql</code>
语句，使用不当容易发生 <code>sql</code> 注入的问题</li>
</ul>
<h2 id="参数取值记录">2. 参数取值记录</h2>
<ul>
<li><p>在 <code>mapper</code> 配置文件中，如何获取在 <code>Mapper</code>
接口中写的方法参数呢？</p>
<table>

<thead>
<tr>
<th>传参形式</th>
<th>示例</th>
<th>取值方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>单个参数（普通类型）</td>
<td><code>getEmploy(Long id)</code></td>
<td><code>#&#123;变量名&#125;</code> 或者 <code>#&#123;任意名&#125;</code></td>
</tr>
<tr>
<td>单个参数（List 类型）</td>
<td><code>getEmploy(List&lt;Long&gt; id)</code></td>
<td><code>#&#123;变量名[索引]&#125;</code>（这里不能用任意名）</td>
</tr>
<tr>
<td>单个参数（对象类型）</td>
<td><code>addEmploy(Emp e)</code></td>
<td><code>#&#123;对象中的属性名&#125;</code>（本质是调用了 <code>getter</code>
方法）</td>
</tr>
<tr>
<td>单个参数（Map 类型）</td>
<td><code>addEmploy(Map&lt;String,Object&gt; m)</code></td>
<td><code>#&#123;map中的key名&#125;</code></td>
</tr>
<tr>
<td>多个参数（无 <code>@Param</code> 注解）</td>
<td><code>getEmploy(Long id, String name)</code></td>
<td><code>#&#123;变量名&#125;</code>（新版才支持）、<code>#&#123;arg0&#125;</code>（表示第一个参数，旧版才可用）、<code>#&#123;param1&#125;</code>（表示第一个参数）</td>
</tr>
<tr>
<td>多个参数（有 <code>@Param</code> 注解）</td>
<td><code>getEmploy(@Param("id") Long id, @Param("name") String name)</code></td>
<td><code>#&#123;@Param注解指定的名&#125;</code></td>
</tr>
<tr>
<td>多个参数混合</td>
<td><code>Emp getEmployByMix(@Param("id") Integer id,@Param("map") Map&lt;String, Object&gt; map,@Param("ages") List&lt;Integer&gt; ages,@Param("e") Emp e);</code></td>
<td><code>#&#123;id&#125;</code><br/><code>#&#123;map.name&#125;</code><br/><code>#&#123;ages[0]&#125;</code><br/><code>#&#123;e.empSalary&#125;</code></td>
</tr>
</tbody>
</table></li>
</ul>
<h3 id="单个参数普通类型记录">单个参数（普通类型）记录</h3>
<ul>
<li><p>直接用 <code>#&#123;变量名&#125;</code></p></li>
<li><p>比如接口中有一方法：<code>getEmploy(Long id)</code>，只有一个
<code>id</code> 参数</p></li>
<li><p>在配置文件中就是：<code>#&#123;id&#125;</code>，或者：<code>#&#123;abc&#125;</code>，取的时候与名字无关，因为只有一个参数</p></li>
<li><p><code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpParamMapper</span> &#123;<br><br>    Emp <span class="hljs-title function_">getEmploy</span><span class="hljs-params">(Integer id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpParamMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmploy&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>    <br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpParamMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParamTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpParamMapper empParamMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testParam1</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">employ</span> <span class="hljs-operator">=</span> empParamMapper.getEmploy(<span class="hljs-number">1</span>);<br>        System.out.println(<span class="hljs-string">&quot;employ = &quot;</span> + employ);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="单个参数list-类型记录">单个参数（List 类型）记录</h3>
<ul>
<li><p>直接用 <code>#&#123;变量名[索引]&#125;</code></p></li>
<li><p>比如接口中有一方法：<code>getEmploy(List&lt;Long&gt; id)</code>，只有一个参数且参数类型为
<code>List</code></p></li>
<li><p>在配置文件中就是：<code>#&#123;id[索引]&#125;</code></p></li>
<li><p><code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpParamMapper</span> &#123;<br><br>    <span class="hljs-comment">// 假设获取集合中第 1 个元素</span><br>    Emp <span class="hljs-title function_">getEmploy02</span><span class="hljs-params">(List&lt;Integer&gt; id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpParamMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmploy02&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        where id = #&#123;id[0]&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpParamMapper;<br><br><span class="hljs-keyword">import</span> java.util.Arrays;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParamTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpParamMapper empParamMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testParam2</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">employ02</span> <span class="hljs-operator">=</span> empParamMapper.getEmploy02(Arrays.asList(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>));<br>        System.out.println(<span class="hljs-string">&quot;employ02 = &quot;</span> + employ02);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="单个参数对象类型记录">单个参数（对象类型）记录</h3>
<ul>
<li><p>直接用 <code>#&#123;对象中的属性名&#125;</code></p></li>
<li><p><code>Emp</code> 类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Emp</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String empName;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> Double empSalary;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>接口中有一方法： <code>addEmploy(Emp e)</code></p></li>
<li><p>在配置文件中就是：</p>
<ul>
<li><code>#&#123;id&#125;</code>：取出 <code>id</code> 属性</li>
<li><code>#&#123;empName&#125;</code>：取出 <code>empName</code> 属性</li>
<li><code>#&#123;age&#125;</code>：取出 <code>age</code> 属性</li>
<li><code>#&#123;empSalary&#125;</code>：取出 <code>empSalary</code> 属性</li>
</ul></li>
<li><p>不能用
<code>#&#123;e.id&#125;</code>，这种写法只有在多个参数时会出现，其它属性同理</p></li>
<li><p>其本质就是调用了属性的 <code>getter</code> 方法，如果在
<code>Emp</code> 类中写一个 <code>getMyId</code> 方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Emp</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String empName;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> Double empSalary;<br>    <br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">getMyId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.id;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>那么在配置文件中获取 <code>id</code>
属性也可以用：<code>#&#123;myId&#125;</code></p></li>
<li><p><code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpParamMapper</span> &#123;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmploy</span><span class="hljs-params">(Emp e)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpParamMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addEmploy&quot;</span>&gt;</span><br>        insert into t_emp(emp_name, age, emp_salary)<br>        values (#&#123;empName&#125;, #&#123;age&#125;, #&#123;empSalary&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpParamMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParamTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpParamMapper empParamMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testParam3</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>        emp.setEmpName(<span class="hljs-string">&quot;wangwu&quot;</span>);<br>        emp.setAge(<span class="hljs-number">20</span>);<br>        emp.setEmpSalary(<span class="hljs-number">10000.0D</span>);<br><br>        empParamMapper.addEmploy(emp);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="单个参数map-类型记录">单个参数（Map 类型）记录</h3>
<ul>
<li><p>直接用 <code>#&#123;map中key的名&#125;</code></p></li>
<li><p><code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpParamMapper</span> &#123;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmploy02</span><span class="hljs-params">(Map&lt;String, Object&gt; m)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpParamMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addEmploy02&quot;</span>&gt;</span><br>        insert into t_emp(emp_name, age, emp_salary)<br>        values (#&#123;name&#125;, #&#123;age&#125;, #&#123;salary&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpParamMapper;<br><br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParamTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpParamMapper empParamMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testParam4</span><span class="hljs-params">()</span> &#123;<br>        Map&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        map.put(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;zhaoliu&quot;</span>);<br>        map.put(<span class="hljs-string">&quot;age&quot;</span>, <span class="hljs-number">25</span>);<br>        map.put(<span class="hljs-string">&quot;salary&quot;</span>, <span class="hljs-number">6000.0D</span>);<br><br>        empParamMapper.addEmploy02(map);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="多个参数无-param-注解记录">多个参数（无 <code>@Param</code>
注解）记录</h3>
<ul>
<li><p>直接用 <code>#&#123;参数名&#125;</code>（只在新版本可用）</p></li>
<li><p>或者用 <code>#&#123;arg索引&#125;</code>（只在低版本可用），索引从 0
开始，例如：<code>#&#123;arg0&#125;</code> 取第 1 个参数</p></li>
<li><p>又或者用 <code>#&#123;param索引&#125;</code>，索引从 1
开始，例如：<code>#&#123;param1&#125;</code> 取第 1 个参数</p></li>
<li><p><code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpParamMapper</span> &#123;<br><br>    Emp <span class="hljs-title function_">getEmployByIdAndName</span><span class="hljs-params">(Integer id, String name)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpParamMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmployByIdAndName&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        where id = #&#123;id&#125;<br>          and emp_name = #&#123;name&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpParamMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParamTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpParamMapper empParamMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testParam5</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">tom</span> <span class="hljs-operator">=</span> empParamMapper.getEmployByIdAndName(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;tom&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;tom = &quot;</span> + tom);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="多个参数有-param-注解记录">多个参数（有 <code>@Param</code>
注解）记录</h3>
<ul>
<li><p>直接用 <code>#&#123;@Param注解指定的参数名&#125;</code></p></li>
<li><p><code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpParamMapper</span> &#123;<br>    <br>    Emp <span class="hljs-title function_">getEmployByIdAndName02</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;empId&quot;)</span> Integer id, <span class="hljs-meta">@Param(&quot;empName&quot;)</span> String name)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpParamMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmployByIdAndName02&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        where id = #&#123;empId&#125;<br>          and emp_name = #&#123;empName&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpParamMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParamTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpParamMapper empParamMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testParam6</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">tom</span> <span class="hljs-operator">=</span> empParamMapper.getEmployByIdAndName02(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;tom&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;tom = &quot;</span> + tom);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="多个参数混合记录">多个参数混合记录</h3>
<ul>
<li><p><code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Param;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpParamMapper</span> &#123;<br><br>    <span class="hljs-comment">// 假设 id 从 id 中取，name 从 map 中取，age 从 ages 中的第 1 个元素取，salary 从 e 中取</span><br>    Emp <span class="hljs-title function_">getEmployByMix</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> Integer id,</span><br><span class="hljs-params">                       <span class="hljs-meta">@Param(&quot;map&quot;)</span> Map&lt;String, Object&gt; map,</span><br><span class="hljs-params">                       <span class="hljs-meta">@Param(&quot;ages&quot;)</span> List&lt;Integer&gt; ages,</span><br><span class="hljs-params">                       <span class="hljs-meta">@Param(&quot;e&quot;)</span> Emp e)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpParamMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmployByMix&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        where id = #&#123;id&#125;<br>          and emp_name = #&#123;map.name&#125;<br>          and age = #&#123;ages[0]&#125;<br>          and emp_salary = #&#123;e.empSalary&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpParamMapper;<br><br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParamTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpParamMapper empParamMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testParamMix</span><span class="hljs-params">()</span> &#123;<br>        Map&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        map.put(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;tom&quot;</span>);<br><br>        List&lt;Integer&gt; ages = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        ages.add(<span class="hljs-number">18</span>);<br><br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>        emp.setEmpSalary(<span class="hljs-number">200.33000D</span>);<br><br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">employByMix</span> <span class="hljs-operator">=</span> empParamMapper.getEmployByMix(<span class="hljs-number">1</span>, map, ages, emp);<br>        System.out.println(<span class="hljs-string">&quot;employByMix = &quot;</span> + employByMix);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="注解-param-记录">注解 <code>@Param</code> 记录</h3>
<ul>
<li>用于指定 <code>mapper</code> 配置文件中的 <code>sql</code>
语句取参数时的参数名</li>
<li>注解参数 <code>value</code>：指定取参数时的参数名</li>
<li>比如 <code>@Param("abc")</code> 在 <code>mapper</code>
配置文件中对应的取值为 <code>#&#123;abc&#125;</code></li>
</ul>
<h2 id="结果处理记录">3. 结果处理记录</h2>
<h3 id="返回普通数据结果集记录">返回普通数据结果集记录</h3>
<ul>
<li><p>返回基本类型：在 <code>resultType</code> 中写以下类型</p>
<ul>
<li><p><code>byte</code>、<code>short</code>、<code>int</code>、<code>long</code>、<code>float</code>、<code>double</code>、<code>boolean</code>、<code>char</code>、<code>String</code></p></li>
<li><p><code>java.lang.(基本类型包装类)</code></p></li>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpReturnValueMapper</span> &#123;<br><br>    Long <span class="hljs-title function_">countEmp</span><span class="hljs-params">()</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpReturnValueMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;countEmp&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;java.lang.Long&quot;</span>&gt;</span><br>        select count(*)<br>        from t_emp<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpReturnValueMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReturnValueTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpReturnValueMapper empReturnValueMapper;<br>    <br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test01</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Long</span> <span class="hljs-variable">l</span> <span class="hljs-operator">=</span> empReturnValueMapper.countEmp();<br>        System.out.println(<span class="hljs-string">&quot;l = &quot;</span> + l);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>返回普通对象：在 <code>resultType</code>
中写对象的全类名，比如想获取员工的薪资用 <code>BigDecimal</code>
接收：</p>
<ul>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpReturnValueMapper</span> &#123;<br><br>    BigDecimal <span class="hljs-title function_">getEmpSalaryById</span><span class="hljs-params">(Integer id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpReturnValueMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpSalaryById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;java.math.BigDecimal&quot;</span>&gt;</span><br>        select emp_salary<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpReturnValueMapper;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReturnValueTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpReturnValueMapper empReturnValueMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test02</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">empSalaryById</span> <span class="hljs-operator">=</span> empReturnValueMapper.getEmpSalaryById(<span class="hljs-number">1</span>);<br>        System.out.println(<span class="hljs-string">&quot;empSalaryById = &quot;</span> + empSalaryById);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>普通类型有简便写法，用别名：<a
target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/configuration.html#typeAliases">官方文档</a></p></li>
</ul>
<h3 id="返回集合数据结果集记录">返回集合数据结果集记录</h3>
<ul>
<li><p>返回一个 <code>List</code> 集合，泛型是 <code>JavaBean</code>
类型：</p>
<ul>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpReturnValueMapper</span> &#123;<br><br>    List&lt;Emp&gt; <span class="hljs-title function_">getAll</span><span class="hljs-params">()</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code>
配置文件，注意，此时在返回值类型中直接写泛型的类型就可以了：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpReturnValueMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAll&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpReturnValueMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReturnValueTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpReturnValueMapper empReturnValueMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test03</span><span class="hljs-params">()</span> &#123;<br>        empReturnValueMapper.getAll().forEach(System.out::println);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>返回一个 <code>Map</code> 集合：</p>
<ul>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.MapKey;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpReturnValueMapper</span> &#123;<br><br>    <span class="hljs-meta">@MapKey(&quot;id&quot;)</span><br>    Map&lt;Integer, Emp&gt; <span class="hljs-title function_">getAllMap</span><span class="hljs-params">()</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpReturnValueMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAllMap&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;java.util.Map&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpReturnValueMapper;<br><br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReturnValueTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpReturnValueMapper empReturnValueMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test04</span><span class="hljs-params">()</span> &#123;<br>        Map&lt;Integer, Emp&gt; allMap = empReturnValueMapper.getAllMap();<br>        System.out.println(<span class="hljs-string">&quot;allMap = &quot;</span> + allMap);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>注意：此时返回的 <code>Map</code> 中的 <code>value</code>
并不是一个 <code>Emp</code> 类型，而是一个 <code>HashMap</code>
类型，可以通过测试程序验证：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpReturnValueMapper;<br><br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReturnValueTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpReturnValueMapper empReturnValueMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test04</span><span class="hljs-params">()</span> &#123;<br>        Map&lt;Integer, Emp&gt; allMap = empReturnValueMapper.getAllMap();<br>        System.out.println(<span class="hljs-string">&quot;allMap = &quot;</span> + allMap);<br><br>        System.out.println(allMap.get(<span class="hljs-number">1</span>).getClass());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>如果要实现 <code>Map</code> 返回结果中的 <code>value</code>
为一个 <code>Emp</code> 类型，如何实现</p>
<ul>
<li>在 <code>mapper</code> 配置文件中的返回值类型不写
<code>Map</code>，写要返回的类型，即写法同 <code>List</code></li>
</ul></li>
<li><p>更改 <code>mapper</code> 配置文件，再测试程序：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpReturnValueMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAllMap&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>其它的返回集合也一样，比如：</p>
<ul>
<li>接口返回的是 <code>List&lt;Map&lt;String, Object&gt;&gt;</code>
对应的配置文件中返回的就是 <code>map</code> ，类似于
<code>List&lt;Emp&gt;</code> 就填 <code>emp</code></li>
<li>接口返回的是 <code>Map&lt;Long, Map&lt;String, Object&gt;&gt;</code>
对应的配置文件中返回的就是 <code>map</code>，配合 <code>@MapKey</code>
注解使用</li>
</ul></li>
</ul>
<h4 id="注解-mapkey-记录">注解 <code>@MapKey</code> 记录：</h4>
<ul>
<li>用于 <code>Mapper</code> 返回值为 <code>java.util.Map</code>
时，指定 <code>Map</code> 的 <code>key</code>
为哪一个返回的数据库字段</li>
<li>注解参数 <code>value</code>：指定返回的数据库字段名作为
<code>Map</code> 中的 <code>key</code></li>
</ul>
<h3 id="返回自定义结果集记录">返回自定义结果集记录</h3>
<ul>
<li><p>可以先看看<a
target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/sqlmap-xml.html#result-maps">官方文档</a></p></li>
<li><p>假定有那么一个情况：没有开启
<code>mybatis.configuration.map-underscore-to-camel-case=true</code>
配置</p></li>
<li><p>那么查询时就会有些查到的数据为空，比如根据 <code>id</code>
查询员工信息：</p>
<ul>
<li><p>先编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.MapKey;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpReturnValueMapper</span> &#123;<br><br>    Emp <span class="hljs-title function_">getEmpById</span><span class="hljs-params">(Integer id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再编写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpReturnValueMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select * from t_emp where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpReturnValueMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReturnValueTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpReturnValueMapper empReturnValueMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test05</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">empById</span> <span class="hljs-operator">=</span> empReturnValueMapper.getEmpById(<span class="hljs-number">1</span>);<br>        System.out.println(<span class="hljs-string">&quot;empById = &quot;</span> + empById);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>为什么查询出来后会有部分数据为空？因为 <code>resultType</code>
默认规则如下：</p>
<ul>
<li>因为在查询到数据后，会调用要封装的对象的无参构造方法创建实例</li>
<li>再调用对应的 <code>setter</code> 方法给属性赋值</li>
<li>就在调用 <code>setter</code> 方法时找不到对应的 <code>setter</code>
方法，所以有些数据为空</li>
<li>比如数据库字段为 <code>emp_name</code> 在找 <code>setter</code>
方法时会找 <code>setEmp_name</code>，但对象只有 <code>empName</code>
属性和 <code>setEmpName</code> 方法，所以 <code>empName</code>
属性为空</li>
</ul></li>
<li><p>此时查询出来的数据有些为空，解决方法有很多：</p>
<ul>
<li><code>JavaBean</code>
属性名和数据库字段名一致（不推荐这种方法）</li>
<li>在 <code>sql</code> 语句上用别名</li>
<li>开启驼峰命名自动映射</li>
<li>使用 <code>resultMap</code> 自定义结果集</li>
<li>...</li>
</ul></li>
<li><p>使用 <code>resultMap</code>
返回自定义结果集，再运行测试程序，成功获取到数据：</p>
<ul>
<li><p>新建一个 <code>resultMap</code> 标签，并指定
<code>resultMap</code> 标签的 <code>id</code> 参数和 <code>type</code>
参数</p>
<ul>
<li>其中参数 <code>id</code> 的值是唯一的</li>
<li>参数 <code>type</code> 的值写要封装成的对象类型</li>
</ul></li>
<li><p>然后在 <code>resultMap</code> 标签里面写一个 <code>id</code>
标签和 <code>result</code> 标签</p>
<ul>
<li>其中 <code>id</code> 标签用于指定主键间的映射规则</li>
<li>而 <code>result</code> 标签用于指定数据库中的字段和
<code>JavaBean</code> 中的属性间的映射规则</li>
<li>而标签中有 <code>column</code> 和 <code>property</code> 和
<code>javaType</code> 和 <code>jdbcType</code> 参数
<ul>
<li>参数 <code>column</code> 用于指定数据库中的字段名</li>
<li>参数 <code>property</code> 用于指定 <code>JavaBean</code>
中的对应的属性名</li>
<li>参数 <code>javaType</code> 用于指定 <code>JavaBean</code>
中的对应的属性名的类型</li>
<li>参数 <code>jdbcType</code> 用于指定数据库中的对应的字段的类型</li>
</ul></li>
</ul></li>
<li><p>然后在查询标签中的 <code>resultMap</code> 参数中写上面的
<code>resultMap</code> 标签参数 <code>id</code> 中的值</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpReturnValueMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 自定义结果集 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;EmpRm&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- id 标签表示主键映射规则 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- column 表示数据库中的列名 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- property 表示对应的 JavaBean 中的属性名 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- result 标签表示对普通列的映射规则 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- javaType 表示 JavaBean 中的属性类型 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- jdbcType 表示对应的数据库中的字段类型 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 但是默认不用写 javaType 和 jdbcType，因为会自动识别 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;emp_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;empName&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;java.lang.String&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;VARCHAR&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;age&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;age&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;emp_salary&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;empSalary&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpById&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;EmpRm&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h3 id="返回自定义结果集高级映射记录">返回自定义结果集高级映射记录</h3>
<ul>
<li><p>有时候要进行联表查询，就会出现一个级联属性，比如一个类中有一个属性是另一个类，此时就要用下面的标签进行映射了</p></li>
<li><p>其中 <code>resultMap</code> 标签除了有 <code>id</code> 标签和
<code>type</code> 标签外，还有两个标签，即 <code>collection</code>
标签和 <code>association</code> 标签</p></li>
<li><p>给数据库加 <code>t_customer</code> 表和 <code>t_order</code>
表用于学习 <code>resultMap</code> 的 <code>collection</code> 标签和
<code>association</code> 标签：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SET</span> NAMES utf8mb4;<br><span class="hljs-keyword">SET</span> FOREIGN_KEY_CHECKS <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `t_customer`;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t_customer`  (<br>  `id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT,<br>  `customer_name` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;客户姓名&#x27;</span>,<br>  `phone` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;手机号&#x27;</span>,<br>  <span class="hljs-keyword">PRIMARY</span> KEY (`id`) <span class="hljs-keyword">USING</span> BTREE<br>) ENGINE <span class="hljs-operator">=</span> InnoDB AUTO_INCREMENT <span class="hljs-operator">=</span> <span class="hljs-number">4</span> <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> <span class="hljs-operator">=</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> <span class="hljs-operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="hljs-operator">=</span> <span class="hljs-keyword">Dynamic</span>;<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t_customer` <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;张三&#x27;</span>, <span class="hljs-string">&#x27;13100000000&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t_customer` <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;李四&#x27;</span>, <span class="hljs-string">&#x27;13200000000&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t_customer` <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;王五&#x27;</span>, <span class="hljs-string">&#x27;13300000000&#x27;</span>);<br><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `t_order`;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t_order`  (<br>  `id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="hljs-string">&#x27;订单id&#x27;</span>,<br>  `address` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;派送地址&#x27;</span>,<br>  `amount` <span class="hljs-type">decimal</span>(<span class="hljs-number">10</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;订单金额&#x27;</span>,<br>  `customer_id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;客户id&#x27;</span>,<br>  <span class="hljs-keyword">PRIMARY</span> KEY (`id`) <span class="hljs-keyword">USING</span> BTREE<br>) ENGINE <span class="hljs-operator">=</span> InnoDB AUTO_INCREMENT <span class="hljs-operator">=</span> <span class="hljs-number">4</span> <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> <span class="hljs-operator">=</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> <span class="hljs-operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="hljs-operator">=</span> <span class="hljs-keyword">Dynamic</span>;<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t_order` <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;西安市雁塔区&#x27;</span>, <span class="hljs-number">99.98</span>, <span class="hljs-number">1</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t_order` <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;北京市&#x27;</span>, <span class="hljs-number">199.00</span>, <span class="hljs-number">1</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t_order` <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;深圳市&#x27;</span>, <span class="hljs-number">299.00</span>, <span class="hljs-number">2</span>);<br><br><span class="hljs-keyword">SET</span> FOREIGN_KEY_CHECKS <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="一对一查询结果封装记录">一对一查询结果封装记录</h4>
<ul>
<li><p>写一个 <code>JavaBean</code> 类 <code>Customer.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Customer</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String customerName;<br>    <span class="hljs-keyword">private</span> String phone;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再写一个 <code>JavaBean</code> 类 <code>Order.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-keyword">private</span> BigDecimal amount;<br>    <span class="hljs-keyword">private</span> Long customerId;<br><br>    <span class="hljs-keyword">private</span> Customer customer;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再写 <code>Mapper</code> 接口
<code>CustomerMapper.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CustomerMapper</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>写一个配置文件 <code>CustomerMapper.xml</code>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.CustomerMapper&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>再写一个 <code>Mapper</code> 接口 <code>OrderMapper</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Order;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据 id 查询订单以及下单的客户信息</span><br>    Order <span class="hljs-title function_">getOrderByIdWithCustomer</span><span class="hljs-params">(Long id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再写一个配置文件 <code>OrderMapper.xml</code>
进行联表信息查询：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getOrderByIdWithCustomer&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;OrderRM&quot;</span>&gt;</span><br>        select o.*,<br>               c.id c_id,<br>               c.customer_name,<br>               c.phone<br>        from t_order o<br>                 left join t_customer c on o.customer_id = c.id<br>        where o.id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>注意，此时返回类型中的 <code>customer</code>
属性能成功映射吗？</p></li>
<li><p>编写测试程序进行测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Order;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.OrderMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JoinQueryTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    OrderMapper orderMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test01</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Order</span> <span class="hljs-variable">orderByIdWithCustomer</span> <span class="hljs-operator">=</span> orderMapper.getOrderByIdWithCustomer(<span class="hljs-number">1L</span>);<br>        System.out.println(<span class="hljs-string">&quot;orderByIdWithCustomer = &quot;</span> + orderByIdWithCustomer);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>发现其中的 <code>customer</code> 属性为
<code>null</code>，即不能正常映射，因为没有 <code>customer</code> 对应的
<code>setter</code> 方法</p></li>
<li><p>如何解决，当然可以在 <code>Order</code> 类中写几个
<code>setter</code> 方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setC_id</span><span class="hljs-params">(Long id)</span> &#123;<br>    <span class="hljs-type">Customer</span> <span class="hljs-variable">customer1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Customer</span>();<br>    customer1.setId(id);<br>    <span class="hljs-built_in">this</span>.setCustomer(customer1);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setCustomer_name</span><span class="hljs-params">(String customerName)</span> &#123;<br>    <span class="hljs-type">Customer</span> <span class="hljs-variable">customer1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Customer</span>();<br>    customer1.setCustomerName(customerName);<br>    <span class="hljs-built_in">this</span>.setCustomer(customer1);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPhone</span><span class="hljs-params">(String phone)</span> &#123;<br>    <span class="hljs-type">Customer</span> <span class="hljs-variable">customer1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Customer</span>();<br>    customer1.setPhone(phone);<br>    <span class="hljs-built_in">this</span>.setCustomer(customer1);<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>但这很麻烦，不是想要的解决方法，此时可以用 <code>resultMap</code>
自定义结果集中的 <code>association</code> 标签进行一对一关联：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;OrderRM&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;address&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;amount&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;amount&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;customer_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customerId&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 一对一关联 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- javaType 指定关联的属性的类型 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 在 association 标签中再进行映射 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customer&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;c_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;customer_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customerName&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phone&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;phone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">association</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getOrderByIdWithCustomer&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;OrderRM&quot;</span>&gt;</span><br>        select o.*,<br>               c.id c_id,<br>               c.customer_name,<br>               c.phone<br>        from t_order o<br>                 left join t_customer c on o.customer_id = c.id<br>        where o.id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>再运行测试程序，测试成功</p></li>
</ul>
<h4 id="一对多查询结果封装记录">一对多查询结果封装记录</h4>
<ul>
<li><p>下面再进行一对多查询，比如根据客户 <code>id</code>
进行查询客户的所有订单，即一个客户对应多个订单</p></li>
<li><p>在 <code>Customer</code> 中新加一个属性 <code>orders</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Customer</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String customerName;<br>    <span class="hljs-keyword">private</span> String phone;<br><br>    <span class="hljs-keyword">private</span> List&lt;Order&gt; orders;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再写一个 <code>Mapper</code> 接口方法根据客户 <code>id</code>
查询客户信息，客户信息中有订单信息，订单信息有多条</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CustomerMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据 id 查询对应客户信息，其中客户类中有一个订单属性，订单属性类型为 List</span><br>    Customer <span class="hljs-title function_">getCustomerByIdWithOrders</span><span class="hljs-params">(Long id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再编写 <code>mapper</code>
配置文件，此时因为返回的是一个集合，所以用 <code>collection</code>
标签，标签的 <code>ofType</code> 参数用于指定集合的泛型：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.CustomerMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;CutomerRM&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;c_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;customer_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customerName&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phone&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;phone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 使用 collection 来指明 一对N 的封装规则，即返回的是一个集合时用 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 参数 property 指定属性名 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 参数 ofType 指定集合中的类型 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orders&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;address&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;amount&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;amount&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>            <span class="hljs-comment">&lt;!-- 这个其实就是上面的 c_id 所以可以用 c_id 来代替 --&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;result column=&quot;customer_id&quot; property=&quot;customerId&quot;&gt;&lt;/result&gt;--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;c_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customerId&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getCustomerByIdWithOrders&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;CutomerRM&quot;</span>&gt;</span><br>        select c.id c_id,<br>               c.customer_name,<br>               c.phone,<br>               o.*<br>        from t_customer c<br>                 left join t_order o on c.id = o.customer_id<br>        where c.id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.CustomerMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JoinQueryTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    CustomerMapper customerMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test02</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Customer</span> <span class="hljs-variable">customerByIdWithOrders</span> <span class="hljs-operator">=</span> customerMapper.getCustomerByIdWithOrders(<span class="hljs-number">1L</span>);<br>        System.out.println(<span class="hljs-string">&quot;customerByIdWithOrders = &quot;</span> + customerByIdWithOrders);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="分步查询记录">分步查询记录</h4>
<h5 id="collection-使用分步查询记录"><code>collection</code>
使用分步查询记录</h5>
<ul>
<li><p>在之前的例子中要查一个客户的订单信息就必须要把客户表和订单表进行联表查询才能得到结果</p></li>
<li><p>其实也可以不用联表能达到同样的效果，即分步查询：</p>
<ul>
<li>先去客户表查出客户信息</li>
<li>再用客户信息去订单表查出所有的订单信息</li>
<li>最后再对客户信息和订单信息进行封装</li>
</ul></li>
<li><p>先开启驼峰命名自动映射</p></li>
<li><p>用 <code>Java</code> 代码实现分步查询：</p>
<ul>
<li><p>先写一个 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Order;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderCustomerStepMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户信息</span><br>    Customer <span class="hljs-title function_">getCustomerById</span><span class="hljs-params">(Long id)</span>;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户的订单信息</span><br>    List&lt;Order&gt; <span class="hljs-title function_">getOrdersByCustomerId</span><span class="hljs-params">(Long customerId)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再写一个 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderCustomerStepMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getCustomerById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span>&gt;</span><br>        select *<br>        from t_customer<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户的订单信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getOrdersByCustomerId&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span>&gt;</span><br>        select *<br>        from t_order<br>        where customer_id = #&#123;customerId&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Order;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.OrderCustomerStepMapper;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StepTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    OrderCustomerStepMapper orderCustomerStepMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test01</span><span class="hljs-params">()</span> &#123;<br><br>        <span class="hljs-comment">// 根据客户 id 查询客户信息</span><br>        <span class="hljs-type">Customer</span> <span class="hljs-variable">customer</span> <span class="hljs-operator">=</span> orderCustomerStepMapper.getCustomerById(<span class="hljs-number">1L</span>);<br><br>        <span class="hljs-comment">// 根据客户 id 查询客户的订单信息</span><br>        List&lt;Order&gt; orders = orderCustomerStepMapper.getOrdersByCustomerId(customer.getId());<br><br>        <span class="hljs-comment">// 组合到一起</span><br>        customer.setOrders(orders);<br><br>        System.out.println(<span class="hljs-string">&quot;customer = &quot;</span> + customer);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>上面的代码是 <code>Java</code> 代码的分步写法，并不是
<code>MyBatis</code> 的分步查询写法</p></li>
<li><p>下面再写 <code>MyBatis</code> 的分步查询写法：</p>
<ul>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Order;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderCustomerStepMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户信息</span><br>    Customer <span class="hljs-title function_">getCustomerById</span><span class="hljs-params">(Long id)</span>;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户的订单信息</span><br>    List&lt;Order&gt; <span class="hljs-title function_">getOrdersByCustomerId</span><span class="hljs-params">(Long customerId)</span>;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户信息和客户的订单信息</span><br>    Customer <span class="hljs-title function_">useStepGetCustomerAndOrdersById</span><span class="hljs-params">(Long customerId)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件：</p>
<ul>
<li><p>在 <code>collection</code> 标签中的 <code>select</code>
参数指定要调用的查询标签的全 <code>id</code>，即
<code>namespace + id</code></p></li>
<li><p>在 <code>collection</code> 标签中的 <code>column</code>
参数指定数据库返回结果中的一个字段名作为参数传给调用的查询标签（如果查询标签需要传一个参数）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderCustomerStepMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getCustomerById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span>&gt;</span><br>        select *<br>        from t_customer<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户的订单信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getOrdersByCustomerId&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span>&gt;</span><br>        select *<br>        from t_order<br>        where customer_id = #&#123;customerId&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;CustomerOrdersStepRM&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;customer_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customerName&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phone&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;phone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 参数 select 中填的是另一个查询标签的 id 其中 id 要写全，即 Mapper 的 &quot;namespace + id&quot; --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 但在调用查询标签进行查询时，要传一个参数，如何传？用 column 参数 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 参数 column 用于把指定的列名作为参数传给查询标签需要的参数 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 这里的 ofType 参数可以不写，因为 select 指定的查询标签已经有 resultMap 或者 resultType 了 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orders&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderCustomerStepMapper.getOrdersByCustomerId&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span></span><br><span class="hljs-tag">        &gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户信息和客户的订单信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;useStepGetCustomerAndOrdersById&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;CustomerOrdersStepRM&quot;</span>&gt;</span><br>        select *<br>        from t_customer<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>如果调用的查询标签有多个参数需要传，则用
<code>&#123;prop1=col1,prop2=col2&#125;</code> 作为 <code>column</code>
参数的值：</p></li>
<li><p>即
<code>Customer getCustomerById(@Param("cid") Long id, @Param("name") String name);</code>
对应的 <code>column</code> 是
<code>column="&#123;cid=id,name=customer_name&#125;"</code></p></li>
<li><p><code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Order;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderCustomerStepMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户信息</span><br>    Customer <span class="hljs-title function_">getCustomerById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;cid&quot;)</span> Long id, <span class="hljs-meta">@Param(&quot;name&quot;)</span> String name)</span>;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户的订单信息</span><br>    List&lt;Order&gt; <span class="hljs-title function_">getOrdersByCustomerId</span><span class="hljs-params">(Long customerId)</span>;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户信息和客户的订单信息</span><br>    Customer <span class="hljs-title function_">useStepGetCustomerAndOrdersById</span><span class="hljs-params">(Long customerId)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderCustomerStepMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getCustomerById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span>&gt;</span><br>        select *<br>        from t_customer<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户的订单信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getOrdersByCustomerId&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span>&gt;</span><br>        select *<br>        from t_order<br>        where customer_id = #&#123;customerId&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;CustomerOrdersStepRM&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;customer_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customerName&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phone&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;phone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 参数 select 中填的是另一个查询标签的 id 其中 id 要写全，即 Mapper 的 &quot;namespace + id&quot; --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 但在调用查询标签进行查询时，要传一个参数，如何传？用 column 参数 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 参数 column 用于把指定的列名作为参数传给查询标签需要的参数 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 这里的 ofType 参数可以不写，因为 select 指定的查询标签已经有 resultMap 或者 resultType 了 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orders&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderCustomerStepMapper.getOrdersByCustomerId&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;&#123;cid=id,name=customer_name&#125;&quot;</span></span><br><span class="hljs-tag">        &gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户信息和客户的订单信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;useStepGetCustomerAndOrdersById&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;CustomerOrdersStepRM&quot;</span>&gt;</span><br>        select *<br>        from t_customer<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.OrderCustomerStepMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StepTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    OrderCustomerStepMapper orderCustomerStepMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test02</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Customer</span> <span class="hljs-variable">customer</span> <span class="hljs-operator">=</span> orderCustomerStepMapper.useStepGetCustomerAndOrdersById(<span class="hljs-number">1L</span>);<br>        System.out.println(<span class="hljs-string">&quot;customer = &quot;</span> + customer);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h5 id="association-使用分步查询记录"><code>association</code>
使用分步查询记录</h5>
<ul>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Param;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Order;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderCustomerStepMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户信息</span><br>    Customer <span class="hljs-title function_">getCustomerById</span><span class="hljs-params">(Long id)</span>;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户的订单信息</span><br>    List&lt;Order&gt; <span class="hljs-title function_">getOrdersByCustomerId</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;customerId&quot;)</span> Long customerId)</span>;<br><br>    <span class="hljs-comment">// 根据客户 id 查询客户信息和客户的订单信息</span><br>    Customer <span class="hljs-title function_">useStepGetCustomerAndOrdersById</span><span class="hljs-params">(Long customerId)</span>;<br><br>    <span class="hljs-comment">// 根据 id 查定单信息，写单信息中有客户信息</span><br>    Order <span class="hljs-title function_">getOrderByIdAndCustomerStep</span><span class="hljs-params">(Long orderId)</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderCustomerStepMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getCustomerById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span>&gt;</span><br>        select *<br>        from t_customer<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户的订单信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getOrdersByCustomerId&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span>&gt;</span><br>        select *<br>        from t_order<br>        where customer_id = #&#123;customerId&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;CustomerOrdersStepRM&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;customer_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customerName&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phone&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;phone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 参数 select 中填的是另一个查询标签的 id 其中 id 要写全，即 Mapper 的 &quot;namespace + id&quot; --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 但在调用查询标签进行查询时，要传一个参数，如何传？用 column 参数 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 参数 column 用于把指定的列名作为参数传给查询标签需要的参数 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 这里的 ofType 参数可以不写，因为 select 指定的查询标签已经有 resultMap 或者 resultType 了 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orders&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderCustomerStepMapper.getOrdersByCustomerId&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span></span><br><span class="hljs-tag">        &gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据客户 id 查询客户信息和客户的订单信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;useStepGetCustomerAndOrdersById&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;CustomerOrdersStepRM&quot;</span>&gt;</span><br>        select *<br>        from t_customer<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;OrderCustomerStepRM&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;address&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;amount&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;amount&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;customer_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customerId&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 类似地，这里可以不用写 jdbcType 因为 select 查询标签有指定了 resultType --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customer&quot;</span></span><br><span class="hljs-tag">                     <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span></span><br><span class="hljs-tag">                     <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderCustomerStepMapper.getCustomerById&quot;</span></span><br><span class="hljs-tag">                     <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;customer_id&quot;</span></span><br><span class="hljs-tag">        &gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">association</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getOrderByIdAndCustomerStep&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;OrderCustomerStepRM&quot;</span>&gt;</span><br>        select *<br>        from t_order<br>        where id = #&#123;orderId&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Order;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.OrderCustomerStepMapper;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StepTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    OrderCustomerStepMapper orderCustomerStepMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test03</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Order</span> <span class="hljs-variable">orderByIdAndCustomerStep</span> <span class="hljs-operator">=</span> orderCustomerStepMapper.getOrderByIdAndCustomerStep(<span class="hljs-number">1L</span>);<br>        System.out.println(<span class="hljs-string">&quot;orderByIdAndCustomerStep = &quot;</span> + orderByIdAndCustomerStep);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h5 id="分步查询延迟加载记录">分步查询延迟加载记录</h5>
<ul>
<li><p>当调用有分步查询的标签时，每次都会进行分步查询，尽管不想用到分步查询的结果，也会分步查询</p></li>
<li><p>此时就可以用延迟加载指定只有需要用到分步查询的结果后才进行分步查询</p></li>
<li><p>比如，下面的测试程序就只是用到一个 <code>id</code>
属性，而进行了两次查询：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Order;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.OrderCustomerStepMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StepTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    OrderCustomerStepMapper orderCustomerStepMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test04</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Order</span> <span class="hljs-variable">orderByIdAndCustomerStep</span> <span class="hljs-operator">=</span> orderCustomerStepMapper.getOrderByIdAndCustomerStep(<span class="hljs-number">1L</span>);<br>        <span class="hljs-comment">// 此处只是用一下 id 属性，用不着进行分步查询</span><br>        System.out.println(orderByIdAndCustomerStep.getId());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>如何解决，在 <code>application.properties</code>
配置文件中添加如下配置：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># 开启 mybatis 懒加载</span><br><span class="hljs-attr">mybatis.configuration.lazy-loading-enabled</span>=<span class="hljs-string">true</span><br><span class="hljs-comment"># 是否立即懒加载，即立即加载，当然不用立即加载，否则就和没设置一样</span><br><span class="hljs-attr">mybatis.configuration.aggressive-lazy-loading</span>=<span class="hljs-string">false</span><br></code></pre></td></tr></table></figure></li>
<li><p>再运行测试程序，发现只查询了一次，没有进行分步查询，配置成功</p></li>
<li><p>那如果再需要用到分步后的结果，是什么效果？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Order;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.OrderCustomerStepMapper;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StepTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    OrderCustomerStepMapper orderCustomerStepMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test04</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-type">Order</span> <span class="hljs-variable">orderByIdAndCustomerStep</span> <span class="hljs-operator">=</span> orderCustomerStepMapper.getOrderByIdAndCustomerStep(<span class="hljs-number">1L</span>);<br>        <span class="hljs-comment">// 此处只是用一下 id 属性，用不着进行分步查询</span><br>        System.out.println(orderByIdAndCustomerStep.getId());<br><br>        Thread.sleep(<span class="hljs-number">3000</span>);<br><br>        <span class="hljs-type">Customer</span> <span class="hljs-variable">customer</span> <span class="hljs-operator">=</span> orderByIdAndCustomerStep.getCustomer();<br>        System.out.println(<span class="hljs-string">&quot;customer = &quot;</span> + customer);<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>发现结果是先查询一次数据库拿到 <code>id</code> 信息打印，后
<code>3</code> 秒又查了一次数据库拿到 <code>customer</code>
信息，这就是延迟加载</p></li>
<li><p>即用到时再查询数据</p></li>
</ul>
<h4 id="多对多查询结果封装记录">多对多查询结果封装记录</h4>
<ul>
<li><p>查询所有客户信息，其中每个客户信息都有所有的订单信息</p></li>
<li><p>编写 <code>Mapper</code> 接口，注意是
<code>CustomerMapper.java</code> 因为是查客户信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CustomerMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据 id 查询对应客户信息，其中客户类中有一个订单属性，订单属性类型为 List</span><br>    Customer <span class="hljs-title function_">getCustomerByIdWithOrders</span><span class="hljs-params">(Long id)</span>;<br>    <br>    <span class="hljs-comment">// 查询所有客户信息，并且每个客户信息都有所有的订单信息</span><br>    List&lt;Customer&gt; <span class="hljs-title function_">getAllCustomersAndOrders</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件，注意可以引用另一个
<code>mapper</code> 配置文件中的查询标签：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.CustomerMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;CutomerRM&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Customer&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;c_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;customer_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customerName&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phone&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;phone&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 使用 collection 来指明 一对N 的封装规则，即返回的是一个集合时用 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 参数 property 指定属性名 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 参数 ofType 指定集合中的类型 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orders&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Order&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;address&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;amount&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;amount&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>            <span class="hljs-comment">&lt;!-- 这个其实就是上面的 c_id 所以可以用 c_id 来代替 --&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;result column=&quot;customer_id&quot; property=&quot;customerId&quot;&gt;&lt;/result&gt;--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;c_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;customerId&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getCustomerByIdWithOrders&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;CutomerRM&quot;</span>&gt;</span><br>        select c.id c_id,<br>               c.customer_name,<br>               c.phone,<br>               o.*<br>        from t_customer c<br>                 left join t_order o on c.id = o.customer_id<br>        where c.id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAllCustomersAndOrders&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.OrderCustomerStepMapper.CustomerOrdersStepRM&quot;</span>&gt;</span><br>        select *<br>        from t_customer<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Customer;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.CustomerMapper;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StepTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    CustomerMapper customerMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test05</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Customer&gt; allCustomersAndOrders = customerMapper.getAllCustomersAndOrders();<br>        allCustomersAndOrders.forEach(System.out::println);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="自定义结果集总结记录">自定义结果集总结记录</h4>
<ul>
<li>在 <code>mapper</code> 配置文件中写一个 <code>resultMap</code>
标签，并指定 <code>id</code> 参数和 <code>type</code> 参数</li>
<li>在 <code>resultMap</code> 标签中，可以有
<code>id</code>、<code>result</code>、<code>collection</code>、<code>association</code>、<code>constructor</code>、<code>discriminator</code>
六个标签</li>
<li>对每个标签进行配置...</li>
<li>最后在查询标签中指定 <code>resultMap</code> 参数的值为上面的
<code>resultMap</code> 标签中的 <code>id</code> 参数的值</li>
<li>分步记得不要循环引用有 <code>select</code> 标签的
<code>resultMap</code></li>
</ul>
<h4 id="动态-sql-记录">动态 <code>SQL</code> 记录</h4>
<ul>
<li>根据不同条件运行不同的 <code>SQL</code> 语句，即为动态
<code>SQL</code></li>
</ul>
<h5 id="if-和-where-标签记录"><code>if</code> 和 <code>where</code>
标签记录</h5>
<ul>
<li><p>准备工作：</p>
<ul>
<li><p>编写 <code>JavaBean</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Emp</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String empName;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> Double empSalary;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Param;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpDynamicSQLMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据员工名和员工薪资查询员工信息</span><br>    List&lt;Emp&gt; <span class="hljs-title function_">getEmpByNameAndSalary</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;name&quot;)</span> String name,</span><br><span class="hljs-params">                                    <span class="hljs-meta">@Param(&quot;salary&quot;)</span> BigDecimal salary)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpByNameAndSalary&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        where emp_name = #&#123;name&#125;<br>          and emp_salary = #&#123;salary&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpDynamicSQLMapper;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicSQLTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpDynamicSQLMapper empDynamicSQLMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test01</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Emp&gt; emps = empDynamicSQLMapper.getEmpByNameAndSalary(<span class="hljs-string">&quot;tom&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">&quot;200.33000&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;tom = &quot;</span> + emps);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h6 id="if-标签记录"><code>if</code> 标签记录</h6>
<ul>
<li><p><code>if</code> 标签用于做条件判断，其中的 <code>test</code>
参数如果为真就拼接 <code>if</code>
标签中的内容，如果为假则不拼接</p></li>
<li><p>正常查询是没有问题，但如果在传参时，有一个参数为空，会发生什么？</p>
<ul>
<li><p>更改测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpDynamicSQLMapper;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicSQLTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpDynamicSQLMapper empDynamicSQLMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test01</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Emp&gt; emps = empDynamicSQLMapper.getEmpByNameAndSalary(<span class="hljs-string">&quot;tom&quot;</span>, <span class="hljs-literal">null</span>);<br>        System.out.println(<span class="hljs-string">&quot;tom = &quot;</span> + emps);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>再次测试发现 <code>sql</code> 语句中把 <code>null</code>
值给拼装进去了，即 <code>emp_salary = null</code></p></li>
<li><p>这样会查询数据库中 <code>emp_salary</code> 值为 <code>null</code>
的数据，并不是不查 <code>emp_salary</code> 字段的数据</p></li>
</ul></li>
<li><p>如果想要有 <code>emp_salary</code> 时就查，没有就只查
<code>emp_name</code> 该如何做？用动态 <code>SQL</code> 语句</p>
<ul>
<li><p>更改 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- if 标签用于做条件判断，其中的 test 参数如果为真就拼接 if 标签中的内容，如果为假则不拼接 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 name 不为 null 就拼接 emp_name = #&#123;name&#125; --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 salary 不为 null 就拼接 and emp_salary = #&#123;salary&#125; --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpByNameAndSalary&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        where<br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span><br>            emp_name = #&#123;name&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;salary != null&quot;</span>&gt;</span><br>            and emp_salary = #&#123;salary&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>再次运行测试程序，发现查询条件没有查 <code>emp_salary</code>
成功</p></li>
</ul></li>
</ul>
<h6 id="where-标签记录"><code>where</code> 标签记录</h6>
<ul>
<li><p><code>where</code> 标签用于解决多了 <code>and</code> 或者
<code>or</code> 或者 <code>where</code> 等的问题</p></li>
<li><p>上面的 <code>mapper</code> 配置文件代码有个问题，就是如果只传了
<code>salary</code> 参数，而没有传 <code>name</code> 属性，那
<code>SQL</code> 语句就会变成
<code>select * from t_emp where and emp_salary = #&#123;salary&#125;</code></p></li>
<li><p>并且还有一个问题就是如果两个参数都不传，那 <code>SQL</code>
语句就是 <code>select * from t_emp where</code></p></li>
<li><p>明显上面的 <code>SQL</code>
语句的语法都是错误的，可以用以下的方法解决，加个 <code>1=1</code>
再在后面的条件加一个 <code>and</code>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- if 标签用于做条件判断，其中的 test 参数如果为真就拼接 if 标签中的内容，如果为假则不拼接 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 name 不为 null 就拼接 emp_name = #&#123;name&#125; --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 salary 不为 null 就拼接 and emp_salary = #&#123;salary&#125; --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpByNameAndSalary&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        where 1=1<br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span><br>            and emp_name = #&#123;name&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;salary != null&quot;</span>&gt;</span><br>            and emp_salary = #&#123;salary&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>也可以用 <code>where</code> 标签进行解决：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- if 标签用于做条件判断，其中的 test 参数如果为真就拼接 if 标签中的内容，如果为假则不拼接 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 name 不为 null 就拼接 emp_name = #&#123;name&#125; --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 salary 不为 null 就拼接 and emp_salary = #&#123;salary&#125; --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpByNameAndSalary&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span><br>                emp_name = #&#123;name&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;salary != null&quot;</span>&gt;</span><br>                and emp_salary = #&#123;salary&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h5 id="set-标签记录"><code>set</code> 标签记录</h5>
<ul>
<li><p>ff</p></li>
<li><p>编写更新员工的代码：</p>
<ul>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Param;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpDynamicSQLMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据员工名和员工薪资查询员工信息</span><br>    List&lt;Emp&gt; <span class="hljs-title function_">getEmpByNameAndSalary</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;name&quot;)</span> String name,</span><br><span class="hljs-params">                                    <span class="hljs-meta">@Param(&quot;salary&quot;)</span> BigDecimal salary)</span>;<br><br>    <span class="hljs-comment">// 根据 id 更新员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmp</span><span class="hljs-params">(Emp emp)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- if 标签用于做条件判断，其中的 test 参数如果为真就拼接 if 标签中的内容，如果为假则不拼接 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 name 不为 null 就拼接 emp_name = #&#123;name&#125; --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 salary 不为 null 就拼接 and emp_salary = #&#123;salary&#125; --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpByNameAndSalary&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span><br>                emp_name = #&#123;name&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;salary != null&quot;</span>&gt;</span><br>                and emp_salary = #&#123;salary&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateEmp&quot;</span>&gt;</span><br>        update t_emp<br>        set emp_name   = #&#123;empName&#125;,<br>            emp_salary = #&#123;empSalary&#125;,<br>            age        = #&#123;age&#125;<br>        where id = #&#123;id&#125;<br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpDynamicSQLMapper;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicSQLTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpDynamicSQLMapper empDynamicSQLMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test02</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>        emp.setId(<span class="hljs-number">6</span>);<br>        emp.setEmpName(<span class="hljs-string">&quot;wangliu&quot;</span>);<br>        emp.setAge(<span class="hljs-number">20</span>);<br>        emp.setEmpSalary(<span class="hljs-number">10000.0</span>);<br><br>        empDynamicSQLMapper.updateEmp(emp);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>能够正常更新数据库中的数据</p></li>
<li><p>但上面的代码有一个问题，就是如果在更新数据时，更新的对象中的属性不传则数据库中的数据会为空</p></li>
<li><p>解决方法可以用 <code>if</code>
标签，但是会出现一个新的问题，即如果前面传后面不传就会多个逗号：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateEmp&quot;</span>&gt;</span><br>        update t_emp<br>        set<br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;empName != null&quot;</span>&gt;</span><br>            emp_name = #&#123;empName&#125;,<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;empSalary != null&quot;</span>&gt;</span><br>            emp_salary = #&#123;empSalary&#125;,<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;age != null&quot;</span>&gt;</span><br>            age = #&#123;age&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>此时到了用 <code>set</code> 标签的时候了：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- if 标签用于做条件判断，其中的 test 参数如果为真就拼接 if 标签中的内容，如果为假则不拼接 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 name 不为 null 就拼接 emp_name = #&#123;name&#125; --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 salary 不为 null 就拼接 and emp_salary = #&#123;salary&#125; --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpByNameAndSalary&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span><br>                emp_name = #&#123;name&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;salary != null&quot;</span>&gt;</span><br>                and emp_salary = #&#123;salary&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateEmp&quot;</span>&gt;</span><br>        update t_emp<br>        <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;empName != null&quot;</span>&gt;</span><br>                emp_name = #&#123;empName&#125;,<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;empSalary != null&quot;</span>&gt;</span><br>                emp_salary = #&#123;empSalary&#125;,<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;age != null&quot;</span>&gt;</span><br>                age = #&#123;age&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span><br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h5 id="trim-标签记录"><code>trim</code> 标签记录</h5>
<ul>
<li><p><code>trim</code> 标签用于自定义截串规则，可以替换
<code>where</code> 和 <code>set</code> 标签</p></li>
<li><p>有四个参数：</p>
<ul>
<li><p><code>prefix</code>：添加一个前缀，如果在 <code>trim</code>
标签体中有代码就加一个前缀</p></li>
<li><p><code>suffix</code>：添加一个后缀，如果在 <code>trim</code>
标签体中有代码就加一个后缀</p></li>
<li><p><code>prefixOverrides</code>：如果以指定字符串为前缀，则替换成空字符串</p></li>
<li><p><code>suffixOverrides</code>：如果以指定字符串为后缀，则替换成空字符串</p></li>
</ul></li>
<li><p>比如上面的 <code>where</code> 标签可以用 <code>trim</code>
替代，配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- if 标签用于做条件判断，其中的 test 参数如果为真就拼接 if 标签中的内容，如果为假则不拼接 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 name 不为 null 就拼接 emp_name = #&#123;name&#125; --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 如果 salary 不为 null 就拼接 and emp_salary = #&#123;salary&#125; --&gt;</span><br>    <span class="hljs-comment">&lt;!--&lt;select id=&quot;getEmpByNameAndSalary&quot; resultType=&quot;org.wind.mybatis.bean.Emp&quot;&gt;</span><br><span class="hljs-comment">        select *</span><br><span class="hljs-comment">        from t_emp</span><br><span class="hljs-comment">        &lt;where&gt;</span><br><span class="hljs-comment">            &lt;if test=&quot;name != null&quot;&gt;</span><br><span class="hljs-comment">                emp_name = #&#123;name&#125;</span><br><span class="hljs-comment">            &lt;/if&gt;</span><br><span class="hljs-comment">            &lt;if test=&quot;salary != null&quot;&gt;</span><br><span class="hljs-comment">                and emp_salary = #&#123;salary&#125;</span><br><span class="hljs-comment">            &lt;/if&gt;</span><br><span class="hljs-comment">        &lt;/where&gt;</span><br><span class="hljs-comment">    &lt;/select&gt;--&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 如果 if 标签成立，则 trim 标签体有内容，加一个前缀 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 但在加前缀之前，还要判断是否有 and 或者 or 在开头，如果有，则替换为空字符串 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpByNameAndSalary&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>        <span class="hljs-tag">&lt;<span class="hljs-name">trim</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">&quot;where&quot;</span> <span class="hljs-attr">prefixOverrides</span>=<span class="hljs-string">&quot;and|or&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span><br>                emp_name = #&#123;name&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;salary != null&quot;</span>&gt;</span><br>                and emp_salary = #&#123;salary&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">trim</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--&lt;update id=&quot;updateEmp&quot;&gt;</span><br><span class="hljs-comment">        update t_emp</span><br><span class="hljs-comment">        &lt;set&gt;</span><br><span class="hljs-comment">            &lt;if test=&quot;empName != null&quot;&gt;</span><br><span class="hljs-comment">                emp_name = #&#123;empName&#125;,</span><br><span class="hljs-comment">            &lt;/if&gt;</span><br><span class="hljs-comment">            &lt;if test=&quot;empSalary != null&quot;&gt;</span><br><span class="hljs-comment">                emp_salary = #&#123;empSalary&#125;,</span><br><span class="hljs-comment">            &lt;/if&gt;</span><br><span class="hljs-comment">            &lt;if test=&quot;age != null&quot;&gt;</span><br><span class="hljs-comment">                age = #&#123;age&#125;</span><br><span class="hljs-comment">            &lt;/if&gt;</span><br><span class="hljs-comment">        &lt;/set&gt;</span><br><span class="hljs-comment">        where id = #&#123;id&#125;</span><br><span class="hljs-comment">    &lt;/update&gt;--&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateEmp&quot;</span>&gt;</span><br>        update t_emp<br>        <span class="hljs-tag">&lt;<span class="hljs-name">trim</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">&quot;set&quot;</span> <span class="hljs-attr">suffixOverrides</span>=<span class="hljs-string">&quot;,&quot;</span> <span class="hljs-attr">suffix</span>=<span class="hljs-string">&quot;where id = #&#123;id&#125;&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;empName != null&quot;</span>&gt;</span><br>                emp_name = #&#123;empName&#125;,<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;empSalary != null&quot;</span>&gt;</span><br>                emp_salary = #&#123;empSalary&#125;,<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;age != null&quot;</span>&gt;</span><br>                age = #&#123;age&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">trim</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h5 id="choose-和-when-和-otherwise-标签记录"><code>choose</code> 和
<code>when</code> 和 <code>otherwise</code> 标签记录</h5>
<ul>
<li><p>类似于 <code>Java</code> 中的
<code>switch...case...default...</code></p></li>
<li><p>在多个标签分支中选一个</p></li>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Param;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpDynamicSQLMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据员工名或者员工薪资查询员工信息</span><br>    List&lt;Emp&gt; <span class="hljs-title function_">getEmpByNameOrSalary</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;name&quot;)</span> String name,</span><br><span class="hljs-params">                                   <span class="hljs-meta">@Param(&quot;salary&quot;)</span> BigDecimal salary)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 根据员工名或者员工薪资查询员工信息 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 当 name 不为空时走第一个分支 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 当 salary 大于 3000 时走第二个分支 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 否则走第三个分支，即查询 id 为 1 的员工的信息 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpByNameOrSalary&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select * from t_emp<br>        <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">choose</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">when</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span><br>                    emp_name = #&#123;name&#125;<br>                <span class="hljs-tag">&lt;/<span class="hljs-name">when</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">when</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;salary &gt; 3000&quot;</span>&gt;</span><br>                    emp_salary = #&#123;salary&#125;<br>                <span class="hljs-tag">&lt;/<span class="hljs-name">when</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">otherwise</span>&gt;</span><br>                    id = 1<br>                <span class="hljs-tag">&lt;/<span class="hljs-name">otherwise</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">choose</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpDynamicSQLMapper;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicSQLTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpDynamicSQLMapper empDynamicSQLMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test03</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Emp&gt; jerry = empDynamicSQLMapper.getEmpByNameOrSalary(<span class="hljs-string">&quot;jerry&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">&quot;100&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;jerry = &quot;</span> + jerry);<br>        List&lt;Emp&gt; jerry1 = empDynamicSQLMapper.getEmpByNameOrSalary(<span class="hljs-string">&quot;jerry&quot;</span>, <span class="hljs-literal">null</span>);<br>        System.out.println(<span class="hljs-string">&quot;jerry1 = &quot;</span> + jerry1);<br>        List&lt;Emp&gt; empByNameOrSalary = empDynamicSQLMapper.getEmpByNameOrSalary(<span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">&quot;5000&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;empByNameOrSalary = &quot;</span> + empByNameOrSalary);<br>        List&lt;Emp&gt; empByNameOrSalary1 = empDynamicSQLMapper.getEmpByNameOrSalary(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>        System.out.println(<span class="hljs-string">&quot;empByNameOrSalary1 = &quot;</span> + empByNameOrSalary1);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h5 id="foreach-标签记录"><code>foreach</code> 标签记录</h5>
<ul>
<li><p>用于遍历添加 <code>SQL</code> 语句</p></li>
<li><p>有一个情况，就是如果要查询指定的 <code>id</code>
集合中的员工信息，集合长度未知，如何写 <code>SQL</code>
语句，此时就要用到 <code>foreach</code> 标签了</p></li>
<li><p><code>foreach</code> 标签可以用于遍历集合</p></li>
<li><p>其中的：</p>
<ul>
<li>参数 <code>collection</code> 用于指定集合名</li>
<li>参数 <code>item</code> 用于指定每个取到的集合元素</li>
<li>参数 <code>separator</code> 用于指定参数间的分割符</li>
<li>参数 <code>opne</code> 用于指定遍历前缀</li>
<li>参数 <code>close</code> 用于指定遍历后缀</li>
</ul></li>
<li><p>写一个批量查询员工信息：</p>
<ul>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpDynamicSQLMapper</span> &#123;<br><br>    <span class="hljs-comment">// 查询 id 集合中的所有员工信息</span><br>    List&lt;Emp&gt; <span class="hljs-title function_">getEmpsByIdList</span><span class="hljs-params">(List&lt;Integer&gt; ids)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- collection 参数指定要遍历的对象名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- item 参数指定每次遍历的元素名 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- separator 参数指定元素间的分割符 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 用 #&#123;元素名&#125; 取出元素 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpsByIdList&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select * from t_emp where id in (<br>        <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;ids&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;,&quot;</span>&gt;</span><br>            #&#123;id&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br>        )<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpDynamicSQLMapper;<br><br><span class="hljs-keyword">import</span> java.util.Arrays;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicSQLTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpDynamicSQLMapper empDynamicSQLMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test04</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// Preparing: select * from t_emp where id in ( ? , ? , ? , ? , ? )</span><br>        <span class="hljs-comment">// Parameters: 1(Integer), 2(Integer), 3(Integer), 4(Integer), 5(Integer)</span><br>        empDynamicSQLMapper.getEmpsByIdList(Arrays.asList(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)).forEach(System.out::println);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>为了防止集合为空，可以加一个 <code>if</code>
标签进行判断</p></li>
</ul></li>
<li><p>再写一个批量添加员工信息：</p>
<ul>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpDynamicSQLMapper</span> &#123;<br><br>    <span class="hljs-comment">// 批量添加员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmpInfos</span><span class="hljs-params">(List&lt;Emp&gt; empList)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code>
配置文件：遍历中的元素如果是一个对象，取其中的属性值时要用
<code>对象.属性</code> 进行取值</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 注意：这里的取属性要用 对象.属性 取 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addEmpInfos&quot;</span>&gt;</span><br>        insert into t_emp(emp_name, age, emp_salary)<br>        values<br>        <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;empList&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;emp&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;,&quot;</span>&gt;</span><br>            (#&#123;emp.empName&#125;, #&#123;emp.age&#125;, #&#123;emp.empSalary&#125;)<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpDynamicSQLMapper;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicSQLTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpDynamicSQLMapper empDynamicSQLMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test05</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Emp&gt; emps = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>            <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>            emp.setEmpName(<span class="hljs-string">&quot;zhang&quot;</span> + i);<br>            emp.setAge(<span class="hljs-number">20</span> + i);<br>            emp.setEmpSalary(<span class="hljs-number">3000.0D</span> + i);<br>            emps.add(emp);<br>        &#125;<br><br>        <span class="hljs-comment">// 批量添加员工信息</span><br>        empDynamicSQLMapper.addEmpInfos(emps);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>再写一个批量修改员工信息：</p>
<ul>
<li><p>编写 <code>Mapper</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpDynamicSQLMapper</span> &#123;<br><br>    <span class="hljs-comment">// 批量修改员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmpsInList</span><span class="hljs-params">(List&lt;Emp&gt; emps)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>mapper</code> 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateEmpsInList&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;emps&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;emp&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;;&quot;</span>&gt;</span><br>            update t_emp<br>            <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;emp.empName != null&quot;</span>&gt;</span><br>                    emp_name = #&#123;emp.empName&#125;,<br>                <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;emp.empSalary != null&quot;</span>&gt;</span><br>                    emp_salary = #&#123;emp.empSalary&#125;,<br>                <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;emp.age != null&quot;</span>&gt;</span><br>                    age = #&#123;emp.age&#125;<br>                <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span><br>            where id = #&#123;emp.id&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpDynamicSQLMapper;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicSQLTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpDynamicSQLMapper empDynamicSQLMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test06</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Emp&gt; emps = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>            <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>            emp.setId(i + <span class="hljs-number">8</span>);<br>            emp.setEmpName(<span class="hljs-string">&quot;lisi&quot;</span> + i);<br>            emp.setAge(<span class="hljs-number">18</span> + i);<br>            emp.setEmpSalary(<span class="hljs-number">10000.0D</span> + i * <span class="hljs-number">10</span>);<br>            emps.add(emp);<br>        &#125;<br><br>        <span class="hljs-comment">// Preparing: update t_emp SET emp_name = ?, emp_salary = ?, age = ? where id = ? ;</span><br>        <span class="hljs-comment">// update t_emp SET emp_name = ?, emp_salary = ?, age = ? where id = ? ;</span><br>      	<span class="hljs-comment">// ...</span><br>        empDynamicSQLMapper.updateEmpsInList(emps);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>可以发现 <code>SQL</code> 语句并没有问题，但是还是发生了
<code>java.sql.SQLSyntaxErrorException</code> 异常，因为数据库不支持多个
<code>;</code> 的 <code>SQL</code> 语句</p></li>
<li><p>在 <code>application.properties</code>
配置数据库源的时候加一个参数：<code>allowMultiQueries=true</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.datasource.url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/mybatis-example?allowMultiQueries=true</span><br></code></pre></td></tr></table></figure></li>
<li><p>再次测试，成功修改数据库中的数据</p></li>
</ul></li>
</ul>
<h5 id="批量-sql-事务记录">批量 <code>SQL</code> 事务记录</h5>
<ul>
<li><p>在主程序上开启事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;<br><br><span class="hljs-meta">@EnableTransactionManagement</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisHelloworldApplication</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(MybatisHelloworldApplication.class, args);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>在 <code>Mapper</code> 接口上的方法上开启事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Param;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpDynamicSQLMapper</span> &#123;<br><br>    <span class="hljs-comment">// 根据员工名和员工薪资查询员工信息</span><br>    List&lt;Emp&gt; <span class="hljs-title function_">getEmpByNameAndSalary</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;name&quot;)</span> String name,</span><br><span class="hljs-params">                                    <span class="hljs-meta">@Param(&quot;salary&quot;)</span> BigDecimal salary)</span>;<br><br>    <span class="hljs-comment">// 根据 id 更新员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmp</span><span class="hljs-params">(Emp emp)</span>;<br><br>    <span class="hljs-comment">// 根据员工名或者员工薪资查询员工信息</span><br>    List&lt;Emp&gt; <span class="hljs-title function_">getEmpByNameOrSalary</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;name&quot;)</span> String name,</span><br><span class="hljs-params">                                   <span class="hljs-meta">@Param(&quot;salary&quot;)</span> BigDecimal salary)</span>;<br><br>    <span class="hljs-comment">// 查询 id 集合中的所有员工信息</span><br>    List&lt;Emp&gt; <span class="hljs-title function_">getEmpsByIdList</span><span class="hljs-params">(List&lt;Integer&gt; ids)</span>;<br><br>    <span class="hljs-comment">// 批量添加员工信息</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addEmpInfos</span><span class="hljs-params">(List&lt;Emp&gt; empList)</span>;<br><br>    <span class="hljs-comment">// 批量修改员工信息</span><br>    <span class="hljs-meta">@Transactional</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmpsInList</span><span class="hljs-params">(List&lt;Emp&gt; emps)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写一个 <code>Service</code> 用于模拟异常：</p>
<ul>
<li><p>接口 <code>EmpService</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.service;<br><br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpService</span> &#123;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateBatch</span><span class="hljs-params">(List&lt;Emp&gt; emps)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>实现类 <code>EmpServiceImpl</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.service.impl;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpDynamicSQLMapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.service.EmpService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmpServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmpService</span> &#123;<br><br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpDynamicSQLMapper empDynamicSQLMapper;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-meta">@Transactional</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateBatch</span><span class="hljs-params">(List&lt;Emp&gt; emps)</span> &#123;<br>        empDynamicSQLMapper.updateEmpsInList(emps);<br>        <span class="hljs-comment">// 模拟异常</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> / <span class="hljs-number">0</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.service.EmpService;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicSQLTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpService empService;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test07</span><span class="hljs-params">()</span> &#123;<br>        List&lt;Emp&gt; emps = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>            <span class="hljs-type">Emp</span> <span class="hljs-variable">emp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>();<br>            emp.setId(i + <span class="hljs-number">8</span>);<br>            emp.setEmpName(<span class="hljs-string">&quot;lisi&quot;</span> + i);<br>            emp.setAge(<span class="hljs-number">18</span> + i);<br>            emp.setEmpSalary(<span class="hljs-number">10000.0D</span> + i * <span class="hljs-number">10</span>);<br>            emps.add(emp);<br>        &#125;<br>        empService.updateBatch(emps);<br>        System.out.println(<span class="hljs-string">&quot;批量更新完成&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>测试发现事务正常回滚</p></li>
<li><p>注意：如果在分布式项目情况下，分布式事务很多不支持多
<code>SQL</code> 批量操作的回滚</p></li>
</ul>
<h5 id="mybatis-的-sql-片段记录"><code>MyBatis</code> 的
<code>SQL</code> 片段记录</h5>
<ul>
<li><p><a
target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/sqlmap-xml.html#sql">官方文档</a></p></li>
<li><p><code>SQL Fragment</code> 即可复用的 <code>SQL</code> 片段，用
<code>sql</code> 标签定义，用 <code>include</code> 标签引用</p></li>
<li><p>比如，如果不开启驼峰命名自动映射功能，则需要手写多个标签的对应的字段名，此时可以用
<code>SQL</code> 片段解决：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpDynamicSQLMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 如果不开启驼峰自动映射功能，也可以用 sql fragment 方法 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">sql</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;column_names&quot;</span>&gt;</span><br>        id, emp_name empName, age, emp_salary empSalary<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">sql</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 在需要用到 sql fragment 的地方用 include 标签进行引用 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpByNameAndSalary&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select<br>        <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;column_names&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>        from t_emp<br>        <span class="hljs-tag">&lt;<span class="hljs-name">trim</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">&quot;where&quot;</span> <span class="hljs-attr">prefixOverrides</span>=<span class="hljs-string">&quot;and|or&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name != null&quot;</span>&gt;</span><br>                emp_name = #&#123;name&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;salary != null&quot;</span>&gt;</span><br>                and emp_salary = #&#123;salary&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">trim</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>即用 <code>sql</code> 标签定义片段，用 <code>include</code>
标签进行引用</p></li>
</ul>
<h4 id="在-xml-文件中的转义字符记录">在 <code>XML</code>
文件中的转义字符记录</h4>
<ul>
<li><p>在写 <code>mapper</code> 配置文件时，因为用的是 <code>xml</code>
进行配置，所以想写一些 <code>sql</code> 语句会有问题，比如小于号
<code>&lt;</code></p></li>
<li><p>此时就要用在 <code>xml</code> 中对应的转义字符：</p>
<table>
<thead>
<tr>
<th>原字符</th>
<th>对应的转义字符</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&amp;</code></td>
<td><code>&amp;amp;</code></td>
</tr>
<tr>
<td><code>&lt;</code></td>
<td><code>&amp;lt;</code></td>
</tr>
<tr>
<td><code>&gt;</code></td>
<td><code>&amp;gt;</code></td>
</tr>
<tr>
<td><code>"</code></td>
<td><code>&amp;quot;</code></td>
</tr>
<tr>
<td><code>'</code></td>
<td><code>&amp;apos;</code></td>
</tr>
</tbody>
</table></li>
</ul>
<h4 id="缓存机制记录">缓存机制记录</h4>
<ul>
<li>为什么要有缓存，为了提升访问效率，就像 CPU 缓存 -&gt; 一级缓存 -&gt;
二级缓存 -&gt; 三级缓存 -&gt; 内存 -&gt; 硬盘的关系一样</li>
<li>如果缓存中没有，到数据库查询原始数据，称为【回源】</li>
<li><code>MyBatis</code> 有二级缓存机制
<ul>
<li>默认开启的是一级缓存，事务级别是当前事务共享</li>
<li>二级缓存需要手动开启，事务级别是所有事务共享</li>
<li>一级缓存一般讨论的是同一个事务的多次相同的查询</li>
<li>而二级缓存一般讨论的是不同事务的相同的查询</li>
</ul></li>
<li><code>MyBatis</code>
默认从二级缓存中取数据（如果二级缓存中有数据），因为事务刚开始，一级缓存一般都没有缓存数据，这一点与
CPU 缓存不一样</li>
<li>可以用 <code>Redis</code> 等进行替代方案</li>
</ul>
<h5 id="mybatis-的一级缓存记录"><code>MyBatis</code> 的一级缓存记录</h5>
<ul>
<li><p>编写 <code>Service</code> 用于进行测试：</p>
<ul>
<li><p>接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.service;<br><br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpService</span> &#123;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateBatch</span><span class="hljs-params">(List&lt;Emp&gt; emps)</span>;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">getEmp</span><span class="hljs-params">()</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>实现类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.service.impl;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpDynamicSQLMapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpMapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.service.EmpService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmpServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmpService</span> &#123;<br><br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpDynamicSQLMapper empDynamicSQLMapper;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpMapper empMapper;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-meta">@Transactional</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateBatch</span><span class="hljs-params">(List&lt;Emp&gt; emps)</span> &#123;<br>        empDynamicSQLMapper.updateEmpsInList(emps);<br>        <span class="hljs-comment">// 模拟异常</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> / <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Transactional</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getEmp</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 第一次查 id 为 1 的员工</span><br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">empById</span> <span class="hljs-operator">=</span> empMapper.getEmpById(<span class="hljs-number">1</span>);<br>        System.out.println(<span class="hljs-string">&quot;empById = &quot;</span> + empById);<br><br>        System.out.println(<span class="hljs-string">&quot;do other .....................&quot;</span>);<br><br>        <span class="hljs-comment">// 第二次查 id 为 2 的员工</span><br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">empById1</span> <span class="hljs-operator">=</span> empMapper.getEmpById(<span class="hljs-number">1</span>);<br>        System.out.println(<span class="hljs-string">&quot;empById1 = &quot;</span> + empById1);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>编写测试程序进行测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.service.EmpService;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpService empService;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test01</span><span class="hljs-params">()</span> &#123;<br>        empService.getEmp();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>可以看到在控制台中只发了一次 <code>SQL</code>
查询，所以证明有缓存</p></li>
<li><p>即在开启事务时，会开启事务级别缓存，同一条语句的多次查询会从缓存中取数据，不会进行多次的查询</p></li>
<li><p>不开启事务，再进行测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.service.impl;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpDynamicSQLMapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpMapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.service.EmpService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmpServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmpService</span> &#123;<br><br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpDynamicSQLMapper empDynamicSQLMapper;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpMapper empMapper;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-meta">@Transactional</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateBatch</span><span class="hljs-params">(List&lt;Emp&gt; emps)</span> &#123;<br>        empDynamicSQLMapper.updateEmpsInList(emps);<br>        <span class="hljs-comment">// 模拟异常</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> / <span class="hljs-number">0</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getEmp</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 第一次查 id 为 1 的员工</span><br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">empById</span> <span class="hljs-operator">=</span> empMapper.getEmpById(<span class="hljs-number">1</span>);<br>        System.out.println(<span class="hljs-string">&quot;empById = &quot;</span> + empById);<br><br>        System.out.println(<span class="hljs-string">&quot;do other .....................&quot;</span>);<br><br>        <span class="hljs-comment">// 第二次查 id 为 2 的员工</span><br>        <span class="hljs-type">Emp</span> <span class="hljs-variable">empById1</span> <span class="hljs-operator">=</span> empMapper.getEmpById(<span class="hljs-number">1</span>);<br>        System.out.println(<span class="hljs-string">&quot;empById1 = &quot;</span> + empById1);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>发现会进行两次查询</p></li>
<li><p>这是因为在开启了事务后，默认的事务隔离级别是可重复读，所以同一语句的多次查询就从缓存中取</p></li>
<li><p>注意，并不是同一语句的多次查询就一定会从缓存中取，也会有缓存失效的情况</p>
<ul>
<li>两次查询的内容不一样（当然不会从缓存中拿，因为缓存中没有）</li>
<li>如果在两次查询之间，进行了一次增删改，则会重新进行一次查询，不从缓存中取</li>
</ul></li>
</ul>
<h5 id="mybatis-的二级缓存记录"><code>MyBatis</code> 的二级缓存记录</h5>
<ul>
<li><p>两个事务如果不开二级缓存，则默认用的是一级缓存，即使两个事务查询的是同一个员工信息，也会查询两次数据库</p></li>
<li><p>如果开启二级缓存，则在一个事务结束后，把结果放到二级缓存中，如果别的事务有相同一个查询，则直接从二级缓存中取</p></li>
<li><p><code>MyBatis</code>
是用序列化对对象进行缓存的，所以要被缓存的对象必须实现序列化接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.bean;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Emp</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String empName;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> Double empSalary;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>如何开启二级缓存，在要被缓存的对象实现序列化接口，然后在
<code>mapper</code> 配置文件中加一个 <code>cache</code> 标签即为开启</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.wind.mybatis.mapper.EmpMapper&quot;</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">cache</span>/&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getEmpById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select id, emp_name empName, age, emp_salary empSalary<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAllEmp&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;org.wind.mybatis.bean.Emp&quot;</span>&gt;</span><br>        select *<br>        from t_emp<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addEmp&quot;</span> <span class="hljs-attr">useGeneratedKeys</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><br>        insert into t_emp(emp_name, age, emp_salary)<br>        values (#&#123;empName&#125;, #&#123;age&#125;, #&#123;empSalary&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateEmp&quot;</span>&gt;</span><br>        update t_emp<br>        set emp_name   = #&#123;empName&#125;,<br>            age        = #&#123;age&#125;,<br>            emp_salary = #&#123;empSalary&#125;<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteEmpById&quot;</span>&gt;</span><br>        delete<br>        from t_emp<br>        where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>再次运行测试程序，有个缓存命中率为
<code>0.5</code>，因为测试程序进行了两次相同的查询有一次是从缓存中取，所以命中率为
<code>1/2</code> 即 <code>0.5</code></p></li>
</ul>
<h4 id="插件机制记录">插件机制记录</h4>
<ul>
<li><p><a
target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/configuration.html#plugins">官方文档</a></p></li>
<li><p><code>MyBatis</code> 用拦截器机制提供插件功能，方便在
<code>SQL</code> 语句执行的前后进行拦截处理</p></li>
<li><p>在 <code>org.apache.ibatis.plugin</code> 包下可以看到拦截器接口
<code>Interceptor</code></p></li>
<li><p>拦截器可以拦截以下对象的执行：</p>
<ul>
<li>Executor (update, query, flushStatements, commit, rollback,
getTransaction, close, isClosed)：执行器，执行 <code>SQL</code>
语句</li>
<li>ParameterHandler (getParameterObject,
setParameters)：参数处理器，处理 <code>SQL</code> 的参数对象</li>
<li>ResultSetHandler (handleResultSets,
handleOutputParameters)：结果集处理器，处理 <code>SQL</code>
的返回结果集</li>
<li>StatementHandler (prepare, parameterize, batch, update,
query)：查询语句处理器，处理 <code>SQL</code> 语句</li>
</ul></li>
<li><p>插件有很多，比如分页插件 <a
target="_blank" rel="noopener" href="https://pagehelper.github.io/docs/howtouse/">PageHelper</a></p></li>
<li><p>使用 PageHelper 实验，<a
target="_blank" rel="noopener" href="https://pagehelper.github.io/docs/howtouse/">官方文档</a></p>
<ul>
<li><p>在 <code>pom.xml</code> 中引入依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.pagehelper<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>pagehelper<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>6.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>配置拦截器插件，这里选择 <code>Spring</code> 方法，即添加一个
<code>Bean</code> 到容器中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.config;<br><br><span class="hljs-keyword">import</span> com.github.pagehelper.PageInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyBatisConfig</span> &#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    PageInterceptor <span class="hljs-title function_">pageInterceptor</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 创建分页插件对象</span><br>        <span class="hljs-type">PageInterceptor</span> <span class="hljs-variable">pageInterceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageInterceptor</span>();<br><br>        <span class="hljs-comment">// 放到容器中</span><br>        <span class="hljs-keyword">return</span> pageInterceptor;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写 <code>Service</code>：</p>
<ul>
<li><p>接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.service;<br><br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmpService</span> &#123;<br><br>    List&lt;Emp&gt; <span class="hljs-title function_">getAllEmp</span><span class="hljs-params">()</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>实现类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.service.impl;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.mapper.EmpMapper;<br><span class="hljs-keyword">import</span> org.wind.mybatis.service.EmpService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmpServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmpService</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpMapper empMapper;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> List&lt;Emp&gt; <span class="hljs-title function_">getAllEmp</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> empMapper.getAllEmp();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>编写测试程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> com.github.pagehelper.PageHelper;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.service.EmpService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpService empService;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test01</span><span class="hljs-params">()</span> &#123;<br>        PageHelper.startPage(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">// 第 1 页，每页有 5 个</span><br>        <span class="hljs-comment">// 紧跟着 startPage 之后的方法就会用分页查询</span><br>        List&lt;Emp&gt; allEmp = empService.getAllEmp();<br>        <span class="hljs-keyword">for</span> (Emp emp : allEmp) &#123;<br>            System.out.println(emp);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
<li><p>其查询用到了 <code>ThreadLocal</code> 所以在
<code>PageHelper</code>
中的方法执行后的一条查询就分页，而其它的查询不分页</p></li>
<li><p>前端在用的时候一般需要以下的信息返回：</p>
<ul>
<li>总页码，总记录数</li>
<li>当前页码</li>
<li>当前页数据</li>
</ul></li>
<li><p>先编写一个测试程序测试一下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis;<br><br><span class="hljs-keyword">import</span> com.github.pagehelper.PageHelper;<br><span class="hljs-keyword">import</span> com.github.pagehelper.PageInfo;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.service.EmpService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpService empService;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test02</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 开启分页</span><br>        PageHelper.startPage(pageNum, <span class="hljs-number">10</span>);<br>        <br>        List&lt;Emp&gt; allEmp = empService.getAllEmp();<br>        System.out.println(<span class="hljs-string">&quot;=========================&quot;</span>);<br>        PageInfo&lt;Emp&gt; info = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageInfo</span>&lt;&gt;(allEmp);<br><br>        <span class="hljs-comment">// 当前页</span><br>        System.out.println(<span class="hljs-string">&quot;当前页码 = &quot;</span> + info.getPageNum());<br>        <span class="hljs-comment">// 总页码</span><br>        System.out.println(<span class="hljs-string">&quot;总页码 = &quot;</span> + info.getPages());<br>        <span class="hljs-comment">// 总记录</span><br>        System.out.println(<span class="hljs-string">&quot;总记录数 = &quot;</span> + info.getTotal());<br>        <span class="hljs-comment">// 有没有下一页</span><br>        System.out.println(<span class="hljs-string">&quot;有没有下一页 = &quot;</span> + info.isHasNextPage());<br>        <span class="hljs-comment">// 有没有上一页</span><br>        System.out.println(<span class="hljs-string">&quot;有没有上一页 = &quot;</span> + info.isHasPreviousPage());<br>        <span class="hljs-comment">// 本页数据</span><br>        System.out.println(<span class="hljs-string">&quot;本页数据 = &quot;</span> + info.getList());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>测试通过后再写一个 <code>Controller</code> 返回数据测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.controller.impl;<br><br><span class="hljs-keyword">import</span> com.github.pagehelper.PageHelper;<br><span class="hljs-keyword">import</span> com.github.pagehelper.PageInfo;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><span class="hljs-keyword">import</span> org.wind.mybatis.bean.Emp;<br><span class="hljs-keyword">import</span> org.wind.mybatis.controller.EmpController;<br><span class="hljs-keyword">import</span> org.wind.mybatis.service.EmpService;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmpControllerImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmpController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    EmpService empService;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/emp/page&quot;)</span><br>    <span class="hljs-keyword">public</span> PageInfo <span class="hljs-title function_">getPage</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;pageNum&quot;, defaultValue = &quot;1&quot;)</span> Integer pageNum)</span> &#123;<br>        <span class="hljs-comment">// 每页 10 条</span><br>        PageHelper.startPage(pageNum, <span class="hljs-number">10</span>);<br><br>        List&lt;Emp&gt; allEmp = empService.getAllEmp();<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageInfo</span>&lt;&gt;(allEmp);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>但上面代码有一个问题，就是如果参数 <code>pageNum</code>
传的是一个不合理的数，则会返回无用数据，此时可以更改配置类，设置分页插件的
<code>reasonable</code> 参数：如果小于 1
则查询第一页数据，如果大于最大页数则查询最后一页数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.config;<br><br><span class="hljs-keyword">import</span> com.github.pagehelper.PageInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyBatisConfig</span> &#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    PageInterceptor <span class="hljs-title function_">pageInterceptor</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 创建分页插件对象</span><br>        <span class="hljs-type">PageInterceptor</span> <span class="hljs-variable">pageInterceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageInterceptor</span>();<br><br>        <span class="hljs-comment">// 设置插件参数</span><br>        <span class="hljs-type">Properties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();<br>        properties.setProperty(<span class="hljs-string">&quot;reasonable&quot;</span>, <span class="hljs-string">&quot;true&quot;</span>);<br>        pageInterceptor.setProperties(properties);<br><br>        <span class="hljs-comment">// 放到容器中</span><br>        <span class="hljs-keyword">return</span> pageInterceptor;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="mybatisx-插件的逆向生成功能记录"><code>MyBatisX</code>
插件的逆向生成功能记录</h4>
<ul>
<li>在 <code>IDEA</code> 中安装 <code>MyBatisX</code> 插件，再在
<code>IDEA</code> 连接数据库</li>
<li>选中需要生成的数据表，右键点击 <code>MybatisX-Generator</code> 生成
<ul>
<li>指定生成到哪个模块 <code>module path</code></li>
<li>指定生成在哪个包的父包下 <code>base package</code>，比如
<code>com.xxx</code></li>
<li>指定生成到哪个包的包名 <code>relative package</code>，比如
<code>bean</code></li>
<li>就会生成到 <code>com.xxx.bean</code></li>
<li>再下一步，指定要用的注解，和选项，和要使用的模板</li>
<li>点击 <code>finish</code> 生成</li>
</ul></li>
</ul>
<h2 id="补充">4. 补充</h2>
<h3 id="注解-mapperscan-记录">注解 <code>@MapperScan</code> 记录</h3>
<ul>
<li><p>当写了很多 <code>Mapper</code> 接口时，如果每个
<code>Mapper</code> 接口都使用 <code>@Mapper</code>
注解进行标注，则会很麻烦还容易出错</p></li>
<li><p>所以此时可以用 <code>@MapperScan</code> 注解指定哪些包下的接口是
<code>Mapper</code> 接口</p></li>
<li><p>这个注解可以放在任何类上，不过一般放在配置类下</p></li>
<li><p>用法如下：创建 <code>MyBaticConfig</code> 配置类，使用
<code>@MapperScan</code> 指定哪个包下的接口是 <code>Mapper</code>
接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wind.mybatis.config;<br><br><span class="hljs-keyword">import</span> com.github.pagehelper.PageInterceptor;<br><span class="hljs-keyword">import</span> org.mybatis.spring.annotation.MapperScan;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-meta">@MapperScan(&quot;org.wind.mybatis.mapper&quot;)</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyBatisConfig</span> &#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    PageInterceptor <span class="hljs-title function_">pageInterceptor</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 创建分页插件对象</span><br>        <span class="hljs-type">PageInterceptor</span> <span class="hljs-variable">pageInterceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageInterceptor</span>();<br><br>        <span class="hljs-comment">// 设置插件参数</span><br>        <span class="hljs-type">Properties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();<br>        properties.setProperty(<span class="hljs-string">&quot;reasonable&quot;</span>, <span class="hljs-string">&quot;true&quot;</span>);<br>        pageInterceptor.setProperties(properties);<br><br>        <span class="hljs-comment">// 放到容器中</span><br>        <span class="hljs-keyword">return</span> pageInterceptor;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/MyBatis/" class="print-no-link">#MyBatis</a>
      
        <a href="/tags/DataBase/" class="print-no-link">#DataBase</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MyBatis 记录</div>
      <div>https://windzwindy.github.io/2025/02/23/MyBatis_Record/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>windzwindy</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年2月23日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2025年2月24日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/02/24/Windows%20%E5%88%A0%E9%99%A4%E5%A4%9A%E4%BD%99%E7%9A%84%E4%BB%A5%E5%A4%AA%E7%BD%91/" title="Windows 删除多余的以太网">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Windows 删除多余的以太网</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/02/23/SpringBoot_Record/" title="SpringBoot 小补充记录">
                        <span class="hidden-mobile">SpringBoot 小补充记录</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    
      <script  src="/js/img-lazyload.js" ></script>
    
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
